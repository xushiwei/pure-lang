<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.4: http://docutils.sourceforge.net/" />
<title>pure-doc</title>
<meta name="author" content="Albert Graef &lt;Dr.Graef&#64;t-online.de&gt;" />
<style type="text/css">

/*
:Author: David Goodger
:Contact: goodger@users.sourceforge.net
:Date: $Date: 2005-12-18 01:56:14 +0100 (Sun, 18 Dec 2005) $
:Revision: $Revision: 4224 $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin-left: 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left {
  clear: left }

img.align-right {
  clear: right }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font-family: serif ;
  font-size: 100% }

pre.literal-block, pre.doctest-block {
  margin-left: 2em ;
  margin-right: 2em ;
  background-color: #eeeeee }

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

tt.docutils {
  background-color: #eeeeee }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="pure-doc">
<h1 class="title">pure-doc</h1>
<table class="docinfo" frame="void" rules="none">
<col class="docinfo-name" />
<col class="docinfo-content" />
<tbody valign="top">
<tr><th class="docinfo-name">Author:</th>
<td>Albert Graef &lt;<a class="reference" href="mailto:Dr.Graef&#64;t-online.de">Dr.Graef&#64;t-online.de</a>&gt;</td></tr>
<tr class="field"><th class="docinfo-name">License:</th><td class="field-body">GPL V3, see the accompanying COPYING file</td>
</tr>
</tbody>
</table>
<p>pure-doc is a simple utility for literate programming and documenting source
code written in the Pure programming language. It is supposed to be used with
the excellent <a class="reference" href="http://docutils.sourceforge.net">docutils</a> tools and the gentle markup format supported by these,
called <a class="reference" href="http://docutils.sourceforge.net/rst.html">RST</a> a.k.a. &quot;reStructuredText&quot;, usually pronounced &quot;rest&quot;.</p>
<p>The basic idea is that you just comment your code as usual, but using RST
markup instead of plain text. In addition, you can also designate literate
programming fragments in your code, which will be translated to RST literal
blocks automatically. You then run pure-doc on your source files to extract
all marked up comments and the literate code blocks. The resulting RST source
can then be processed with the docutils utilities like rst2html.py and
rst2latex.py to create the documentation in a variety of formats.</p>
<div class="contents topic">
<p class="topic-title first"><a id="contents" name="contents">Contents</a></p>
<ul class="simple">
<li><a class="reference" href="#installation" id="id1" name="id1">Installation</a></li>
<li><a class="reference" href="#usage" id="id2" name="id2">Usage</a></li>
<li><a class="reference" href="#literate-programming" id="id3" name="id3">Literate Programming</a></li>
<li><a class="reference" href="#hyperlink-targets-and-index-generation" id="id4" name="id4">Hyperlink Targets and Index Generation</a></li>
<li><a class="reference" href="#generating-documentation" id="id5" name="id5">Generating Documentation</a></li>
<li><a class="reference" href="#installing-documentation" id="id6" name="id6">Installing Documentation</a></li>
</ul>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id1" id="installation" name="installation">Installation</a></h1>
<p>Just do the customary <tt class="docutils literal"><span class="pre">make</span> <span class="pre">&amp;&amp;</span> <span class="pre">sudo</span> <span class="pre">make</span> <span class="pre">install</span></tt>. This only needs flex and
a standards-compliant C++ compiler.</p>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id2" id="usage" name="usage">Usage</a></h1>
<p>First, see the description of the <a class="reference" href="http://docutils.sourceforge.net/rst.html">RST</a> format. RST is a very simple markup
format, almost like plain text (in fact, you're looking at RST right now, this
README is written in it!). You can learn enough of it to start marking up your
source in about five minutes.</p>
<p>Second, you'll have to mark up your source comments. pure-doc recognizes
comments in RST format by looking at the first non-empty line of the
comment. A comment (either <tt class="docutils literal"><span class="pre">/*</span> <span class="pre">...</span> <span class="pre">*/</span></tt> or a contiguous sequence of <tt class="docutils literal"><span class="pre">//</span></tt>
line comments) is assumed to contain RST format if the first non-empty line
starts with <tt class="docutils literal"><span class="pre">:</span></tt>, <tt class="docutils literal"><span class="pre">..</span></tt> or <tt class="docutils literal"><span class="pre">__</span></tt>. Other comments are taken to be plain text
and are ignored by pure-doc.</p>
<div class="note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>pure-doc makes no other assumption about the contents of marked up
comments, so you can include whatever you want: titles, section headers,
fields, plain text, whatever. Just make sure that the comment starts with
one of the special tokens listed above. (You can always put just <tt class="docutils literal"><span class="pre">..</span></tt>
at the beginning of the comment to force it to be recognized, this will
be treated as a comment by the docutils tools.)</li>
<li>Also, pure-doc makes very few assumptions about the source; in fact, any
source files with a C/C++-like comment and string syntax should work. So
you could also use it to document your C/C++ programs, or even plain text
files like this one, as long as they adhere to these standards.</li>
<li>Indentation in extracted comments is preserved (assuming tabs = 8 spaces
by default, you can change this with the <tt class="docutils literal"><span class="pre">-t</span></tt> option).  This is
important because indentation conveys document structure in RST.</li>
</ul>
</div>
<p>For instance, here is a sample RST-formatted comment:</p>
<pre class="literal-block">
/* :Name: ``rand`` - compute random numbers
   :Synopsis: ``rand``
   :Description: Computes a (pseudo) random number. Takes no parameters.
   :Example: Here is how you can call ``rand`` in Pure:
     ::

       &gt; extern int rand();
       &gt; rand;
       1804289383

   :See Also: rand(3) */
</pre>
<p>Finally, you run pure-doc on your source files as follows:</p>
<pre class="literal-block">
pure-doc source-files ...
</pre>
<p>If no input files are specfied then the source is read from standard
input. Otherwise all input files are read and processed in the indicated
order. The output is written to stdout, so that you can directly pipe it into
one of the docutils programs:</p>
<pre class="literal-block">
pure-doc source-files ... | rst2html.py
</pre>
<p>If you prefer to write the output to a file, you can do that as follows:</p>
<pre class="literal-block">
pure-doc source-files ... &gt; rst-file
</pre>
<p>pure-doc understands the following two options:</p>
<table class="docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd><span class="option">-h</span></kbd></td>
<td>Print a short help message.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-t<var>width</var></span></kbd></td>
<td>Set the width of tabs in number of spaces.</td></tr>
</tbody>
</table>
<p>There are no other options, but the docutils programs offer plenty of options
to change the formatting of the output; please refer to the <a class="reference" href="http://docutils.sourceforge.net">docutils</a>
documentation for details.</p>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id3" id="literate-programming" name="literate-programming">Literate Programming</a></h1>
<p>pure-doc also recognizes literate code delimited by comments which, besides
the comment delimiters and whitespace, contain nothing but the special start
and end &quot;tags&quot; <tt class="docutils literal"><span class="pre">&gt;&gt;&gt;</span></tt> and <tt class="docutils literal"><span class="pre">&lt;&lt;&lt;</span></tt>. Code between these delimiters (including
all comments) is extracted from the source and output as a RST literal code
block.</p>
<p>For instance:</p>
<pre class="literal-block">
/* ..

   pure-doc supports literate programming, too: */

// &gt;&gt;&gt;

// This is a literate comment.
/* .. This too! */

extern int rand();
rand;

// &lt;&lt;&lt;
</pre>
<p>Try it now! You can scrape all the documentation from this file and format it
as html, as follows:</p>
<pre class="literal-block">
pure-doc README | rst2html.py --no-doc-title --no-doc-info &gt; test.html
</pre>
<p>As already mentioned, this README itself is also in RST format, so you can
also do the following to get nicely formatted documentation:</p>
<pre class="literal-block">
rst2html.py README pure-doc.html
</pre>
<p>(You can also just type <tt class="docutils literal"><span class="pre">make</span> <span class="pre">html</span></tt> to get this.)</p>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id4" id="hyperlink-targets-and-index-generation" name="hyperlink-targets-and-index-generation">Hyperlink Targets and Index Generation</a></h1>
<p>pure-gen recognizes explicit hyperlink targets of the form:</p>
<pre class="literal-block">
.. _target:
</pre>
<p>To supplement the normal hyperlink target processing by the docutils tools, it
automatically creates a raw html target (<tt class="docutils literal"><span class="pre">&lt;a</span> <span class="pre">name=...&gt;</span></tt>) for those. This
works around the docutils name mangling (which is undesirable if you're
indexing, say, function names). It also resolves a quirk with w3m which
doesn't pick up all <tt class="docutils literal"><span class="pre">id</span></tt> attributes in the docutils-generated html source.</p>
<p>In addition, you can also have pure-doc generate an index from all explicit
targets. To these ends, add the following special directive to one of your
source comments:</p>
<pre class="literal-block">
.. makeindex::
</pre>
<div class="note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>The <tt class="docutils literal"><span class="pre">makeindex</span></tt> directive should be placed somewhere near the end of
the target document, as pure-doc processes all source files in a single
pass. The directive will be replaced with a bullet list of references to
all targets, sorted alphabetically.</li>
<li>Also note that docutils can't handle multiple explicit targets with the
same name, so you should take that into consideration when devising your
index terms.</li>
</ul>
</div>
<p>It goes without saying that this facility is rather simplistic, and can't
compete with a carefully hand-made index. But we decided to toss it in because
docutils currently doesn't provide an automatic index facility of its own, and
the simple kind of index generated with pure-doc is certainly better than
having no index at all.</p>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id5" id="generating-documentation" name="generating-documentation">Generating Documentation</a></h1>
<p>If you're generating some library documentation for which you have to process
a bigger collection of source files, then it is often convenient to have a few
Makefile rules to automatize the process. To these ends, simply add rules
similar to the following to your Makefile:</p>
<pre class="literal-block">
# The sources. Order matters here. The generated documentation will have the
# comments from each source file in the indicated order.
sources = foo.pure bar.pure

# The basename of the documentation files to be generated.
target = foo

.PHONY: html tex pdf

html: $(target).html
tex: $(target).tex
pdf: $(target).pdf

$(target).txt: $(sources)
        pure-doc $(sources) &gt; $&#64;

# This requires that you have docutils installed.

%.html: %.txt
        rst2html.py $&lt; $&#64;

%.tex: %.txt
        rst2latex.py $&lt; $&#64;

# This also requires that you have TeX installed.

%.pdf: %.tex
        pdflatex $&lt;
        rm -f *.aux *.log *.out

clean:
        rm -f *.html *.tex *.pdf
</pre>
<p>(This assumes GNU make. If you use some other make utility then you will have
to adapt the pattern rules accordingly.)</p>
<p>Now you can just type <tt class="docutils literal"><span class="pre">make</span></tt> or <tt class="docutils literal"><span class="pre">make</span> <span class="pre">html</span></tt> to generate the documentation
in html format, and <tt class="docutils literal"><span class="pre">make</span> <span class="pre">tex</span></tt> or <tt class="docutils literal"><span class="pre">make</span> <span class="pre">pdf</span></tt> to generate the other
formats. The <tt class="docutils literal"><span class="pre">clean</span></tt> target removes the generated files.</p>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id6" id="installing-documentation" name="installing-documentation">Installing Documentation</a></h1>
<p>Now that you generated the documentation for your Pure library, you might want
to make the Pure interpreter know about it, so that you can read your
documentation with the <tt class="docutils literal"><span class="pre">help</span></tt> command of the interpreter. This isn't
difficult either. You just install the html files on the Pure library
path. The following Makefile rule automatizes this process. Add this to the
Makefile in the previous section:</p>
<pre class="literal-block">
# Try to guess the installation prefix (this needs GNU make):
prefix = $(patsubst %/bin/pure,%,$(shell which pure 2&gt;/dev/null))
ifeq ($(strip $(prefix)),)
# Fall back to /usr/local.
prefix = /usr/local
endif

libdir = $(prefix)/lib
datadir = $(libdir)/pure

install:
        test -d &quot;$(DESTDIR)$(datadir)&quot; || mkdir -p &quot;$(DESTDIR)$(datadir)&quot;
        cp $(target).html &quot;$(DESTDIR)$(datadir)&quot;
</pre>
<p>After a <tt class="docutils literal"><span class="pre">make</span> <span class="pre">install</span></tt> your documentation should now end up in the Pure
library directory, and you can read it in the Pure interpreter using a
command like the following:</p>
<pre class="literal-block">
&gt; help foo#
</pre>
<p>For a concrete example, you can find all this and more in pure-doc's own
Makefile. In fact, after installation this README ends up as pure-doc.html in
the Pure library directory, so that you can read it with:</p>
<pre class="literal-block">
&gt; help pure-doc#
</pre>
<p>Note the hash character. This tells the <tt class="docutils literal"><span class="pre">help</span></tt> command that this is an
auxiliary documentation file, rather than a function name to be looked up in
the Pure Library Manual. You can also look up a specific section in the
pure-doc manual as follows:</p>
<pre class="literal-block">
&gt; help pure-doc#literate-programming
</pre>
<p>Please also refer to the Pure Manual for more information on how to use the
interpreter's online help.</p>
</div>
</div>
</body>
</html>
