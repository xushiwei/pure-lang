/* julian_demo.pure . */

using system;
using julian;
using namespace julian;

/* Helpers */

utc_show jd = jd_to_str (jd,"long");

loc_show jd = jd_to_str ("loc",jd,"long");

all_show i jd = ()
when
  printf "jd%d ----------\n" i;
  printf "raw: %f\n" jd;
  printf "utc: %s\n" (utc_show jd);
  printf "loc: %s\n" (loc_show jd);
end;

/* Test dates

   These are some interesting dates, such as JD 0, 0001-01-01, etc.,
   as well as some corner cases around changes to and from daylight
   saving time. The daylight saving time tests are set up to work for
   PST and PDT as the local time zones. For your time zone, please
   substitute appropriate dates. */

// Various dates to compare UTC and local
let jd1  = greg_to_jd (       2000, 3, 28); 
let jd2  = greg_to_jd ("loc", 2000, 3, 28); 
let jd3  = greg_to_jd (       1600, 3, 28);
let jd4  = greg_to_jd ("loc", 1600, 3, 28);
let jd5  = greg_to_jd (       2010, 3, 28);
let jd6  = greg_to_jd ("loc", 2010, 3, 28);
let jd7  = greg_to_jd (       2200, 3, 28);
let jd8  = greg_to_jd ("loc", 2200, 3, 28);

// From PST to PDT and vis-a-versa
let jd9  = greg_to_jd ("loc", 2010, 3, 14, 1, 59, 59.0);
let jd10 = greg_to_jd ("loc", 2010, 3, 14, 3,  0,  0.0);
let jd11 = greg_to_jd ("loc", 2010, 3, 14, 3,  0,  1.0);
let jd12 = greg_to_jd ("loc", 2010,11,  7, 1, 59, 59.0);
let jd13 = greg_to_jd ("loc", 2010,11,  7, 2,  0,  0.0);
let jd14 = greg_to_jd ("loc", 2010,11,  7, 2,  0,  1.0);

// Local dates that get skipped
let jd15 = greg_to_jd ("loc", 2010, 3, 14, 2,  59, 59.0);
let jd16 = greg_to_jd (       2010,11,  7, 9,  59, 59.0);

// Epoch dates
let jd17  = greg_to_jd (-4713, 11, 24, 12, 0, 0.0);
let jd18  = greg_to_jd (   -1, 01, 01);
let jd19  = greg_to_jd (    0, 01, 01);
let jd20  = greg_to_jd (    1, 01, 01);
let jd21  = greg_to_jd ( 1582, 10, 04);
let jd22  = greg_to_jd ( 1582, 10, 05);
let jd23  = greg_to_jd ( 1582, 10, 14);
let jd24  = greg_to_jd ( 1582, 10, 15);
let jd25  = greg_to_jd ( 9999, 12, 31);
 

main1 = ()
when
  puts "Begin main1 -- Compare UTC and local."; 
  dowith all_show (1..8) [jd1,jd2,jd3,jd4,jd5,jd6,jd7,jd8];
  puts "End main1."; 
end;

main2 = ()
when
  puts "Begin main2 -- Test around daylight saving time change dates.";
  dowith all_show (9..14) [jd9,jd10,jd11,jd12,jd13,jd14]; 
  puts "End main2."; 
end;

main3 = ()
when
  puts "Begin main3 -- Show odd dates around daylight saving changes.";
  dowith all_show (15..16) [jd15, jd16]; 
  puts "End main3."; 
end;

main4 = ()
when
  puts "Begin main4 -- Show epoch dates.";
  dowith all_show (17..25) [jd17,jd18,jd19,jd20,jd21,jd22,jd23,jd24,jd25];
  puts "End main4."; 
end;


main = main1 $$ main2 $$ main3 $$ main4;

//main