<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.5: http://docutils.sourceforge.net/" />
<title>Pure-Rational - Rational number library for the Pure programming language</title>
<meta name="authors" content="Rob Hubbard  Albert Graef &lt;Dr.Graef&#64;t-online.de&gt;  Jiri Spitz &lt;jiri.spitz&#64;bluetone.cz&gt;" />
<meta name="date" content="2010-03-18" />
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 5196 2007-06-03 20:25:28Z wiemann $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left {
  clear: left }

img.align-right {
  clear: right }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font-family: serif ;
  font-size: 100% }

pre.literal-block, pre.doctest-block {
  margin-left: 2em ;
  margin-right: 2em }

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="pure-rational-rational-number-library-for-the-pure-programming-language">
<h1 class="title">Pure-Rational - Rational number library for the Pure programming language</h1>
<table class="docinfo" frame="void" rules="none">
<col class="docinfo-name" />
<col class="docinfo-content" />
<tbody valign="top">
<tr><th class="docinfo-name">Authors:</th>
<td>Rob Hubbard
<br />Albert Graef &lt;<a class="reference external" href="mailto:Dr.Graef&#64;t-online.de">Dr.Graef&#64;t-online.de</a>&gt;
<br />Jiri Spitz &lt;<a class="reference external" href="mailto:jiri.spitz&#64;bluetone.cz">jiri.spitz&#64;bluetone.cz</a>&gt;</td></tr>
<tr><th class="docinfo-name">Date:</th>
<td>2010-03-18</td></tr>
</tbody>
</table>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="auto-toc simple">
<li><a class="reference internal" href="#copying" id="id30">1&nbsp;&nbsp;&nbsp;Copying</a></li>
<li><a class="reference internal" href="#installation" id="id31">2&nbsp;&nbsp;&nbsp;Installation</a></li>
<li><a class="reference internal" href="#introduction" id="id32">3&nbsp;&nbsp;&nbsp;Introduction</a><ul class="auto-toc">
<li><a class="reference internal" href="#the-rational-module" id="id33">3.1&nbsp;&nbsp;&nbsp;The Rational Module</a></li>
<li><a class="reference internal" href="#the-files-and-the-default-prelude" id="id34">3.2&nbsp;&nbsp;&nbsp;The Files and the Default Prelude</a><ul class="auto-toc">
<li><a class="reference internal" href="#math-pure-and-other-files" id="id35">3.2.1&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">Math.pure</span></tt> and Other Files</a></li>
<li><a class="reference internal" href="#rational-pure" id="id36">3.2.2&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">Rational.pure</span></tt></a></li>
<li><a class="reference internal" href="#rat-interval-pure" id="id37">3.2.3&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">Rat_interval.pure</span></tt></a></li>
</ul>
</li>
<li><a class="reference internal" href="#notation" id="id38">3.3&nbsp;&nbsp;&nbsp;Notation</a></li>
<li><a class="reference internal" href="#acknowledgements" id="id39">3.4&nbsp;&nbsp;&nbsp;Acknowledgements</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-rational-type" id="id40">4&nbsp;&nbsp;&nbsp;The <tt class="docutils literal"><span class="pre">rational</span></tt> Type</a><ul class="auto-toc">
<li><a class="reference internal" href="#constructors" id="id41">4.1&nbsp;&nbsp;&nbsp;Constructors</a></li>
<li><a class="reference internal" href="#deconstructors" id="id42">4.2&nbsp;&nbsp;&nbsp;'Deconstructors'</a></li>
<li><a class="reference internal" href="#type-and-value-tests" id="id43">4.3&nbsp;&nbsp;&nbsp;Type and Value Tests</a></li>
<li><a class="reference internal" href="#internal-representation" id="id44">4.4&nbsp;&nbsp;&nbsp;Internal Representation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#arithmetic" id="id45">5&nbsp;&nbsp;&nbsp;Arithmetic</a><ul class="auto-toc">
<li><a class="reference internal" href="#operators" id="id46">5.1&nbsp;&nbsp;&nbsp;Operators</a></li>
<li><a class="reference internal" href="#more-on-division" id="id47">5.2&nbsp;&nbsp;&nbsp;More on Division</a></li>
<li><a class="reference internal" href="#relations-equality-and-inequality-tests" id="id48">5.3&nbsp;&nbsp;&nbsp;Relations — Equality and Inequality Tests</a></li>
<li><a class="reference internal" href="#comparison-function" id="id49">5.4&nbsp;&nbsp;&nbsp;Comparison Function</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mathematical-functions" id="id50">6&nbsp;&nbsp;&nbsp;Mathematical Functions</a><ul class="auto-toc">
<li><a class="reference internal" href="#absolute-value-and-sign" id="id51">6.1&nbsp;&nbsp;&nbsp;Absolute Value and Sign</a></li>
<li><a class="reference internal" href="#greatest-common-divisor-gcd-and-least-common-multiple-lcm" id="id52">6.2&nbsp;&nbsp;&nbsp;Greatest Common Divisor (GCD) and Least Common Multiple (LCM)</a></li>
<li><a class="reference internal" href="#extrema-minima-and-maxima" id="id53">6.3&nbsp;&nbsp;&nbsp;Extrema (Minima and Maxima)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#special-rational-functions" id="id54">7&nbsp;&nbsp;&nbsp;Special <tt class="docutils literal"><span class="pre">rational</span></tt> Functions</a><ul class="auto-toc">
<li><a class="reference internal" href="#complexity" id="id55">7.1&nbsp;&nbsp;&nbsp;Complexity</a><ul class="auto-toc">
<li><a class="reference internal" href="#complexity-relations" id="id56">7.1.1&nbsp;&nbsp;&nbsp;Complexity Relations</a></li>
<li><a class="reference internal" href="#complexity-comparison-function" id="id57">7.1.2&nbsp;&nbsp;&nbsp;Complexity Comparison Function</a></li>
<li><a class="reference internal" href="#complexity-extrema" id="id58">7.1.3&nbsp;&nbsp;&nbsp;Complexity Extrema</a></li>
<li><a class="reference internal" href="#other-complexity-functions" id="id59">7.1.4&nbsp;&nbsp;&nbsp;Other Complexity Functions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mediants-and-farey-sequences" id="id60">7.2&nbsp;&nbsp;&nbsp;Mediants and Farey Sequences</a></li>
<li><a class="reference internal" href="#rational-type-simplification" id="id61">7.3&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">rational</span></tt> Type Simplification</a></li>
</ul>
</li>
<li><a class="reference internal" href="#q-z-rounding" id="id62">8&nbsp;&nbsp;&nbsp;<strong>Q</strong> → <strong>Z</strong> — Rounding</a><ul class="auto-toc">
<li><a class="reference internal" href="#rounding-to-integer" id="id63">8.1&nbsp;&nbsp;&nbsp;Rounding to Integer</a></li>
<li><a class="reference internal" href="#integer-and-fraction-parts" id="id64">8.2&nbsp;&nbsp;&nbsp;Integer and Fraction Parts</a></li>
</ul>
</li>
<li><a class="reference internal" href="#rounding-to-multiples" id="id65">9&nbsp;&nbsp;&nbsp;Rounding to Multiples</a></li>
<li><a class="reference internal" href="#q-r-conversion-casting" id="id66">10&nbsp;&nbsp;&nbsp;<strong>Q</strong> → <strong>R</strong> — Conversion / Casting</a></li>
<li><a class="reference internal" href="#r-q-approximation" id="id67">11&nbsp;&nbsp;&nbsp;<strong>R</strong> → <strong>Q</strong> — Approximation</a><ul class="auto-toc">
<li><a class="reference internal" href="#intervals" id="id68">11.1&nbsp;&nbsp;&nbsp;Intervals</a><ul class="auto-toc">
<li><a class="reference internal" href="#interval-constructors-and-deconstructors" id="id69">11.1.1&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">interval</span></tt> Constructors and 'Deconstructors'</a></li>
<li><a class="reference internal" href="#interval-type-tests" id="id70">11.1.2&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">interval</span></tt> Type Tests</a></li>
<li><a class="reference internal" href="#interval-arithmetic-operators-and-relations" id="id71">11.1.3&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">interval</span></tt> Arithmetic Operators and Relations</a></li>
<li><a class="reference internal" href="#interval-maths" id="id72">11.1.4&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">interval</span></tt> Maths</a></li>
</ul>
</li>
<li><a class="reference internal" href="#least-complex-approximation-within" id="id73">11.2&nbsp;&nbsp;&nbsp;Least <tt class="docutils literal"><span class="pre">complex</span></tt> Approximation within ε</a></li>
<li><a class="reference internal" href="#best-approximation-with-bounded-denominator" id="id74">11.3&nbsp;&nbsp;&nbsp;Best Approximation with Bounded Denominator</a></li>
</ul>
</li>
<li><a class="reference internal" href="#decomposition" id="id75">12&nbsp;&nbsp;&nbsp;Decomposition</a></li>
<li><a class="reference internal" href="#continued-fractions" id="id76">13&nbsp;&nbsp;&nbsp;Continued Fractions</a><ul class="auto-toc">
<li><a class="reference internal" href="#id21" id="id77">13.1&nbsp;&nbsp;&nbsp;Introduction</a></li>
<li><a class="reference internal" href="#generating-continued-fractions" id="id78">13.2&nbsp;&nbsp;&nbsp;Generating Continued Fractions</a><ul class="auto-toc">
<li><a class="reference internal" href="#exact" id="id79">13.2.1&nbsp;&nbsp;&nbsp;Exact</a></li>
<li><a class="reference internal" href="#inexact" id="id80">13.2.2&nbsp;&nbsp;&nbsp;Inexact</a></li>
</ul>
</li>
<li><a class="reference internal" href="#evaluating-continued-fractions" id="id81">13.3&nbsp;&nbsp;&nbsp;Evaluating Continued Fractions</a><ul class="auto-toc">
<li><a class="reference internal" href="#convergents" id="id82">13.3.1&nbsp;&nbsp;&nbsp;Convergents</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#rational-complex-numbers" id="id83">14&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">rational</span></tt> <tt class="docutils literal"><span class="pre">complex</span></tt> Numbers</a><ul class="auto-toc">
<li><a class="reference internal" href="#rational-complex-constructors-and-deconstructors" id="id84">14.1&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">rational</span></tt> <tt class="docutils literal"><span class="pre">complex</span></tt> Constructors and 'Deconstructors'</a></li>
<li><a class="reference internal" href="#rational-complex-type-and-value-tests" id="id85">14.2&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">rational</span></tt> <tt class="docutils literal"><span class="pre">complex</span></tt> Type and Value Tests</a></li>
<li><a class="reference internal" href="#rational-complex-arithmetic-operators-and-relations" id="id86">14.3&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">rational</span></tt> <tt class="docutils literal"><span class="pre">complex</span></tt> Arithmetic Operators and Relations</a></li>
<li><a class="reference internal" href="#rational-complex-maths" id="id87">14.4&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">rational</span></tt> <tt class="docutils literal"><span class="pre">complex</span></tt> Maths</a></li>
<li><a class="reference internal" href="#rational-complex-type-simplification" id="id88">14.5&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">rational</span></tt> <tt class="docutils literal"><span class="pre">complex</span></tt> Type Simplification</a></li>
</ul>
</li>
<li><a class="reference internal" href="#string-formatting-and-evaluation" id="id89">15&nbsp;&nbsp;&nbsp;String Formatting and Evaluation</a><ul class="auto-toc">
<li><a class="reference internal" href="#the-naming-of-the-string-conversion-functions" id="id90">15.1&nbsp;&nbsp;&nbsp;The Naming of the String Conversion Functions</a></li>
<li><a class="reference internal" href="#internationalisation-and-format-structures" id="id91">15.2&nbsp;&nbsp;&nbsp;Internationalisation and Format Structures</a></li>
<li><a class="reference internal" href="#digit-grouping" id="id92">15.3&nbsp;&nbsp;&nbsp;Digit Grouping</a></li>
<li><a class="reference internal" href="#radices" id="id93">15.4&nbsp;&nbsp;&nbsp;Radices</a></li>
<li><a class="reference internal" href="#error-terms" id="id94">15.5&nbsp;&nbsp;&nbsp;Error Terms</a></li>
</ul>
</li>
<li><a class="reference internal" href="#q-fraction-string-i-n-d" id="id95">16&nbsp;&nbsp;&nbsp;<strong>Q</strong> ↔ Fraction String (“i + n/d”)</a><ul class="auto-toc">
<li><a class="reference internal" href="#formatting-to-fraction-strings" id="id96">16.1&nbsp;&nbsp;&nbsp;Formatting to Fraction Strings</a></li>
<li><a class="reference internal" href="#evaluation-of-fraction-strings" id="id97">16.2&nbsp;&nbsp;&nbsp;Evaluation of Fraction Strings</a></li>
</ul>
</li>
<li><a class="reference internal" href="#q-recurring-numeral-expansion-string-i-fr" id="id98">17&nbsp;&nbsp;&nbsp;<strong>Q</strong> ↔ Recurring Numeral Expansion String (“I.FR”)</a><ul class="auto-toc">
<li><a class="reference internal" href="#formatting-to-recurring-expansion-strings" id="id99">17.1&nbsp;&nbsp;&nbsp;Formatting to Recurring Expansion Strings</a></li>
<li><a class="reference internal" href="#evaluation-of-recurring-expansion-strings" id="id100">17.2&nbsp;&nbsp;&nbsp;Evaluation of Recurring Expansion Strings</a></li>
</ul>
</li>
<li><a class="reference internal" href="#q-numeral-expansion-string-i-f-10e" id="id101">18&nbsp;&nbsp;&nbsp;<strong>Q</strong> ↔ Numeral Expansion String (“I.F × 10E”)</a><ul class="auto-toc">
<li><a class="reference internal" href="#formatting-to-expansion-strings" id="id102">18.1&nbsp;&nbsp;&nbsp;Formatting to Expansion Strings</a><ul class="auto-toc">
<li><a class="reference internal" href="#functions-for-fixed-decimal-places" id="id103">18.1.1&nbsp;&nbsp;&nbsp;Functions for Fixed Decimal Places</a></li>
<li><a class="reference internal" href="#functions-for-significant-figures" id="id104">18.1.2&nbsp;&nbsp;&nbsp;Functions for Significant Figures</a></li>
<li><a class="reference internal" href="#functions-for-scientific-notation-and-engineering-notation" id="id105">18.1.3&nbsp;&nbsp;&nbsp;Functions for Scientific Notation and Engineering Notation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#evaluation-of-expansion-strings" id="id106">18.2&nbsp;&nbsp;&nbsp;Evaluation of Expansion Strings</a></li>
</ul>
</li>
<li><a class="reference internal" href="#numeral-string-q-approximation" id="id107">19&nbsp;&nbsp;&nbsp;Numeral String → <strong>Q</strong> — Approximation</a></li>
<li><a class="reference internal" href="#index" id="id108">20&nbsp;&nbsp;&nbsp;Index</a></li>
</ul>
</div>
<!-- Note: If you're wondering about the funny formatting, this README
simultaneously serves to generate the documentation for this module
in a variety of formats, using the docutils text formatting system
(http://docutils.sourceforge.net/). -->
<p>This module contains a Pure port of Q+Q Rob Hubbard's rational number library
for the Q programming language (see
&lt;<a class="reference external" href="http://q-lang.sourceforge.net/addons.html">http://q-lang.sourceforge.net/addons.html</a>&gt;). This package contains
<tt class="docutils literal"><span class="pre">rational.pure</span></tt>, a collection of utility functions for rational numbers, and
<tt class="docutils literal"><span class="pre">rat_interval.pure</span></tt>, a module for doing interval arithmetic needed by
<tt class="docutils literal"><span class="pre">rational.pure</span></tt>. These modules are designed to work with the <tt class="docutils literal"><span class="pre">math.pure</span></tt>
module (part of the standard Pure library), which contains the definition of the
<tt class="docutils literal"><span class="pre">rational</span></tt> type and implements the basic rational arithmetic.</p>
<div class="section" id="copying">
<h1><a class="toc-backref" href="#id30">1&nbsp;&nbsp;&nbsp;Copying</a></h1>
<div class="line-block">
<div class="line">Copyright (c) 2006 - 2010 by Rob Hubbart.</div>
<div class="line">Copyright (c) 2006 - 2010 by Albert Graef &lt;<a class="reference external" href="mailto:Dr.Graef&#64;t-online.de">Dr.Graef&#64;t-online.de</a>&gt;.</div>
<div class="line">Copyright (c) 2010 by Jiri Spitz &lt;<a class="reference external" href="mailto:jiri.spitz&#64;bluetone.cz">jiri.spitz&#64;bluetone.cz</a>&gt;.</div>
</div>
<p>Pure-rational is free software: you can redistribute it and/or modify it
under the terms of the GNU General Public License as published by the Free
Software Foundation, either version 3 of the License, or (at your option) any
later version.</p>
<p>Pure-rational is distributed in the hope that it will be useful, but WITHOUT ANY
WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR
A PARTICULAR PURPOSE.  See the GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU Public License along with this
program. If not, see &lt;<a class="reference external" href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>&gt;.</p>
</div>
<div class="section" id="installation">
<h1><a class="toc-backref" href="#id31">2&nbsp;&nbsp;&nbsp;Installation</a></h1>
<p>Run <tt class="docutils literal"><span class="pre">make</span> <span class="pre">install</span></tt> (as root) to install it in the Pure library directory. This
requires GNU make, and of course you need to have Pure installed. Pure has to
be built with support for the GNU Multiprecision Library (GMP) to use rational
numbers.</p>
<p><tt class="docutils literal"><span class="pre">make</span> <span class="pre">install</span></tt> tries to guess your Pure installation directory. If it gets
this wrong, you can install using <tt class="docutils literal"><span class="pre">make</span> <span class="pre">install</span> <span class="pre">prefix=/usr</span></tt> which sets the
installation prefix. Please see the Makefile for details.</p>
</div>
<div class="section" id="introduction">
<h1><a class="toc-backref" href="#id32">3&nbsp;&nbsp;&nbsp;Introduction</a></h1>
<div class="section" id="the-rational-module">
<h2><a class="toc-backref" href="#id33">3.1&nbsp;&nbsp;&nbsp;The Rational Module</a></h2>
<p>The module defines a type <tt class="docutils literal"><span class="pre">rational</span></tt> for Albert Graef’s Pure programming
language (&lt;<a class="reference external" href="http://code.google.com/p/pure-lang/">http://code.google.com/p/pure-lang/</a>&gt;). The module is compatible with
Pure version 0.43 (onwards).</p>
</div>
<div class="section" id="the-files-and-the-default-prelude">
<h2><a class="toc-backref" href="#id34">3.2&nbsp;&nbsp;&nbsp;The Files and the Default Prelude</a></h2>
<p>The implementation of the <tt class="docutils literal"><span class="pre">rational</span></tt> type and associated utilities is
distributed across various files.</p>
<div class="section" id="math-pure-and-other-files">
<h3><a class="toc-backref" href="#id35">3.2.1&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">Math.pure</span></tt> and Other Files</a></h3>
<p>The file <tt class="docutils literal"><span class="pre">math.pure</span></tt> defines the type, its constructors and ‘deconstructors’
and basic arithmetical and mathematical operators and functions. This is
part of the standard Pure library. A few definitions associated with
<tt class="docutils literal"><span class="pre">rationals</span></tt> are defined in the appropriate file in the default prelude.
For example: the type tests are contained in <tt class="docutils literal"><span class="pre">primitives.pure</span></tt>.</p>
<p>It is also possible to create rational complex numbers (in addition to
'double' complex numbers and integral or Gaussian complex numbers). That is
<tt class="docutils literal"><span class="pre">rational</span></tt> plays nicely with <tt class="docutils literal"><span class="pre">complex</span></tt>, as provided by Albert Graef in
the <tt class="docutils literal"><span class="pre">math.pure</span></tt> module. This is discussed further in <a class="reference internal" href="#rational-complex-numbers">Rational Complex
Numbers</a>.</p>
</div>
<div class="section" id="rational-pure">
<h3><a class="toc-backref" href="#id36">3.2.2&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">Rational.pure</span></tt></a></h3>
<p>Additional ‘Rational utilities’, not included in the <tt class="docutils literal"><span class="pre">math.pure</span></tt> module, are
defined in <tt class="docutils literal"><span class="pre">rational.pure</span></tt>. The functions include further arithmetical and
mathematical operators and functions, continued fraction support, approximation
routines and string formatting and evaluation.</p>
<p>The Rational utilities include some 'rational complex number' functions.</p>
</div>
<div class="section" id="rat-interval-pure">
<h3><a class="toc-backref" href="#id37">3.2.3&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">Rat_interval.pure</span></tt></a></h3>
<p>Amongst the Rational utilities are some functions that return a rational
interval. The file <tt class="docutils literal"><span class="pre">rat_interval.pure</span></tt> is a partial implementation of interval
arithmetic, and is not included in the default prelude. Intervals are discussed
further in <a class="reference internal" href="#intervals">Intervals</a>.</p>
</div>
</div>
<div class="section" id="notation">
<h2><a class="toc-backref" href="#id38">3.3&nbsp;&nbsp;&nbsp;Notation</a></h2>
<p>Throughout this document, the parameters q, q0, q1,. . . usually denote
<tt class="docutils literal"><span class="pre">rationals</span></tt> (∈ <strong>Q</strong>), parameters z,. . . usually denote integers (∈ <strong>Z</strong>;
<tt class="docutils literal"><span class="pre">integers</span></tt>), r,. . . usually denote real numbers (∈ <strong>R</strong>; <tt class="docutils literal"><span class="pre">reals</span></tt>), c,. . .
usually denote complex numbers (∈ <strong>C</strong>), n,. . . usually denote parameters of
any numeric type, v ,. . . usually denote parameters of any interval type, and
x,. . . usually denote parameters of any type.</p>
<p>The <tt class="docutils literal"><span class="pre">reals</span></tt> are not just the <tt class="docutils literal"><span class="pre">doubles</span></tt>, but include <tt class="docutils literal"><span class="pre">rationals</span></tt> and
<tt class="docutils literal"><span class="pre">integers</span></tt>. The term
'rational' usually refers to a rational number ∈ <strong>Q</strong> ⊃ <strong>Z</strong>, or an
expression of type <tt class="docutils literal"><span class="pre">rational</span></tt> or <tt class="docutils literal"><span class="pre">integer</span></tt>.</p>
</div>
<div class="section" id="acknowledgements">
<h2><a class="toc-backref" href="#id39">3.4&nbsp;&nbsp;&nbsp;Acknowledgements</a></h2>
<p>Thank you to Dr Albert Graef for helpful feedback on the Q language and for
answering my many questions. Albert performed the organisational work, splitting
my original main source file for partial inclusion in the default prelude, and
provided some of the ‘architectural’ functions required for smooth and
consistent integration with his Q system.</p>
<p>Thanks to various members of the Q users mailing list
(&lt;<a class="reference external" href="https://lists.sourceforge.net/lists/listinfo/q-langusers">https://lists.sourceforge.net/lists/listinfo/q-langusers</a>&gt;) for the feedback
and suggestions.</p>
</div>
</div>
<div class="section" id="the-rational-type">
<h1><a class="toc-backref" href="#id40">4&nbsp;&nbsp;&nbsp;The <tt class="docutils literal"><span class="pre">rational</span></tt> Type</a></h1>
<div class="section" id="constructors">
<h2><a class="toc-backref" href="#id41">4.1&nbsp;&nbsp;&nbsp;Constructors</a></h2>
<p><tt class="docutils literal"><span class="pre">rationals</span></tt> are constructed with the function rational.</p>
<a name="rational"><table class="docutils field-list" frame="void" id="rational" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">rational (z1, z2):</th></tr>
<tr><td>&nbsp;</td><td class="field-body">given a pair of integers (z1, z2), this returns the <tt class="docutils literal"><span class="pre">rational</span></tt> equivalent to
the fraction z1/z2. This is the inverse (up to  equivalence) of <a class="reference internal" href="#num-den">num_den</a>
(see <a class="reference internal" href="#deconstructors">'Deconstructors'</a>).</td>
</tr>
</tbody>
</table>
<p><strong>Example 1</strong> Constructing a fraction:</p>
<pre class="literal-block">
&gt; rational (44, 14);
22%7
&gt;
</pre>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">rational z:</th><td class="field-body">given an integer z, this returns the <tt class="docutils literal"><span class="pre">rational</span></tt> equivalent to the
<tt class="docutils literal"><span class="pre">integer</span></tt> z.</td>
</tr>
</tbody>
</table>
<p><strong>Example 2</strong> Converting from an <tt class="docutils literal"><span class="pre">integer</span></tt>:</p>
<pre class="literal-block">
&gt; rational 3;
3%1
&gt;
</pre>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">(%) n1 n2:</th><td class="field-body">is a <tt class="docutils literal"><span class="pre">rational</span></tt>-aware division function, which may be used as a constructor
(for <tt class="docutils literal"><span class="pre">integers</span></tt> n1 and n2). This is described in <a class="reference internal" href="#more-on-division">More on Division</a>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="deconstructors">
<h2><a class="toc-backref" href="#id42">4.2&nbsp;&nbsp;&nbsp;'Deconstructors'</a></h2>
<p>A rational number is in simplest form if the numerator and denominator are
coprime (i.e. do not have a factor in common) and the denominator is positive
(and, specifically, non-zero). Sometimes the term ‘irreducible’ is used for a
rational in simplest form. This is a property of the representation of the
rational number and not of the number itself.</p>
<a name="num"><table class="docutils field-list" frame="void" id="num" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">num q:</th><td class="field-body">given a <tt class="docutils literal"><span class="pre">rational</span></tt> or <tt class="docutils literal"><span class="pre">integer</span></tt> q, returns the ‘(signed) simplest
numerator’, i.e.  the numerator of the normalised form of q.</td>
</tr>
</tbody>
</table>
<a name="den"><table class="docutils field-list" frame="void" id="den" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">den q:</th><td class="field-body">given a <tt class="docutils literal"><span class="pre">rational</span></tt> or <tt class="docutils literal"><span class="pre">integer</span></tt> q, returns the ‘(positive) simplest
denominator’,  i.e. the denominator of the normalised form of q.</td>
</tr>
</tbody>
</table>
<a name="num_den"><table class="docutils field-list" frame="void" id="num-den" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">num_den q:</th><td class="field-body">given a <tt class="docutils literal"><span class="pre">rational</span></tt> or <tt class="docutils literal"><span class="pre">integer</span></tt> q, returns a pair (n, d) containing the
(signed) simplest numerator n and the (positive) simplest denominator d. This
is the inverse (up to equivalence) of rational as defined on integer pairs
(see <a class="reference internal" href="#constructors">Constructors</a>).</td>
</tr>
</tbody>
</table>
<p><strong>Example 3</strong> Using num_den to obtain a representation in simplest form:</p>
<pre class="literal-block">
&gt; let q = (44%(-14));
&gt; num q;
-22
&gt; den q;
7
&gt; num_den q;
(-22,7)
&gt; num_den 3;
(3,1)
&gt; num_den (-3);
(-3,1)
&gt;
</pre>
<p>Together, num and den are a pair of 'decomposition' operators, and <a class="reference internal" href="#num-den">num_den</a> is
also a decomposition operator. There are others (see <a class="reference internal" href="#decomposition">Decomposition</a>). The
integer and fraction function (see <a class="reference internal" href="#integer-and-fraction-parts">Integer and Fraction Parts</a>) may be used in
conjunction with <a class="reference internal" href="#num-den-gauss">num_den_gauss</a> to decompose a <tt class="docutils literal"><span class="pre">rational</span></tt> into integer,
numerator and denominator parts.</p>
</div>
<div class="section" id="type-and-value-tests">
<h2><a class="toc-backref" href="#id43">4.3&nbsp;&nbsp;&nbsp;Type and Value Tests</a></h2>
<p>The functions <a class="reference internal" href="#rationalp">rationalp</a> and <a class="reference internal" href="#ratvalp">ratvalp</a> and other rational variants are new
for <tt class="docutils literal"><span class="pre">rationals</span></tt> and the standard functions <a class="reference internal" href="#exactp">exactp</a> and <a class="reference internal" href="#inexactp">inexactp</a> are
extended for <tt class="docutils literal"><span class="pre">rationals</span></tt>.</p>
<p>A value is 'exact', or of an exact type, if it is of a type that is able to
represent the values returned by arithmetical operations exactly; in a sense, it
is ‘closed’ under arithmetical operations. Otherwise, a value is ‘inexact’.
Inexact types are able to store some values only approximately.</p>
<p><tt class="docutils literal"><span class="pre">double</span></tt> is not an exact type. The results of some operations on some values
that are stored exactly, can’t be stored exactly. (Furthermore, <tt class="docutils literal"><span class="pre">doubles</span></tt> are
intended to represent real numbers; no irrational number (∈ <strong>R</strong> \ <strong>Q</strong>) can
be stored exactly as a <tt class="docutils literal"><span class="pre">double</span></tt>; even some rational (∈ <strong>Q</strong>) numbers are not
stored exactly.)</p>
<p><tt class="docutils literal"><span class="pre">rational</span></tt> is an exact type. All rational numbers (subject to available
resources, of course) are stored exactly. The results of the arithmetical
operations on <tt class="docutils literal"><span class="pre">rationals</span></tt> are <tt class="docutils literal"><span class="pre">rationals</span></tt> represented exactly. Beware that
the standard <tt class="docutils literal"><span class="pre">intvalp</span></tt> and <a class="reference internal" href="#ratvalp">ratvalp</a> may return 1 even if the value is of
<tt class="docutils literal"><span class="pre">double</span></tt> type. However, these functions may be combined with <a class="reference internal" href="#exactp">exactp</a>.</p>
<a name="exactp"><table class="docutils field-list" frame="void" id="exactp" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">exactp x:</th><td class="field-body">returns whether x has an exact value.</td>
</tr>
</tbody>
</table>
<a name="inexactp"><table class="docutils field-list" frame="void" id="inexactp" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">inexactp x:</th><td class="field-body">returns whether x has an inexact value.</td>
</tr>
</tbody>
</table>
<a name="rationalp"><table class="docutils field-list" frame="void" id="rationalp" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">rationalp x:</th><td class="field-body">returns whether x is of type <tt class="docutils literal"><span class="pre">rational</span></tt>.</td>
</tr>
</tbody>
</table>
<a name="ratvapl"><table class="docutils field-list" frame="void" id="ratvalp" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">ratvalp x:</th><td class="field-body">returns whether x has a rational value.</td>
</tr>
</tbody>
</table>
<p><strong>Example 4</strong> Rational value tests:</p>
<pre class="literal-block">
&gt; let l = [9, 9%1, 9%2, 4.5, sqrt 2, 1+i, inf, nan];
&gt; map exactp l;
[1,1,1,0,0,1,0,0]
&gt; map inexactp l
[0,0,0,1,1,0,1,1]
&gt; map rationalp l;
[0,1,1,0,0,0,0,0]
&gt; map ratvalp l;
[1,1,1,1,1,0,0,0]
&gt; map (\x -&gt; (exactp x &amp;&amp; ratvalp x)) l // &quot;has exact rational value&quot;
[1,1,1,0,0,0,0,0]
&gt; map intvalp l // for comparison
[1,1,0,0,0,0,0,0]
&gt; map (\x -&gt; (exactp x &amp;&amp; intvalp x)) l // &quot;has exact integer value&quot;
[1,1,0,0,0,0,0,0]
&gt;
</pre>
<p>See <a class="reference internal" href="#rational-complex-numbers">Rational Complex Numbers</a> for details about rational complex numbers, and
<a class="reference internal" href="#rational-complex-type-and-value-tests">Rational Complex Type and Value Tests</a> for details of their type and value
tests.</p>
</div>
<div class="section" id="internal-representation">
<h2><a class="toc-backref" href="#id44">4.4&nbsp;&nbsp;&nbsp;Internal Representation</a></h2>
<p>It is not appropriate to give details of the internal representation of rational
numbers as implemented by this module. That is subject to change.</p>
<p>The module makes no <em>guarantee</em> as to whether the internal representation is in
simplest form, how the sign is handled, nor what components are stored (integer
part, sign, numerator and denominator of fraction part,. . .).</p>
<p>The representation is private, therefore you can not operate on rationals except
through the public interface. However, it is useful to be able to understand
responses given by the module when debugging.</p>
<p>See, for example, <a class="reference internal" href="#deconstructors">'Deconstructors'</a> for details of a public interface function
providing a representation with guaranteed properties.</p>
</div>
</div>
<div class="section" id="arithmetic">
<h1><a class="toc-backref" href="#id45">5&nbsp;&nbsp;&nbsp;Arithmetic</a></h1>
<div class="section" id="operators">
<h2><a class="toc-backref" href="#id46">5.1&nbsp;&nbsp;&nbsp;Operators</a></h2>
<a name="+"><a name="-"><a name="*"><p id="id3">The standard arithmetic operators (+), (−) and (*) are overloaded to have at
least one <tt class="docutils literal"><span class="pre">rational</span></tt> operand. If both operands are <tt class="docutils literal"><span class="pre">rational</span></tt> then the
result is <tt class="docutils literal"><span class="pre">rational</span></tt>. If one operand is <tt class="docutils literal"><span class="pre">integer</span></tt>, then the result is
<tt class="docutils literal"><span class="pre">rational</span></tt>. If one operand is <tt class="docutils literal"><span class="pre">double</span></tt>, then the result is <tt class="docutils literal"><span class="pre">double</span></tt>.</p>
<a name="/"><p id="id4">The operators (/) and (%) are overloaded for division on at least one
<tt class="docutils literal"><span class="pre">rational</span></tt> operand. The value returned by (/) is always <tt class="docutils literal"><span class="pre">inexact</span></tt> (in the
sense of <a class="reference internal" href="#type-and-value-tests">Type and Value Tests</a>). The value returned by (%) is <tt class="docutils literal"><span class="pre">exact</span></tt> (if it
exists).</p>
<a name="pow"><p id="pow">The standard function <tt class="docutils literal"><span class="pre">pow</span></tt> is overloaded to have a <tt class="docutils literal"><span class="pre">rational</span></tt> left
operand. If <tt class="docutils literal"><span class="pre">pow</span></tt> is passed <tt class="docutils literal"><span class="pre">integer</span></tt> operands where the right operand is
negative, then a <tt class="docutils literal"><span class="pre">rational</span></tt> is returned. The right operand should be an
<tt class="docutils literal"><span class="pre">integer</span></tt>; negative values are permitted (because q<sup>−z</sup> =
1/q<sup>z</sup>). It is not overloaded to also have a <tt class="docutils literal"><span class="pre">rational</span></tt> right operand
because such values are not generally rational
(e.g. q<sup>1/n</sup> = <sup>n</sup>√q).</p>
<a name="^"><p id="id5">The standard arithmetic operator (^) is also overloaded, but produces a
<tt class="docutils literal"><span class="pre">double</span></tt> value (as always).</p>
<p>The values of <tt class="docutils literal"><span class="pre">pow</span> <span class="pre">0</span> <span class="pre">0</span></tt> and <tt class="docutils literal"><span class="pre">0^0</span></tt> (with <tt class="docutils literal"><span class="pre">integer</span></tt> or <tt class="docutils literal"><span class="pre">rational</span></tt> zeroes)
are left undefined.</p>
<p><strong>Example 5</strong> Arithmetic:</p>
<pre class="literal-block">
&gt; 5%7 + 2%3;
29%21
&gt; str_mixed ans;
&quot;1+8/21&quot;
&gt; 1 + 2%3;
5%3
&gt; ans + 1.0;
2.66666666666667
&gt; 3%8 - 1%3;
1%24
&gt; (11%10) ^ 3;
1.331
&gt; pow (11%10) 3;
1331%1000
&gt; pow 3 5;
243
&gt; pow 3 (-5);
1%243
&gt;
</pre>
<p>(See the function <a class="reference internal" href="#str-mixed">str_mixed</a> .)</p>
<p>Beware that (/) on <tt class="docutils literal"><span class="pre">integers</span></tt> will not produce a <tt class="docutils literal"><span class="pre">rational</span></tt> result.</p>
<p><strong>Example 6</strong> Division:</p>
<pre class="literal-block">
&gt; 44/14;
3.14285714285714
&gt; 44%14;
22%7
&gt; str_mixed ans;
&quot;3+1/7&quot;
</pre>
<p>(See the function <a class="reference internal" href="#str-mixed">str_mixed</a> .)</p>
</div>
<div class="section" id="more-on-division">
<h2><a class="toc-backref" href="#id47">5.2&nbsp;&nbsp;&nbsp;More on Division</a></h2>
<a name="%"><p id="id6">There is a <tt class="docutils literal"><span class="pre">rational</span></tt>-aware divide operator on the numeric types:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">n1 % n2:</th><td class="field-body">returns the quotient (∈ <strong>Q</strong>) of n1 and n2. If n1 and n2 are <tt class="docutils literal"><span class="pre">rational</span></tt> or
<tt class="docutils literal"><span class="pre">integer</span></tt> then the result is <tt class="docutils literal"><span class="pre">rational</span></tt>. This operator has the precedence
of division (/).</td>
</tr>
</tbody>
</table>
<p><strong>Example 7</strong> Using % like a constructor:</p>
<pre class="literal-block">
&gt; 44 % 14;
22%7
&gt; 2 + 3%8; // &quot;2 3/8&quot;
19%8
&gt; str_mixed ans;
&quot;2+3/8&quot;
&gt;
</pre>
<p>(See the function <a class="reference internal" href="#str-mixed">str_mixed</a> .)</p>
<a name="reciprocal"><table class="docutils field-list" frame="void" id="reciprocal" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">reciprocal n:</th><td class="field-body">returns the reciprocal of n: 1/n.</td>
</tr>
</tbody>
</table>
<p><strong>Example 8</strong> Reciprocal:</p>
<pre class="literal-block">
&gt; reciprocal (22%7);
7%22
&gt;
</pre>
<p>The following division functions are parameterised by a rounding mode
<a class="reference internal" href="#roundfun">roundfun</a>. The available rounding modes are described in <a class="reference internal" href="#rounding-to-integer">Rounding to
Integer</a>.</p>
<a name="divide"><table class="docutils field-list" frame="void" id="divide" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">divide roundfun n d:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">for <tt class="docutils literal"><span class="pre">rationals</span></tt> n and d returns a pair (q, r) of 'quotient' and 'remainder'
where q is an <tt class="docutils literal"><span class="pre">integer</span></tt> and r is a <tt class="docutils literal"><span class="pre">rational</span></tt> such that |r| &lt; |d| (or
better) and n = q * d + r. Further conditions may hold, depending on the
chosen rounding mode <a class="reference internal" href="#roundfun">roundfun</a> (see <a class="reference internal" href="#rounding-to-integer">Rounding to Integer</a>).
If <a class="reference internal" href="#roundfun">roundfun</a> = <a class="reference internal" href="#floor">floor</a> then 0 ≤ r &lt; d.
If <a class="reference internal" href="#roundfun">roundfun</a> = <a class="reference internal" href="#ceil">ceil</a> then −d &lt; r ≤ 0.
If <a class="reference internal" href="#roundfun">roundfun</a> = <a class="reference internal" href="#trunc">trunc</a> then |r| &lt; |d| and sgn r ∈ {0, sgn d}.
If <a class="reference internal" href="#roundfun">roundfun</a> = <a class="reference internal" href="#round">round</a>, <a class="reference internal" href="#roundfun">roundfun</a> = <a class="reference internal" href="#round-zero-bias">round_zero_bias</a> or <a class="reference internal" href="#roundfun">roundfun</a> =
<a class="reference internal" href="#round-unbiased">round_unbiased</a> then |r| ≤ d/2.</td>
</tr>
</tbody>
</table>
<a name="quotient"><table class="docutils field-list" frame="void" id="quotient" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">quotient roundfun nN d:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">returns just the quotient as produced by <a class="reference internal" href="#divide">divide</a> roundfun n d.</td>
</tr>
</tbody>
</table>
<a name="modulus"><table class="docutils field-list" frame="void" id="modulus" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">modulus roundfun n d:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">returns just the remainder as produced by <a class="reference internal" href="#divide">divide</a> roundfun n d.</td>
</tr>
</tbody>
</table>
<a name="div"><table class="docutils field-list" frame="void" id="div" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">q1 div q2:</th><td class="field-body">(overload of the built-in div) q1 and q2 may be <tt class="docutils literal"><span class="pre">rational</span></tt> or <tt class="docutils literal"><span class="pre">integer</span></tt>.
Returns an <tt class="docutils literal"><span class="pre">integer</span></tt>.</td>
</tr>
</tbody>
</table>
<a name="mod"><table class="docutils field-list" frame="void" id="mod" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">q1 mod q2:</th><td class="field-body">(overload of the built-in mod) q1 and q2 may be <tt class="docutils literal"><span class="pre">rational</span></tt> or <tt class="docutils literal"><span class="pre">integer</span></tt>.
Returns a <tt class="docutils literal"><span class="pre">rational</span></tt>. If q = q1 div q2 and r = q1 mod q2 then
q1 = q * q2 + q, q ∈ <strong>Z</strong>, |r| &lt; |q2| and sgn r ∈ {0, sgn q2}.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="relations-equality-and-inequality-tests">
<h2><a class="toc-backref" href="#id48">5.3&nbsp;&nbsp;&nbsp;Relations — Equality and Inequality Tests</a></h2>
<a name="=="><a name="~="><a name="<"><a name="<="><a name=">"><a name=">="><p id="id12">The standard arithmetic operators (==), (~=), (&lt;), (&lt;=), (&gt;), (&gt;=) are
overloaded to have at least one <tt class="docutils literal"><span class="pre">rational</span></tt> operand. The other operand may be
<tt class="docutils literal"><span class="pre">rational</span></tt>, <tt class="docutils literal"><span class="pre">integer</span></tt> or <tt class="docutils literal"><span class="pre">double</span></tt>.</p>
<p><strong>Example 9</strong> Inequality:</p>
<pre class="literal-block">
&gt; 3%8 &lt; 1%3;
0
&gt;
</pre>
</div>
<div class="section" id="comparison-function">
<h2><a class="toc-backref" href="#id49">5.4&nbsp;&nbsp;&nbsp;Comparison Function</a></h2>
<a name="cmp"><table class="docutils field-list" frame="void" id="cmp" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">cmp n1 n2:</th><td class="field-body">is the ‘comparison’ (or ‘compare’) function, and returns sgn (n1 − n2); that
is, it returns −1 if n1 &lt; n2, 0 if n1 = n2, and +1 if n1 &gt; n2.</td>
</tr>
</tbody>
</table>
<p><strong>Example 10</strong> Compare:</p>
<pre class="literal-block">
&gt; cmp (3%8) (1%3);
1
&gt;
</pre>
</div>
</div>
<div class="section" id="mathematical-functions">
<h1><a class="toc-backref" href="#id50">6&nbsp;&nbsp;&nbsp;Mathematical Functions</a></h1>
<p>Most mathematical functions, including the elementary functions (sin, sin<sup>−1</sup>, sinh, sinh<sup>−1</sup>, cos,. . . , exp, ln,. . . ), are not closed on
the set of rational numbers. That is, most mathematical functions do not yield a
rational number in general when applied to a rational number. Therefore the
elementary functions are not defined for <tt class="docutils literal"><span class="pre">rationals</span></tt>. To apply these
functions, first apply a cast to <tt class="docutils literal"><span class="pre">double</span></tt>, or compose the function with a
cast.</p>
<div class="section" id="absolute-value-and-sign">
<h2><a class="toc-backref" href="#id51">6.1&nbsp;&nbsp;&nbsp;Absolute Value and Sign</a></h2>
<p>The standard <tt class="docutils literal"><span class="pre">abs</span></tt> and <tt class="docutils literal"><span class="pre">sgn</span></tt> functions are overloaded for <tt class="docutils literal"><span class="pre">rationals</span></tt>.</p>
<a name="abs"><table class="docutils field-list" frame="void" id="abs" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">abs q:</th><td class="field-body">returns absolute value, or magnitude, |q| of q; abs q = |q| = q × sgn q
(see  below).</td>
</tr>
</tbody>
</table>
<a name="sgn"><table class="docutils field-list" frame="void" id="sgn" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">sgn q:</th><td class="field-body">returns the sign of q as an <tt class="docutils literal"><span class="pre">integer</span></tt>; returns −1 if q &lt; 0, 0 if q = 0, +1
if q &gt; 0.</td>
</tr>
</tbody>
</table>
<p>Together, these functions satisfy the property ∀q • (sgn q) * (abs q) = q (i.e.
∀q • (sgn q) * |q| = q). Thus these provide a pair of ‘decomposition’
operators; there are others (see <a class="reference internal" href="#decomposition">Decomposition</a>).</p>
</div>
<div class="section" id="greatest-common-divisor-gcd-and-least-common-multiple-lcm">
<h2><a class="toc-backref" href="#id52">6.2&nbsp;&nbsp;&nbsp;Greatest Common Divisor (GCD) and Least Common Multiple (LCM)</a></h2>
<p>The standard functions <tt class="docutils literal"><span class="pre">gcd</span></tt> and <tt class="docutils literal"><span class="pre">lcm</span></tt> are overloaded for <tt class="docutils literal"><span class="pre">rationals</span></tt>, and
mixtures of <tt class="docutils literal"><span class="pre">integer</span></tt> and <tt class="docutils literal"><span class="pre">rational</span></tt>.</p>
<a name="gcd"><table class="docutils field-list" frame="void" id="gcd" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">gcd n1 n2:</th><td class="field-body">The GCD is also known as the Highest Common Factor (HCF). The GCD of rationals
q1 and q2 is the largest (therefore positive) rational f such that f divides
into both q1 and q2 exactly, i.e. an integral number of times. This is not
defined for n1 and n2 both zero. For integral q1 and q2, this definition
coincides with the usual definition of GCD for integers.</td>
</tr>
</tbody>
</table>
<p><strong>Example 11</strong> With two <tt class="docutils literal"><span class="pre">rationals</span></tt>:</p>
<pre class="literal-block">
&gt; let a = 7%12;
&gt; let b = 21%32;
&gt; let f = gcd a b;
&gt; f;
7%96
&gt; a % f;
8%1
&gt; b % f;
9%1
&gt;
</pre>
<p><strong>Example 12</strong> With a <tt class="docutils literal"><span class="pre">rational</span></tt> and an <tt class="docutils literal"><span class="pre">integer</span></tt>:</p>
<pre class="literal-block">
&gt; let f = gcd (6%5) 4;
&gt; f;
2%5
&gt; (6%5) % f;
3%1
&gt; 4 % f;
10%1
&gt;
</pre>
<p><strong>Example 13</strong> With integral <tt class="docutils literal"><span class="pre">rationals</span></tt> and with <tt class="docutils literal"><span class="pre">integers</span></tt>:</p>
<pre class="literal-block">
&gt; gcd (rational 18) (rational 24);
6%1
&gt; gcd 18 24;
6
&gt;
</pre>
<p><strong>Example 14</strong> The behaviour with negative numbers:</p>
<pre class="literal-block">
&gt; gcd (rational (-18)) (rational 24);
6%1
&gt; gcd (rational 18) (rational (-24));
6%1
&gt; gcd (rational (-18)) (rational (-24));
6%1
&gt;
</pre>
<a name="lcm"><table class="docutils field-list" frame="void" id="lcm" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">lcm n1 n2:</th><td class="field-body">The LCM of rationals q1 and q2 is the smallest positive rational m such that
both q1 and q2 divide m exactly. This is not defined for n1 and n2 both zero.
For integral q1 and q2, this definition coincides with the usual definition
of LCM for integers.</td>
</tr>
</tbody>
</table>
<p><strong>Example 15</strong> With two <tt class="docutils literal"><span class="pre">rationals</span></tt>:</p>
<pre class="literal-block">
&gt; let a = 7%12;
&gt; let bB = 21%32;
&gt; let m = lcm a b;
&gt; m;
21%4
&gt; m % a;
9%1
&gt; m % b;
8%1
&gt;
</pre>
<p><strong>Example 16</strong> With a <tt class="docutils literal"><span class="pre">rational</span></tt> and an <tt class="docutils literal"><span class="pre">integer</span></tt>:</p>
<pre class="literal-block">
&gt; let m = lcm (6%5) 4;
&gt; m;
12%1
&gt; m % (6%5);
10%1
&gt;
</pre>
<p><strong>Example 17</strong> The behaviour with negative numbers:</p>
<pre class="literal-block">
&gt; lcm (rational (-18)) (rational 24);
72%1
&gt; lcm (rational 18) (rational (-24));
72%1
&gt; lcm (rational (-18)) (rational (-24));
72%1
&gt;
</pre>
<p>Together, the GCD and LCM have the following property when applied to two
numbers: (gcd q1 q2) * (lcm q1 q2) = |q1 * q2|.</p>
</div>
<div class="section" id="extrema-minima-and-maxima">
<h2><a class="toc-backref" href="#id53">6.3&nbsp;&nbsp;&nbsp;Extrema (Minima and Maxima)</a></h2>
<a name="min"><a name="max"><p id="max">The standard <tt class="docutils literal"><span class="pre">min</span></tt> and <tt class="docutils literal"><span class="pre">max</span></tt> functions work with <tt class="docutils literal"><span class="pre">rational</span></tt> values.</p>
<p><strong>Example 18</strong> Maximum:</p>
<pre class="literal-block">
&gt; max (3%8) (1%3);
3%8
&gt;
</pre>
</div>
</div>
<div class="section" id="special-rational-functions">
<h1><a class="toc-backref" href="#id54">7&nbsp;&nbsp;&nbsp;Special <tt class="docutils literal"><span class="pre">rational</span></tt> Functions</a></h1>
<div class="section" id="complexity">
<h2><a class="toc-backref" href="#id55">7.1&nbsp;&nbsp;&nbsp;Complexity</a></h2>
<p>The 'complexity' (or 'complicatedness') of a <tt class="docutils literal"><span class="pre">rational</span></tt> is a measure of the
greatness of its simplest (positive) denominator.</p>
<p>The complexity of a number is not itself made available, but various functions
and operators are provided to allow complexities to be compared. Generally, it
does not make sense to operate directly on complexity values.</p>
<p>The complexity functions in this section may be applied to <tt class="docutils literal"><span class="pre">integers</span></tt> (the
least complex), <tt class="docutils literal"><span class="pre">rationals</span></tt>, or <tt class="docutils literal"><span class="pre">reals</span></tt> (<tt class="docutils literal"><span class="pre">doubles</span></tt>; the most complex).</p>
<p>Functions concerning 'complexity' are named with 'cplx', whereas functions
concerning 'complex numbers' (see <a class="reference internal" href="#rational-complex-numbers">Rational Complex Numbers</a>) are named with
'comp'.</p>
<div class="section" id="complexity-relations">
<h3><a class="toc-backref" href="#id56">7.1.1&nbsp;&nbsp;&nbsp;Complexity Relations</a></h3>
<a name="eq_cplx"><table class="docutils field-list" frame="void" id="eq-cplx" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">n1 eq_cplx n2:</th><td class="field-body">&quot;[is] equally complex [to]&quot; — returns 1 if n1 and n2 are equally complex;
returns 0 otherwise. Equal complexity is not the same a equality; n1 and n2
are equally complex if their simplest denominators are equal. Equal complexity
forms an equivalence relation on <tt class="docutils literal"><span class="pre">rationals</span></tt>.</td>
</tr>
</tbody>
</table>
<p><strong>Example 19</strong> Complexity equality test:</p>
<pre class="literal-block">
&gt; (1%3) eq_cplx (100%3);
1
&gt; (1%4) eq_cplx (1%5);
0
&gt; (3%3) eq_cplx (1%3); // LHS is not in simplest form
0
&gt;
</pre>
<a name="not_eq_cplx"><dl class="docutils" id="not-eq-cplx">
<dt>:n1 not_eq_cplx n2&quot;</dt>
<dd>&quot;not equally complex&quot; — returns 0 if n1 and n2 are equally complex; returns 1
otherwise.</dd>
</dl>
<a name="less_cplx"><dl class="docutils" id="less-cplx">
<dt>:n1 less_cplx n2&quot;</dt>
<dd>&quot;[is] less complex [than]&quot; (or &quot;simpler&quot;) — returns 1 if n1 is strictly less
complex than n2; returns 0 otherwise. This forms a partial strict ordering
on <tt class="docutils literal"><span class="pre">rationals</span></tt>.</dd>
</dl>
<p><strong>Example 20</strong> Complexity inequality test:</p>
<pre class="literal-block">
&gt; (1%3) less_cplx (100%3);
0
&gt; (1%4) less_cplx (1%5);
1
&gt; (3%3) less_cplx (1%3); // LHS is not in simplest form
1
&gt;
</pre>
<a name="less_eq_cplx"><table class="docutils field-list" frame="void" id="less-eq-cplx" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">n1 less_eq_cplx n2:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">&quot;less or equally complex&quot; (or &quot;not more complex&quot;) — returns 1 if n1 is less
complex than or equally complex to n2; returns 0 otherwise. This forms a
partial non-strict ordering on <tt class="docutils literal"><span class="pre">rationals</span></tt>.</td>
</tr>
</tbody>
</table>
<a name="more_cplx"><table class="docutils field-list" frame="void" id="more-cplx" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">n1 more_cplx n2:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">&quot;[is] more complex [than]&quot; — returns 1 if n1 is strictly more complex than n2;
returns 0 otherwise. This forms a partial strict ordering on <tt class="docutils literal"><span class="pre">rationals</span></tt>.</td>
</tr>
</tbody>
</table>
<a name="more_eq_cplx"><table class="docutils field-list" frame="void" id="more-eq-cplx" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">n1 more_eq_cplx n2:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">&quot;more or equally complex&quot; (or &quot;not less complex&quot;) — returns 1 if n1 is more
complex than or equally complex to n2; returns 0 otherwise. This forms a
partial non-strict ordering on <tt class="docutils literal"><span class="pre">rationals</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="complexity-comparison-function">
<h3><a class="toc-backref" href="#id57">7.1.2&nbsp;&nbsp;&nbsp;Complexity Comparison Function</a></h3>
<a name="cmp_complexity"><table class="docutils field-list" frame="void" id="cmp-complexity" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">cmp_complexity n1 n2:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">is the 'complexity comparison' function, and returns the sign of the
difference in complexity; that is, it returns −1 if n1 is less complex than
n2, 0 if n1 and n2 are equally complex (but not necessarily equal), and +1 if
n1 is more complex than n2.</td>
</tr>
</tbody>
</table>
<p><strong>Example 21</strong> Complexity comparison:</p>
<pre class="literal-block">
&gt; cmp_complexity (1%3) (100%3);
0
&gt; cmp_complexity (1%4) (1%5);
-1
&gt; cmp_complexity (3%3) (1%3); // LHS is not in simplest form
-1
&gt;
</pre>
</div>
<div class="section" id="complexity-extrema">
<h3><a class="toc-backref" href="#id58">7.1.3&nbsp;&nbsp;&nbsp;Complexity Extrema</a></h3>
<a name="least_cplx"><table class="docutils field-list" frame="void" id="least-cplx" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">least_cplx n1 n2:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">returns the least complex of n1 and n2; if they’re equally complex, n1 is
returned.</td>
</tr>
</tbody>
</table>
<p><strong>Example 22</strong> Complexity selection:</p>
<pre class="literal-block">
&gt; least_cplx (100%3) (1%3);
100%3
&gt; least_cplx (1%5) (1%4);
1%4
&gt; least_cplx (1%3) (3%3); // second argument not in simplest form
1%1
&gt;
</pre>
<a name="most_cplx"><table class="docutils field-list" frame="void" id="most-cplx" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">most_cplx n1 n2:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">returns the most complex of n1 and n2; if they’re equally complex, n1 is
returned.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="other-complexity-functions">
<h3><a class="toc-backref" href="#id59">7.1.4&nbsp;&nbsp;&nbsp;Other Complexity Functions</a></h3>
<a name="complexity_rel"><table class="docutils field-list" frame="void" id="complexity-rel" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">complexity_rel n1 op n2:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">returns &quot;complexity-of n1&quot; compared by operator op to the “complexity-of n2”.
This is equivalent to prefix complexity rel op n1 n2 (below), but is the more
readable form.</td>
</tr>
</tbody>
</table>
<p><strong>Example 23</strong> Complexity relations:</p>
<pre class="literal-block">
&gt; complexity_rel (1%3) (==) (100%3);
1
&gt; complexity_rel (1%4) (&lt;=) (1%5);
1
&gt; complexity_rel (1%4) (&gt;) (1%5);
0
&gt;
</pre>
<a name="prefix_complexity_rel"><table class="docutils field-list" frame="void" id="prefix-complexity-rel" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">prefix_complexity_rel op n1 n2:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">returns the same as complexity_rel n1 op n2, but this form is more convenient
for currying.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="mediants-and-farey-sequences">
<h2><a class="toc-backref" href="#id60">7.2&nbsp;&nbsp;&nbsp;Mediants and Farey Sequences</a></h2>
<a name="mediant"><table class="docutils field-list" frame="void" id="mediant" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">mediant q1 q2:</th><td class="field-body"><p class="first">returns the canonical mediant of the rationals q1 and q2, a form of
(nonarithmetic) average on rationals. The mediant of the representations
n1/d1 = q1 and n2/d2 = q2, where d1 and d2 must be positive, is defined as
(n1 + n2)/(d1 + d2). A mediant of the rationals q1 and q2 is a mediant of some
representation of each of q1 and q2. That is, the mediant is dependent upon
the representations and therefore is not well-defined as a function on pairs
of rationals. The canonical mediant always assumes the simplest
representation, and therefore is well-defined as a function on pairs of
rationals.</p>
<p>By the phrase “the mediant” (as opposed to just “a mediant”) we
always mean “the canonical mediant”.</p>
<p>If q1 &lt; q2, then any mediant q is always such that q1 &lt; q &lt; q2.</p>
<p class="last">The (canonical) mediant has some special properties. If  q1 and q2 are
integers, then the mediant is the arithmetic mean. If q1 and q2  are unit
fractions (reciprocals of integers), then the mediant is the harmonic  mean.
The mediant of q and 1/q is ±1, (which happens to be a geometric mean   with
the correct sign, although this is a somewhat uninteresting and  degenerate
case).</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Example 24</strong> Mediants:</p>
<pre class="literal-block">
&gt; mediant (1%4) (3%10);
2%7
&gt; mediant 3 7; // both ``integers``
5%1
&gt; mediant 3 8; // both ``integers`` again
11%2
&gt; mediant (1%3) (1%7); // both unit fractions
1%5
&gt; mediant (1%3) (1%8); // both unit fractions again
2%11
&gt; mediant (-10) (-1%10);
-1%1
&gt;
</pre>
<a name="farey"><table class="docutils field-list" frame="void" id="farey" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">farey -k:</th><td class="field-body">for an <tt class="docutils literal"><span class="pre">integer</span></tt> k, farey returns the ordered list containing the order-k
Farey sequence, which is the ordered list of all rational numbers between 0
and 1 inclusive with (simplest) denominator at most k.</td>
</tr>
</tbody>
</table>
<p><strong>Example 25</strong> A Farey sequence:</p>
<pre class="literal-block">
&gt; map str_mixed (farey 6);
[&quot;0&quot;,&quot;1/6&quot;,&quot;1/5&quot;,&quot;1/4&quot;,&quot;1/3&quot;,&quot;2/5&quot;,&quot;1/2&quot;,&quot;3/5&quot;,&quot;2/3&quot;,&quot;3/4&quot;,&quot;4/5&quot;,&quot;5/6&quot;,&quot;1&quot;]
&gt;
</pre>
<p>(See the function <a class="reference internal" href="#str-mixed">str_mixed</a> .)</p>
<p>Farey sequences and mediants are closely related. Three rationals q1 &lt; q2 &lt; q3
are consecutive members of a Farey sequence if and only if q2 is the mediant of
q1 and q3. If rationals q1 = n1/d1 &lt; q2 = n2/d2 are consecutive members of a
Farey sequence, then n2d1 − n1d2 = 1.</p>
</div>
<div class="section" id="rational-type-simplification">
<h2><a class="toc-backref" href="#id61">7.3&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">rational</span></tt> Type Simplification</a></h2>
<a name="rat_simplify"><table class="docutils field-list" frame="void" id="rat-simplify" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">rat_simplify q:</th><td class="field-body">returns q with <tt class="docutils literal"><span class="pre">rationals</span></tt> simplified to <tt class="docutils literal"><span class="pre">integers</span></tt>, if possible.</td>
</tr>
</tbody>
</table>
<p><strong>Example 26</strong> <tt class="docutils literal"><span class="pre">rational</span></tt> type simplification:</p>
<pre class="literal-block">
&gt; let l = [9, 9%1, 9%2, 4.5, 9%1+i, 9%2+i];
l;
[9,9%1,9%2,4.5,9%1+:1,9%2+:1]
&gt; map rat_simplify l;
[9,9,9%2,4.5,9+:1,9%2+:1]
&gt;
</pre>
<p>See <a class="reference internal" href="#rational-complex-numbers">Rational Complex Numbers</a> for details about rational complex numbers, and
<a class="reference internal" href="#rational-complex-type-simplification">Rational Complex Type Simplification</a> for details of their type
simplification.</p>
</div>
</div>
<div class="section" id="q-z-rounding">
<h1><a class="toc-backref" href="#id62">8&nbsp;&nbsp;&nbsp;<strong>Q</strong> → <strong>Z</strong> — Rounding</a></h1>
<div class="section" id="rounding-to-integer">
<h2><a class="toc-backref" href="#id63">8.1&nbsp;&nbsp;&nbsp;Rounding to Integer</a></h2>
<a name="roundfun"><p id="roundfun">Some of these are new functions, and some are overloads of standard functions.
The behaviour of the overloads is consistent with that of the standard
functions.</p>
<a name="floor"><table class="docutils field-list" frame="void" id="floor" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">floor q:</th><td class="field-body">(overload of standard function) returns q rounded downwards, i.e. towards −1,
to an <tt class="docutils literal"><span class="pre">integer</span></tt>, usually denoted bQc.</td>
</tr>
</tbody>
</table>
<a name="ceil"><table class="docutils field-list" frame="void" id="ceil" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">ceil q:</th><td class="field-body">(overload of standard function) returns q rounded upwards, i.e. towards +1, to
an <tt class="docutils literal"><span class="pre">integer</span></tt>, usually denoted dQe.</td>
</tr>
</tbody>
</table>
<a name="trunc"><table class="docutils field-list" frame="void" id="trunc" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">trunc q:</th><td class="field-body">(overload of standard function) returns q truncated, i.e. rounded towards 0,
to an <tt class="docutils literal"><span class="pre">integer</span></tt>.</td>
</tr>
</tbody>
</table>
<a name="round"><table class="docutils field-list" frame="void" id="round" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">round q:</th><td class="field-body">(overload of standard function) returns q ‘rounded off’, i.e. rounded to the
nearest <tt class="docutils literal"><span class="pre">integer</span></tt>, with ‘half-integers’ (values that are an integer plus a
half) rounded away from zero.</td>
</tr>
</tbody>
</table>
<a name="round_zero_bias"><table class="docutils field-list" frame="void" id="round-zero-bias" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">round_zero_bias q:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">(new function) returns q ‘rounded off’, i.e. rounded to the nearest
<tt class="docutils literal"><span class="pre">integer</span></tt>, but with ‘half-integers’ rounded towards zero.</td>
</tr>
</tbody>
</table>
<a name="round_unbiased"><table class="docutils field-list" frame="void" id="round-unbiased" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">round_unbiased q:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">(new function) returns q rounded to the nearest <tt class="docutils literal"><span class="pre">integer</span></tt>, with
‘half-integers’ rounded to the nearest even <tt class="docutils literal"><span class="pre">integer</span></tt>.</td>
</tr>
</tbody>
</table>
<p><strong>Example 27</strong> Illustration of the different rounding modes:</p>
<pre class="literal-block">
&gt; let l = while (&lt;= 3) (+(1%2)) (- rational 3)
&gt; map double l; // (just to show the values in a familiar format)
[-3.0,-2.5,-2.0,-1.5,-1.0,-0.5,0.0,0.5,1.0,1.5,2.0,2.5,3.0]
&gt; map floor l;
[-3,-3,-2,-2,-1,-1,0,0,1,1,2,2,3]
&gt; map ceil l;
[-3,-2,-2,-1,-1,0,0,1,1,2,2,3,3]
&gt; map trunc l;
[-3,-2,-2,-1,-1,0,0,0,1,1,2,2,3]
&gt; map round l;
[-3,-3,-2,-2,-1,-1,0,1,1,2,2,3,3]
&gt; map round_zero_bias l;
[-3,-2,-2,-1,-1,0,0,0,1,1,2,2,3]
&gt; map round_unbiased l;
[-3,-2,-2,-2,-1,0,0,0,1,2,2,2,3]
&gt;
</pre>
<p>(See the function <a class="reference internal" href="#double">double</a>.)</p>
</div>
<div class="section" id="integer-and-fraction-parts">
<h2><a class="toc-backref" href="#id64">8.2&nbsp;&nbsp;&nbsp;Integer and Fraction Parts</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">integer_and_fraction roundfun q:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">returns a pair (z, f) where z is the ‘integer part’ as an <tt class="docutils literal"><span class="pre">integer</span></tt>, f is
the ‘fraction part’ as a <tt class="docutils literal"><span class="pre">rational</span></tt>, where the rounding operations are
performed using rounding mode <a class="reference internal" href="#roundfun">roundfun</a> (see <a class="reference internal" href="#rounding-to-integer">Rounding to Integer</a>).</td>
</tr>
</tbody>
</table>
<p><strong>Example 28</strong> Integer and fraction parts with the different rounding modes:</p>
<pre class="literal-block">
&gt; let nc = -22%7;
&gt; integer_and_fraction floor nc;
(-4,6%7)
&gt; integer_and_fraction trunc nc;
(-3,-1%7)
&gt; integer_and_fraction round nc;
(-3,-1%7)
&gt;
</pre>
<p>It is always the case that z and f have the property that q = z + f. However,
the remaining properties depend upon the choice of <a class="reference internal" href="#roundfun">roundfun</a>.
Thus this provides a ‘decomposition’ operator; there are others (see
<a class="reference internal" href="#decomposition">Decomposition</a>).
If <a class="reference internal" href="#roundfun">roundfun</a> = <a class="reference internal" href="#floor">floor</a> then 0 ≤ f &lt; 1. If Round = <a class="reference internal" href="#ceil">ceil</a> then −1 &lt; f ≤ 0.
If <a class="reference internal" href="#roundfun">roundfun</a> = <a class="reference internal" href="#trunc">trunc</a> then |f| &lt; 1 and sgn f ∈ {0, sgn q}.
If <a class="reference internal" href="#roundfun">roundfun</a> = <a class="reference internal" href="#round">round</a>, <a class="reference internal" href="#roundfun">roundfun</a> = <a class="reference internal" href="#round-zero-bias">round_zero_bias</a> or <a class="reference internal" href="#roundfun">roundfun</a> =
<a class="reference internal" href="#round-unbiased">round_unbiased</a> then |f| ≤ 1/2.</p>
<a name="fraction"><table class="docutils field-list" frame="void" id="fraction" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">fraction roundfun q:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">returns just the ‘fraction part’ as a <tt class="docutils literal"><span class="pre">rational</span></tt>, where the rounding
operations are performed using <a class="reference internal" href="#roundfun">roundfun</a>. The corresponding function
‘integer’ is not provided, as integer <a class="reference internal" href="#roundfun">roundfun</a> q would be just
<a class="reference internal" href="#roundfun">roundfun</a> q. The integer and fraction function (probably with <a class="reference internal" href="#trunc">trunc</a> or
<a class="reference internal" href="#floor">floor</a> rounding mode) may be used in conjunction with <a class="reference internal" href="#num-den">num_den</a> (see
<a class="reference internal" href="#deconstructors">'Deconstructors'</a>) to decompose a <tt class="docutils literal"><span class="pre">rational</span></tt> into integer, numerator and
denominator parts.</td>
</tr>
</tbody>
</table>
<a name="int"><table class="docutils field-list" frame="void" id="int" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">int q:</th><td class="field-body">overloads the built-in int and returns the ‘integer part’ of q consistent with
the built-in.</td>
</tr>
</tbody>
</table>
<a name="frac"><table class="docutils field-list" frame="void" id="frac" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">frac q:</th><td class="field-body">overloads the built-in frac and returns the ‘fraction part’ of q consistent
with the built-in.</td>
</tr>
</tbody>
</table>
<p><strong>Example 29</strong> Standard integer and fraction parts:</p>
<pre class="literal-block">
&gt; let nc = -22%7;
&gt; int nc;
-3.0
&gt; frac nc;
-0.142857142857143
&gt;
</pre>
</div>
</div>
<div class="section" id="rounding-to-multiples">
<h1><a class="toc-backref" href="#id65">9&nbsp;&nbsp;&nbsp;Rounding to Multiples</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">round_to_multiple roundfun multOf q:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">returns q rounded to an integer multiple of a non-zero value multOf, using
<a class="reference internal" href="#roundfun">roundfun</a> as the rounding mode (see <a class="reference internal" href="#rounding-to-integer">Rounding to Integer</a>). Note that it
is the multiple that is rounded in the prescribed way, and not the final
result, which may make a difference in the case that multOf is negative. If
that is not the desired behaviour, pass this function the absolute value of
multOf rather than multOf. Similar comments apply to the following functions.</td>
</tr>
</tbody>
</table>
<a name="floor_multiple"><table class="docutils field-list" frame="void" id="floor-multiple" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">floor_multiple multOf q:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">returns q rounded to a downwards integer multiple of multOf.</td>
</tr>
</tbody>
</table>
<a name="ceil_multiple"><table class="docutils field-list" frame="void" id="ceil-multiple" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">ceil_multiple multOf q:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">returns q rounded to an upwards integer multiple of multOf.</td>
</tr>
</tbody>
</table>
<a name="trunc_multiple"><table class="docutils field-list" frame="void" id="trunc-multiple" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">trunc_multiple multOf q:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">returns q rounded towards zero to an integer multiple of multOf.</td>
</tr>
</tbody>
</table>
<a name="round_multiple"><table class="docutils field-list" frame="void" id="round-multiple" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">round_multiple multOf q:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">returns q rounded towards the nearest integer multiple of multOf, with
half-integer multiples rounded away from 0.</td>
</tr>
</tbody>
</table>
<a name="round_multiple_zero_bias"><table class="docutils field-list" frame="void" id="round-multiple-zero-bias" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">round_multiple_zero_bias multOf q:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">returns q rounded towards the nearest integer multiple of multOf, with
half-integer multiples rounded towards 0.</td>
</tr>
</tbody>
</table>
<a name="round_multiple_unbiased"><table class="docutils field-list" frame="void" id="round-multiple-unbiased" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">round_multiple_unbiased multOf q:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">returns q rounded towards the nearest integer multiple of multOf, with
half-integer multiples rounded to an even multiple.</td>
</tr>
</tbody>
</table>
<p><strong>Example 30</strong> Round to multiple:</p>
<pre class="literal-block">
&gt; let l = [34.9, 35, 35%1, 35.0, 35.1];
&gt; map double l; // (just to show the values in a familiar format)
[34.9,35.0,35.0,35.0,35.1]
&gt; map (floor_multiple 10) l;
[30,30,30,30,30]
&gt; map (ceil_multiple 10) l;
[40,40,40,40,40]
&gt; map (trunc_multiple 10) l;
[30,30,30,30,30]
&gt; map (round_multiple 10) l;
[30,40,40,40,40]
&gt; map (round_multiple_zero_bias 10) l;
[30,30,30,30,40]
&gt; map (round_multiple_unbiased 10) l;
[30,40,40,40,40]
</pre>
<p>(See the function <a class="reference internal" href="#double">double</a>.)</p>
<p>The round multiple functions may be used to find a fixed denominator
approximation of a number. (The simplest denominator may actually be a proper
factor of the chosen value.) To approximate for a bounded (rather than
particular) denominator, use rational approx max den instead (see <a class="reference internal" href="#best-approximation-with-bounded-denominator">Best
Approximation with Bounded Denominator</a>).</p>
<p><strong>Example 31</strong> Finding the nearest q = n/d value to 1/e ≈ 0.368 where d = 1000
(actually, where d|1000):</p>
<pre class="literal-block">
&gt; let co_E = exp (-1);
co_E;
0.367879441171442
&gt; round_multiple (1%1000) co_E;
46%125
&gt; 1000 * ans;
368%1
&gt;
</pre>
<p><strong>Example 32</strong> Finding the nearest q = n/d value to 1/ɸ ≈ 0.618 where d = 3<sup>5</sup> = 243 (actually, where d|243):</p>
<pre class="literal-block">
&gt; let co_Phi = (sqrt 5 - 1) / 2;
&gt; round_multiple (1%243) co_Phi;
50%81
&gt;
</pre>
<p>Other methods for obtaining a <tt class="docutils literal"><span class="pre">rational</span></tt> approximation of a number are
described in <a class="reference internal" href="#r-q-approximation">R → Q — Approximation</a>.</p>
</div>
<div class="section" id="q-r-conversion-casting">
<h1><a class="toc-backref" href="#id66">10&nbsp;&nbsp;&nbsp;<strong>Q</strong> → <strong>R</strong> — Conversion / Casting</a></h1>
<a name="double"><table class="docutils field-list" frame="void" id="double" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">double q:</th><td class="field-body">(overload of built-in) returns a <tt class="docutils literal"><span class="pre">double</span></tt> having a value as close as
possible to q. (Overflow, underflow and loss of accuracy are potential
problems. <tt class="docutils literal"><span class="pre">rationals</span></tt> that are too absolutely large or too absolutely small
may overflow or underflow; some <tt class="docutils literal"><span class="pre">rationals</span></tt> can not be represented exactly
as a <tt class="docutils literal"><span class="pre">double</span></tt>.)</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="r-q-approximation">
<h1><a class="toc-backref" href="#id67">11&nbsp;&nbsp;&nbsp;<strong>R</strong> → <strong>Q</strong> — Approximation</a></h1>
<p>This section describes functions that approximate a number (usually a
<tt class="docutils literal"><span class="pre">double</span></tt>) by a <tt class="docutils literal"><span class="pre">rational</span></tt>. See <a class="reference internal" href="#rounding-to-multiples">Rounding to Multiples</a> for approximation of
a number by a <tt class="docutils literal"><span class="pre">rational</span></tt> with a fixed denominator. See <a class="reference internal" href="#numeral-string-q-approximation">Numeral String → Q
— Approximation</a> for approximation by a <tt class="docutils literal"><span class="pre">rational</span></tt> of a string representation
of a real number.</p>
<div class="section" id="intervals">
<h2><a class="toc-backref" href="#id68">11.1&nbsp;&nbsp;&nbsp;Intervals</a></h2>
<p>Some of the approximation functions return an <tt class="docutils literal"><span class="pre">interval</span></tt>. The file
<tt class="docutils literal"><span class="pre">rat_interval.pure</span></tt> is a basic implementation of interval arithmetic, and is
not included in the default prelude. It is not intended to provide a complete
implementation of interval arithmetic. The notions of ‘open’ and ‘closed’
intervals are not distinguished. Infinite and half-infinite intervals are not
specifically provided. Some operations and functions may be missing. The most
likely functions to be used are simply the ‘deconstructors’; see <a class="reference internal" href="#interval-constructors-and-deconstructors">Interval
Constructors and 'Deconstructors'</a>.</p>
<div class="section" id="interval-constructors-and-deconstructors">
<h3><a class="toc-backref" href="#id69">11.1.1&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">interval</span></tt> Constructors and 'Deconstructors'</a></h3>
<p>Intervals are constructed with the function interval.</p>
<a name="interval"><table class="docutils field-list" frame="void" id="interval" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">interval (n1, n2):</th></tr>
<tr><td>&nbsp;</td><td class="field-body">given a pair of numbers (z1 &lt;= z2), this returns the <tt class="docutils literal"><span class="pre">interval</span></tt> z1..z2. This
is the inverse of <tt class="docutils literal"><span class="pre">lo_up</span></tt>.</td>
</tr>
</tbody>
</table>
<p><strong>Example 33</strong> Constructing an interval:</p>
<pre class="literal-block">
&gt; let v = interval (3, 8);
&gt; v;
interval::Ivl 3 8
&gt;
</pre>
<a name="lower"><table class="docutils field-list" frame="void" id="lower" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">lower v:</th><td class="field-body">returns the infimum (roughly, minimum) of v.</td>
</tr>
</tbody>
</table>
<a name="upper"><table class="docutils field-list" frame="void" id="upper" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">upper v:</th><td class="field-body">returns the supremum (roughly, maximum) of v.</td>
</tr>
</tbody>
</table>
<a name="lo_up"><table class="docutils field-list" frame="void" id="lo-up" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">lo_up v:</th><td class="field-body">returns a pair (l, u) containing the lower l and upper u extrema of the
interval v. This is the inverse of interval as defined on number pairs.</td>
</tr>
</tbody>
</table>
<p><strong>Example 34</strong> Deconstructing an interval:</p>
<pre class="literal-block">
&gt; lower v;
3
&gt; upper v;
8
&gt; lo_up v;
(3,8)
&gt;
</pre>
</div>
<div class="section" id="interval-type-tests">
<h3><a class="toc-backref" href="#id70">11.1.2&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">interval</span></tt> Type Tests</a></h3>
<a name="exactp (intervals)"><table class="docutils field-list" frame="void" id="exactp-intervals" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">exactp v:</th><td class="field-body">returns whether an interval v has exact extrema.</td>
</tr>
</tbody>
</table>
<a name="inexactp (intervals)"><table class="docutils field-list" frame="void" id="inexactp-intervals" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">inexactp v:</th><td class="field-body">returns whether an interval v has an inexact extremum.</td>
</tr>
</tbody>
</table>
<a name="intervalp"><table class="docutils field-list" frame="void" id="intervalp" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">intervalp x:</th><td class="field-body">returns whether x is of type <tt class="docutils literal"><span class="pre">interval</span></tt>.</td>
</tr>
</tbody>
</table>
<a name="interval_valp"><table class="docutils field-list" frame="void" id="interval-valp" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">interval_valp x:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">returns whether x has an interval value.</td>
</tr>
</tbody>
</table>
<a name="ratinterval_valp"><table class="docutils field-list" frame="void" id="ratinterval-valp" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">ratinterval_valp x:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">returns whether x has an interval value with rational extrema.</td>
</tr>
</tbody>
</table>
<a name="intinterval_valp"><table class="docutils field-list" frame="void" id="intinterval-valp" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">intinterval_valp x:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">returns whether x has an interval value with integral extrema.</td>
</tr>
</tbody>
</table>
<p><strong>Example 35</strong> <tt class="docutils literal"><span class="pre">interval</span></tt> value tests:</p>
<pre class="literal-block">
&gt; let l = [interval(0,1), interval(0,1%1), interval(0,3%2), interval(0,1.5)];
&gt; map exactp l;
[1,1,1,0]
&gt; map inexactp l
[0,0,0,1]
&gt; map intervalp l;
[1,1,1,1]
&gt; map interval_valp l;
[1,1,1,1,]
&gt; map ratinterval_valp l;
[1,1,1,1]
&gt; map intinterval_valp l;
[1,1,0,0]
</pre>
</div>
<div class="section" id="interval-arithmetic-operators-and-relations">
<h3><a class="toc-backref" href="#id71">11.1.3&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">interval</span></tt> Arithmetic Operators and Relations</a></h3>
<a name="+ (intervals)"><a name="- (intervals)"><a name="* (intervals)"><a name="/ (intervals)"><a name="% (intervals)"><p id="id17">The standard arithmetic operators (+), (−), (*), (/) and (%) are overloaded for
<tt class="docutils literal"><span class="pre">intervals</span></tt>. The divide operators (/) and (%) do not produce a result if the
right operand is an interval containing 0.</p>
<a name="Example 36"><p id="example-36"><strong>Example 36</strong> Some intervals:</p>
<pre class="literal-block">
&gt; let a = interval (11, 19);
&gt; let b = interval (16, 24);
&gt; let c = interval (21, 29);
&gt; let d = interval (23, 27);
&gt;
</pre>
<p><strong>Example 37</strong> <tt class="docutils literal"><span class="pre">interval</span></tt> arithmetic:</p>
<pre class="literal-block">
&gt; let p = interval (0, 1);
&gt; let s = interval (-1, 1);
&gt; a + b;
interval::Ivl 27 43
&gt; a - b;
interval::Ivl -13 3
&gt; a * b;
interval::Ivl 176 456
&gt; p * 2;
interval::Ivl 0 2
&gt; (-2) * p;
interval::Ivl -2 0
&gt; -c;
interval::Ivl -29 -21
&gt; s * a;
interval::Ivl -19 19
&gt; a % 2;
interval::Ivl (11%2) (19%2)
&gt; a / 2;
interval::Ivl 5.5 9.5
&gt; reciprocal a;
interval::Ivl (1%19) (1%11)
&gt; 2 % a;
interval::Ivl (2%19) (2%11)
&gt; a % b
interval::Ivl 11%24 19%16
&gt; a % a; // notice that the intervals are mutually independent here
interval::Ivl (11%19) (19%11)
&gt;
</pre>
<a name="== (intervals)"><a name="~= (intervals)"><p id="id19">There are also some relations defined for <tt class="docutils literal"><span class="pre">intervals</span></tt>. The standard relations
(==) and (~=) are overloaded.</p>
<p>However, rather than overloading (&lt;), (&lt;=), (&gt;), (&gt;=), which could be used for
either ordering or containment with some ambiguity, the module defines
<tt class="docutils literal"><span class="pre">(before)</span></tt>, <tt class="docutils literal"><span class="pre">(within)</span></tt>, and so on. ‘Strictness’ refers to the properties at
the end-points.</p>
<a name="before"><table class="docutils field-list" frame="void" id="before" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">v1 before v2:</th><td class="field-body">returns whether v1 is entirely before v2.</td>
</tr>
</tbody>
</table>
<a name="strictly_before"><table class="docutils field-list" frame="void" id="strictly-before" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">v1 strictly_before v2:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">returns whether v1 is strictly entirely before v2.</td>
</tr>
</tbody>
</table>
<a name="after"><table class="docutils field-list" frame="void" id="after" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">v1 after v2:</th><td class="field-body">returns whether v1 is entirely after v2.</td>
</tr>
</tbody>
</table>
<a name="strictly_after"><table class="docutils field-list" frame="void" id="strictly-after" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">v1 strictly_after v2:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">returns whether v1 is strictly entirely after v2.</td>
</tr>
</tbody>
</table>
<a name="within"><table class="docutils field-list" frame="void" id="within" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">v1 within v2:</th><td class="field-body">returns whether v1 is entirely within v2; i.e. whether v1 is subinterval of
v2.</td>
</tr>
</tbody>
</table>
<a name="strictly_within"><table class="docutils field-list" frame="void" id="strictly-within" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">v1 strictly_within v2:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">returns whether v1 is strictly entirely within v2; i.e. whether v1 is proper
subinterval of v2.</td>
</tr>
</tbody>
</table>
<a name="without"><table class="docutils field-list" frame="void" id="without" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">v1 without v2:</th><td class="field-body">returns whether v1 entirely contains v2; i.e. whether v1 is superinterval of
v2. 'Without' is used in the sense of outside or around.</td>
</tr>
</tbody>
</table>
<a name="strictly_without"><table class="docutils field-list" frame="void" id="strictly-without" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">v1 strictly_without v2:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">returns whether v1 strictly entirely contains v2; i.e. whether v1 is proper
superinterval of v2.</td>
</tr>
</tbody>
</table>
<a name="disjoint"><table class="docutils field-list" frame="void" id="disjoint" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">v1 disjoint v2:</th><td class="field-body">returns whether v1 and v2 are entirely disjoint.</td>
</tr>
</tbody>
</table>
<a name="strictly_disjoint"><table class="docutils field-list" frame="void" id="strictly-disjoint" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">v strictly_disjoint v2:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">returns whether v1 and v2 are entirely strictly disjoint.</td>
</tr>
</tbody>
</table>
<p><strong>Example 38</strong> <tt class="docutils literal"><span class="pre">interval</span></tt> relations:</p>
<pre class="literal-block">
&gt; a == b;
0
&gt; a == a;
1
&gt; a before b;
0
&gt; a before c;
1
&gt; c before a;
0
&gt; a disjoint b;
0
&gt; c disjoint a;
1
&gt; a within b;
0
&gt; a within c;
0
&gt; d within c;
1
&gt; c within d;
0
&gt; a strictly_within a;
0
&gt; a within a;
1
&gt;
</pre>
<p>(The symbols a through d were defined in <a class="reference internal" href="#example-36">Example 36</a>.)</p>
<p>These may also be used with a simple (<tt class="docutils literal"><span class="pre">real</span></tt>) value, and in particular to test
membership.</p>
<p><strong>Example 39</strong> Membership:</p>
<pre class="literal-block">
&gt; 10 within a;
0
&gt; 11 within a;
1
&gt; 11.0 within a;
1
&gt; 12 within a;
1
&gt; 12.0 within a;
1
&gt; 10 strictly_within a;
0
&gt; 11 strictly_within a;
0
&gt; (11%1) strictly_within a;
0
&gt; 12 strictly_within a;
1
&gt; (12%1) strictly_within a;
1
&gt;
</pre>
<p>(The symbol a was defined in <a class="reference internal" href="#example-36">Example 36</a>.)</p>
</div>
<div class="section" id="interval-maths">
<h3><a class="toc-backref" href="#id72">11.1.4&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">interval</span></tt> Maths</a></h3>
<p>Some standard functions are overloaded for intervals; some new functions are
provided.</p>
<a name="abs (intervals)"><table class="docutils field-list" frame="void" id="abs-intervals" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">abs v:</th><td class="field-body">returns the interval representing the range of (x) as x varies over v.</td>
</tr>
</tbody>
</table>
<p><strong>Example 40</strong> Absolute interval:</p>
<pre class="literal-block">
&gt; abs (interval (1, 5));
interval::Ivl 1 5
&gt; abs (interval (-1, 5));
interval::Ivl 0 5
&gt; abs (interval (-5, -1));
interval::Ivl 1 5
&gt;
</pre>
<a name="sgn (intervals)"><table class="docutils field-list" frame="void" id="sgn-intervals" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">sgn v:</th><td class="field-body">returns the interval representing the range of sgn(x) as x varies over v.</td>
</tr>
</tbody>
</table>
<a name="# (intervals)"><table class="docutils field-list" frame="void" id="id20" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">#v:</th><td class="field-body">returns the length of an interval.</td>
</tr>
</tbody>
</table>
<p><strong>Example 41</strong> Absolute interval:</p>
<pre class="literal-block">
&gt; #d;
4
</pre>
<p>(The symbol d was defined in <a class="reference internal" href="#example-36">Example 36</a>.)</p>
</div>
</div>
<div class="section" id="least-complex-approximation-within">
<h2><a class="toc-backref" href="#id73">11.2&nbsp;&nbsp;&nbsp;Least <tt class="docutils literal"><span class="pre">complex</span></tt> Approximation within ε</a></h2>
<a name="rational_approx_epsilon"><table class="docutils field-list" frame="void" id="rational-approx-epsilon" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">rational_approx_epsilon ε r:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">Find the least complex (see <a class="reference internal" href="#complexity-extrema">Complexity Extrema</a>) <tt class="docutils literal"><span class="pre">rational</span></tt> approximation
to r (usually a <tt class="docutils literal"><span class="pre">double</span></tt>) that is ε-close. That is find the q with the
smallest possible denominator such that such that |q − r| ≤ ε. (ε &gt; 0.)</td>
</tr>
</tbody>
</table>
<p><strong>Example 42</strong> <tt class="docutils literal"><span class="pre">rational</span></tt> approximation to π ≈ 3.142 ≈ 22/7:</p>
<pre class="literal-block">
&gt; rational_approx_epsilon .01 pi;
22%7
&gt; abs (ans - pi);
0.00126448926734968
&gt;
</pre>
<a name="Example 43"><p id="example-43"><strong>Example 43</strong> The golden ratio ɸ = (1 + √5) / 2 ≈ 1.618:</p>
<pre class="literal-block">
&gt; let phi = (1 + sqrt 5) / 2;
&gt; rational_approx_epsilon .001 phi;
55%34
&gt; abs (ans - phi);
0.000386929926365465
&gt;
</pre>
<a name="rational_approxs_epsilon"><table class="docutils field-list" frame="void" id="rational-approxs-epsilon" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">rational_approxs_epsilon ε r:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">Produce a list of ever better <tt class="docutils literal"><span class="pre">rational</span></tt> approximations to r (usually a
<tt class="docutils literal"><span class="pre">double</span></tt>) that is eventually ε-close. (ε &gt; 0.)</td>
</tr>
</tbody>
</table>
<p><strong>Example 44</strong> <tt class="docutils literal"><span class="pre">rational</span></tt> approximations to π:</p>
<pre class="literal-block">
&gt; rational_approxs_epsilon .0001 pi;
[3%1,25%8,47%15,69%22,91%29,113%36,135%43,157%50,179%57,201%64,223%71,245%78,
267%85,289%92,311%99,333%106]
&gt;
</pre>
<p><strong>Example 45</strong> <tt class="docutils literal"><span class="pre">rational</span></tt> approximations to the golden ratio ɸ; these
approximations are always reverse consecutive Fibonacci numbers (from f1: 1, 1,
2, 3, 5, 8, 13, 21, 34, 55, 89, . . .):</p>
<pre class="literal-block">
&gt; rational_approxs_epsilon .0001 phi;
[1%1,3%2,8%5,21%13,55%34,144%89]
&gt;
</pre>
<p>(The symbol phi was defined in <a class="reference internal" href="#example-43">Example 43</a>.)</p>
<a name="rational_interval_epsilon"><table class="docutils field-list" frame="void" id="rational-interval-epsilon" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">rational_interval_epsilon ε r:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">Find the least complex (see <a class="reference internal" href="#complexity-extrema">Complexity Extrema</a>) <tt class="docutils literal"><span class="pre">rational</span></tt> interval
containing r (usually a <tt class="docutils literal"><span class="pre">double</span></tt>) that is ε-small. That is find the least
complex (see <a class="reference internal" href="#complexity-extrema">Complexity Extrema</a>) q1 ≤ q2 such that r ∈ [q1, q2] and
q2 − q1 ≤ ε. (ε &gt; 0.)</td>
</tr>
</tbody>
</table>
<p><strong>Example 46</strong> <tt class="docutils literal"><span class="pre">rational</span></tt> interval surrounding π:</p>
<pre class="literal-block">
&gt; let i_Pi = rational_interval_epsilon .01 pi;
&gt; i_Pi;
interval::Ivl (47%15) (22%7)
&gt; double (lower i_Pi); pi; double (upper i_Pi);
3.13333333333333
3.14159265358979
3.14285714285714
&gt;
</pre>
<p>(The functions lower and upper are described in <a class="reference internal" href="#interval-constructors-and-deconstructors">Interval Constructors and
'Deconstructors'</a>.)</p>
<p><strong>Example 47</strong> <tt class="docutils literal"><span class="pre">rational</span></tt> interval surrounding the golden ratio ɸ:</p>
<pre class="literal-block">
&gt; rational_interval_epsilon .001 phi
interval::Ivl (55%34) (89%55)
&gt; #ans;
1%1870
</pre>
<p>(The symbol Phi was defined in <a class="reference internal" href="#example-43">Example 43</a>. The function <a class="reference internal" href="#id20"># (intervals)</a> is
described in <a class="reference internal" href="#interval-maths">Interval Maths</a>.)</p>
</div>
<div class="section" id="best-approximation-with-bounded-denominator">
<h2><a class="toc-backref" href="#id74">11.3&nbsp;&nbsp;&nbsp;Best Approximation with Bounded Denominator</a></h2>
<a name="rational_approx_max_den"><table class="docutils field-list" frame="void" id="rational-approx-max-den" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">rational_approx_max_den maxDen r:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">Find the closest <tt class="docutils literal"><span class="pre">rational</span></tt> approximation to r (usually a <tt class="docutils literal"><span class="pre">double</span></tt>) that
has a denominator no greater than maxDen. (maxDen &gt; 0).</td>
</tr>
</tbody>
</table>
<p><strong>Example 48</strong> <tt class="docutils literal"><span class="pre">rational</span></tt> approximation to π:</p>
<pre class="literal-block">
&gt; rational_approx_max_den 10 pi;
22%7
&gt;
</pre>
<p><strong>Example 49</strong> <tt class="docutils literal"><span class="pre">rational</span></tt> approximation to the golden ratio ɸ:</p>
<pre class="literal-block">
&gt; rational_approx_max_den 1000 phi;
1597%987
&gt;
</pre>
<p>(The symbol phi was defined in <a class="reference internal" href="#example-43">Example 43</a>.)</p>
<a name="rational_approxs_max_den"><table class="docutils field-list" frame="void" id="rational-approxs-max-den" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">rational_approxs_max_den maxDen r:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">Produce a list of ever better <tt class="docutils literal"><span class="pre">rational</span></tt> approximations to r (usually a
<tt class="docutils literal"><span class="pre">double</span></tt>) while the denominator is bounded by maxDen (maxDen &gt; 0).</td>
</tr>
</tbody>
</table>
<p><strong>Example 50</strong> <tt class="docutils literal"><span class="pre">rational</span></tt> approximations to π:</p>
<pre class="literal-block">
&gt; rational_approxs_max_den 100 pi;
[3%1,25%8,47%15,69%22,91%29,113%36,135%43,157%50,179%57,201%64,223%71,245%78,
267%85,289%92,311%99]
&gt;
</pre>
<p><strong>Example 51</strong> <tt class="docutils literal"><span class="pre">rational</span></tt> approximations to the golden ratio ɸ:</p>
<pre class="literal-block">
&gt; rational_approxs_max_den 100 phi;
[1%1,3%2,8%5,21%13,55%34,144%89]
&gt;
</pre>
<p>(The symbol phi was defined in <a class="reference internal" href="#example-43">Example 43</a>.)</p>
<a name="rational_interval_max_den"><table class="docutils field-list" frame="void" id="rational-interval-max-den" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">rational_interval_max_den maxDen r:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">Find the smallest <tt class="docutils literal"><span class="pre">rational</span></tt> interval containing r (usually a <tt class="docutils literal"><span class="pre">double</span></tt>)
that has endpoints with denominators no greater than maxDen (maxDen &gt; 0).</td>
</tr>
</tbody>
</table>
<p><strong>Example 52</strong> <tt class="docutils literal"><span class="pre">rational</span></tt> interval surrounding π:</p>
<pre class="literal-block">
&gt; let i_Pi = rational_interval_max_den 100 pi ; i_Pi
interval::Ivl (311%99) (22%7)
&gt; double (lower i_Pi); pi; double (upper i_Pi);
3.14141414141414
3.14159265358979
3.14285714285714
&gt;
</pre>
<p><strong>Example 53</strong> <tt class="docutils literal"><span class="pre">rational</span></tt> interval surrounding the golden ratio ɸ:</p>
<pre class="literal-block">
&gt; rational_interval_max_den 1000 phi
interval::Ivl (987%610) (1597%987)
&gt;
</pre>
<p>(The symbol phi was defined in <a class="reference internal" href="#example-43">Example 43</a>.)</p>
<p>To approximate for a particular (rather than bounded) denominator, use round to
multiple instead (see <a class="reference internal" href="#rounding-to-multiples">Rounding to Multiples</a>).</p>
</div>
</div>
<div class="section" id="decomposition">
<h1><a class="toc-backref" href="#id75">12&nbsp;&nbsp;&nbsp;Decomposition</a></h1>
<p>There is more than one way to ‘decompose’ a rational number into its
‘components’. It might be split into an integer and a fraction part — see
<a class="reference internal" href="#integer-and-fraction-parts">Integer and Fraction Parts</a>; or sign and absolute value — see <a class="reference internal" href="#absolute-value-and-sign">Absolute Value
and Sign</a>; or numerator and denominator — see <a class="reference internal" href="#deconstructors">'Deconstructors'</a>.</p>
</div>
<div class="section" id="continued-fractions">
<h1><a class="toc-backref" href="#id76">13&nbsp;&nbsp;&nbsp;Continued Fractions</a></h1>
<div class="section" id="id21">
<h2><a class="toc-backref" href="#id77">13.1&nbsp;&nbsp;&nbsp;Introduction</a></h2>
<p>In &quot;pure-rational&quot;, a continued fraction
a<sub>0</sub> + (1 / (a<sub>1</sub> + (1 / (a<sub>2</sub> + · · · + 1 / a<sub>n</sub>)))) where ∀i &gt; 0 • a<sub>i</sub> ≠ 0, is represented by [a<sub>0</sub>, a<sub>1</sub>, a<sub>2</sub>, . . . , a<sub>n</sub>].</p>
<p>A ‘simple’ continued fraction is one in which ∀i • a<sub>i</sub> ∈ <strong>Z</strong> and ∀i &gt;
0 • a<sub>i</sub> &gt; 0.</p>
<p>Simple continued fractions for rationals are not quite unique since [a<sub>0</sub>, a<sub>1</sub>, . . . , a<sub>n</sub>, 1] = [a<sub>0</sub>, a<sub>1</sub>, . .
. , a<sub>n+1</sub>]. We will refer to these as the 'non-standard' and 'standard'
forms, respectively. The following functions return the standard form.</p>
</div>
<div class="section" id="generating-continued-fractions">
<h2><a class="toc-backref" href="#id78">13.2&nbsp;&nbsp;&nbsp;Generating Continued Fractions</a></h2>
<div class="section" id="exact">
<h3><a class="toc-backref" href="#id79">13.2.1&nbsp;&nbsp;&nbsp;Exact</a></h3>
<a name="continued_fraction"><table class="docutils field-list" frame="void" id="continued-fraction" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">continued_fraction q:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">Find ‘the’ (exact) continued fraction of a rational (including, trivially,
integer) value q.</td>
</tr>
</tbody>
</table>
<p><strong>Example 54</strong> The rational 1234/1001:</p>
<pre class="literal-block">
&gt; continued_fraction (1234%1001);
[1,4,3,2,1,1,1,8]
&gt; evaluate_continued_fraction ans;
1234%1001
</pre>
</div>
<div class="section" id="inexact">
<h3><a class="toc-backref" href="#id80">13.2.2&nbsp;&nbsp;&nbsp;Inexact</a></h3>
<a name="continued_fraction_max_terms"><table class="docutils field-list" frame="void" id="continued-fraction-max-terms" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">continued_fraction_max_terms n r:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">Find up to n initial terms of continued fraction of the value r with the
‘remainder’, if any, in the final element. (If continued_fraction_max_terms n
r returns a list of length n or less, then the result is exact.)</td>
</tr>
</tbody>
</table>
<p><strong>Example 55</strong> First 5 terms of the continued fraction for the golden ratio ɸ:</p>
<pre class="literal-block">
&gt; continued_fraction_max_terms 5 phi;
  [1,1,1,1,1,1.61803398874989]
&gt; evaluate_continued_fraction ans;
1.61803398874989
&gt;
</pre>
<p>(The symbol phi was defined in <a class="reference internal" href="#example-43">Example 43</a>.)</p>
<a name="continued_fraction_epsilon"><table class="docutils field-list" frame="void" id="continued-fraction-epsilon" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">continued_fraction_epsilon ε r:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">Find enough of the initial terms of a continued fraction to within ε of the
value r with the ‘remainder’, if any, in the final element.</td>
</tr>
</tbody>
</table>
<p><strong>Example 56</strong> First few terms of the value √2:</p>
<pre class="literal-block">
&gt; continued_fraction_epsilon .001 (sqrt 2);
[1,2,2,2,2,2.41421356237241]
&gt; map double (convergents ans);
[1.0,1.5,1.4,1.41666666666667,1.41379310344828,1.41421356237309]
&gt;
</pre>
</div>
</div>
<div class="section" id="evaluating-continued-fractions">
<h2><a class="toc-backref" href="#id81">13.3&nbsp;&nbsp;&nbsp;Evaluating Continued Fractions</a></h2>
<a name="_evaluate_continued_fraction"><table class="docutils field-list" frame="void" id="evaluate-continued-fraction" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">evaluate_continued_fraction aa:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">Fold a continued fraction aa into the value it represents. This function is
not limited to simple continued fractions. (Exact simple continued fractions
are folded into a rational.)</td>
</tr>
</tbody>
</table>
<p><strong>Example 57</strong> The continued fraction [1, 2, 3, 4] and the non-standard form [4,
3, 2, 1]:</p>
<pre class="literal-block">
&gt; evaluate_continued_fraction [1,2,3,4];
43%30
&gt; continued_fraction ans;
[1,2,3,4]
&gt; evaluate_continued_fraction [4,3,2,1];
43%10
&gt; continued_fraction ans;
[4,3,3]
&gt;
</pre>
<div class="section" id="convergents">
<h3><a class="toc-backref" href="#id82">13.3.1&nbsp;&nbsp;&nbsp;Convergents</a></h3>
<a name="convergents"><table class="docutils field-list" frame="void" id="id22" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">convergents aa:</th><td class="field-body">Calculate the convergents of the continued fraction aa. This function is not
limited to simple continued fractions.</td>
</tr>
</tbody>
</table>
<p><strong>Example 58</strong> Convergents of a continued fraction approximation of the value
√2:</p>
<pre class="literal-block">
&gt; continued_fraction_max_terms 5 (sqrt 2);
[1,2,2,2,2,2.41421356237241]
&gt; convergents ans;
[1%1,3%2,7%5,17%12,41%29,1.41421356237309]
&gt;
</pre>
</div>
</div>
</div>
<div class="section" id="rational-complex-numbers">
<h1><a class="toc-backref" href="#id83">14&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">rational</span></tt> <tt class="docutils literal"><span class="pre">complex</span></tt> Numbers</a></h1>
<p>Pure together with <tt class="docutils literal"><span class="pre">rational.pure</span></tt> provide various types of number, including
<tt class="docutils literal"><span class="pre">integers</span></tt> (<strong>Z</strong>), <tt class="docutils literal"><span class="pre">doubles</span></tt> (<strong>R</strong>, roughly), <tt class="docutils literal"><span class="pre">complex</span></tt> numbers (<strong>C</strong>)
and Gaussian integers (<strong>Z</strong>[i]), <tt class="docutils literal"><span class="pre">rationals</span></tt> (<strong>Q</strong>) and rational complex
numbers (<strong>Q</strong>[i]).</p>
<p>Functions concerning 'complex numbers' are named with 'comp', whereas functions
concerning 'complexity' (see <a class="reference internal" href="#complexity">Complexity</a>) are named with ‘cplx’.</p>
<a name="+:"><div class="section" id="rational-complex-constructors-and-deconstructors">
<span id="id23"></span><h2><a class="toc-backref" href="#id84">14.1&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">rational</span></tt> <tt class="docutils literal"><span class="pre">complex</span></tt> Constructors and 'Deconstructors'</a></h2>
<p><tt class="docutils literal"><span class="pre">complex</span></tt> numbers can have rational parts.</p>
<p><strong>Example 59</strong> Forming a <tt class="docutils literal"><span class="pre">rational</span></tt> <tt class="docutils literal"><span class="pre">complex</span></tt>:</p>
<pre class="literal-block">
&gt; 1 +: 1 * (1%2);
1%1+:1%2
&gt; ans * ans;
3%4+:1%1
&gt;
</pre>
<p>And rational numbers can be given complex parts.</p>
<p><strong>Example 60</strong> <tt class="docutils literal"><span class="pre">complex</span></tt> <tt class="docutils literal"><span class="pre">rationals</span></tt> and complicated <tt class="docutils literal"><span class="pre">rationals</span></tt>:</p>
<pre class="literal-block">
&gt; (1 +: 2) % (3 +: 4);
11%25+:2%25
&gt; ans * (3 +: 4);
1%1+:2%1
&gt; ((4%1) * (0 +: 1)) % 2;
0%1+:2%1
&gt; ((4%1) * (0 +: 1)) % (1%2);
0%1+:8%1
&gt; ((4%1) * (0 +: 1)) % (1 + (1%2) * (0 +: 1));
8%5+:16%5
&gt; ans * (1+(1%2) * (0 +: 1));
0%1+:4%1
&gt; ((4%1) * (0 +: 1)) / (1 + (1%2) * (0 +: 1));
1.6+:3.2
&gt;
</pre>
<a name="re"><a name="im"><p id="im">The various parts of a complex rational may be deconstructed using combinations
of num and den and the standard functions re and im.</p>
<p>Thus, taking real and imaginary parts first, a rational complex number may be
considered to be (x<sub>n</sub> / x<sub>d</sub>) + (y<sub>n</sub> / y<sub>d</sub>) * i
with x<sub>n</sub>, x<sub>d</sub>, y<sub>n</sub>, y<sub>d</sub> ∈ <strong>Z</strong>.</p>
<p>A rational complex number may also be decomposed into its ‘numerator’ and
‘denominator’, where these are both integral complex numbers, or ‘Gaussian
integers’, and the denominatoris a minimal choice in some sense.</p>
<p>One way to do this is so that the denominator is the minimum positive integer.
The denominator is a complex number with zero imaginary part.</p>
<p>Thus, taking numerator and denominator parts first, a rational complex number
may be considered to be (n<sub>x</sub> + n<sub>y</sub> * i) / (d + 0 * i) with n<sub>x</sub>, n<sub>y</sub>, d ∈ <strong>Z</strong>.</p>
<p>Another way to do this is so that the denominator is a Gaussian integer with
minimal absolute value. Thus, taking numerator and denominator parts first, a
rational complex number may be considered to be (n<sub>x</sub> + n<sub>y</sub> * i)
/ (d<sub>x</sub> + d<sub>y</sub> * i) with n<sub>x</sub>, n<sub>y</sub>, d<sub>x</sub>, d<sub>y</sub> ∈ <strong>Z</strong>.</p>
<p>The d<sub>x</sub>, d<sub>y</sub> are not unique, but can be chosen such that d<sub>x</sub> &gt; 0 and either |d<sub>y</sub>| &lt; d<sub>x</sub> or d<sub>y</sub> = d<sub>x</sub> &gt; 0.</p>
<a name="num_den_nat"><table class="docutils field-list" frame="void" id="num-den-nat" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">num_den_nat c:</th><td class="field-body"><p class="first">given a <tt class="docutils literal"><span class="pre">complex</span></tt> <tt class="docutils literal"><span class="pre">rational</span></tt> or <tt class="docutils literal"><span class="pre">integer</span></tt> c, returns a pair (n, d)
containing an integral complex (Gaussian integral) numerator n, and the
smallest natural (i.e. positive integral real) complex denominator d, i.e. a
complex number where ℜ(d) ∈ <strong>Z</strong>, ℜ(d) &gt; 0, ℑ(d) = 0; i.e. the numerator and
denominator of one ‘normalised’ form of c.</p>
<p class="last">This is an inverse (up to equivalence) of rational as defined on integral
complex pairs (see <a class="reference internal" href="#constructors">Constructors</a>).</p>
</td>
</tr>
</tbody>
</table>
<a name="num_den_gauss"><table class="docutils field-list" frame="void" id="num-den-gauss" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">num_den_gauss c:</th></tr>
<tr><td>&nbsp;</td><td class="field-body"><p class="first">given a <tt class="docutils literal"><span class="pre">complex</span></tt> <tt class="docutils literal"><span class="pre">rational</span></tt> or <tt class="docutils literal"><span class="pre">integer</span></tt> c, returns a pair (n, d)
containing an integral complex (Gaussian integral) numerator n, and an
absolutely smallest integral complex denominator d chosen s.t. ℜ(d),=(d) ∈
<strong>Z</strong>,  ℜ(d) &gt; 0, and either |ℜ(d)| &lt; ℑ(d) or ℜ(d) = ℑ(d) &gt; 0; i.e. the
numerator and denominator of another ‘normalised’ form of c.</p>
<p class="last">This is an inverse (up to equivalence) of rational as defined on integral
complex pairs (see <a class="reference internal" href="#constructors">Constructors</a>).</p>
</td>
</tr>
</tbody>
</table>
<a name="num_den (complex)"><table class="docutils field-list" frame="void" id="num-den-complex" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">num_den c:</th><td class="field-body"><p class="first">synonymous with num_den_gauss.</p>
<p class="last">This is an inverse (up to equivalence) of rational as defined on integer pairs
(see <a class="reference internal" href="#constructors">Constructors</a>).</p>
</td>
</tr>
</tbody>
</table>
<a name="num (complex)"><table class="docutils field-list" frame="void" id="num-complex" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">num c:</th><td class="field-body">given a <tt class="docutils literal"><span class="pre">complex</span></tt> <tt class="docutils literal"><span class="pre">rational</span></tt> or <tt class="docutils literal"><span class="pre">integer</span></tt> c, returns just the numerator
of the normalised form of c given by num_den c.</td>
</tr>
</tbody>
</table>
<a name="den (complex)"><table class="docutils field-list" frame="void" id="den-complex" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">den c:</th><td class="field-body">given a <tt class="docutils literal"><span class="pre">complex</span></tt> <tt class="docutils literal"><span class="pre">rational</span></tt> or <tt class="docutils literal"><span class="pre">integer</span></tt> c, returns just the
denominator of the normalised form of c given by num_den c.</td>
</tr>
</tbody>
</table>
<p><strong>Example 61</strong> <tt class="docutils literal"><span class="pre">rational</span></tt> complex number deconstruction:</p>
<pre class="literal-block">
&gt; let cq = (1+2*i)%(3+3*i);
cq;
1%2+:1%6
&gt; (re cq, im cq);
(1%2,1%6)
&gt; (num . re) cq;
1
&gt; (den . re) cq;
2
&gt; (num . im) cq;
1
&gt; (den . im) cq;
6
&gt; let (n_nat,d_nat) = num_den_nat cq;
&gt; (n_nat, d_nat);
(3+:1,6+:0)
&gt; n_nat % d_nat;
1%2+:1%6
&gt; abs d_nat;
6.0
&gt; let (n, d) = num_den_gauss cq;
(n, d);
(1+:2,3+:3)
&gt; let (n,d) = num_den cq;
(n, d);
(1+:2,3+:3)
&gt; n % d
1%2+:1%6
&gt; abs d
4.24264068711928
&gt; (re . num) cq;
1
&gt; (im . num) cq;
2
&gt; (re . den) cq; //always &gt; 0
3
&gt; (im . den) cq; //always &lt;= (re.den)
3
&gt;
</pre>
</div>
<div class="section" id="rational-complex-type-and-value-tests">
<h2><a class="toc-backref" href="#id85">14.2&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">rational</span></tt> <tt class="docutils literal"><span class="pre">complex</span></tt> Type and Value Tests</a></h2>
<p>Beware that <tt class="docutils literal"><span class="pre">intcompvalp</span></tt> and <tt class="docutils literal"><span class="pre">ratcompvapl</span></tt> may return 1 even if the value
is of <tt class="docutils literal"><span class="pre">complex</span></tt> type with <tt class="docutils literal"><span class="pre">double</span></tt> parts. However, these functions may be
combined with <tt class="docutils literal"><span class="pre">exactp</span></tt>.</p>
<a name="complexp"><table class="docutils field-list" frame="void" id="complexp" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">complexp x:</th><td class="field-body">standard function; returns whether x is of <tt class="docutils literal"><span class="pre">complex</span></tt> type.</td>
</tr>
</tbody>
</table>
<a name="compvalp"><table class="docutils field-list" frame="void" id="compvalp" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">compvalp x:</th><td class="field-body">standard function; returns whether x has a <tt class="docutils literal"><span class="pre">complex</span></tt> value (∈ <strong>C</strong> =
<strong>R</strong>[i]).</td>
</tr>
</tbody>
</table>
<a name="ratcompvalp"><table class="docutils field-list" frame="void" id="ratcompvalp" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">ratcompvalp x:</th><td class="field-body">returns whether x has a rational complex value (∈ <strong>Q</strong>[i]).</td>
</tr>
</tbody>
</table>
<a name="intcompvalp"><table class="docutils field-list" frame="void" id="intcompvalp" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">intcompvalp x:</th><td class="field-body">returns whether x has an integral complex value (∈ <strong>Z</strong>[i]), i.e. a
Gaussian  integer value.</td>
</tr>
</tbody>
</table>
<p><strong>Example 62</strong> <tt class="docutils literal"><span class="pre">rational</span></tt> complex number value tests:</p>
<pre class="literal-block">
&gt; let l = [9, 9%1, 9%2, 4.5, sqrt 2, 1+:1, 1%2+:1, 0.5+:1, inf, nan];
&gt; map exactp l;
[1,1,1,0,0,1,1,0,0,0]
&gt; map inexactp l;
[0,0,0,1,1,0,0,1,1,1]
&gt; map complexp l;
[0,0,0,0,0,1,1,1,0,0]
&gt; map compvalp l;
[1,1,1,1,1,1,1,1,1,1]
&gt; map (\x -&gt; (exactp x and compvalp x)) l; // &quot;has exact complex value&quot;
[1,1,1,0,0,1,1,0,0,0]
&gt; map ratcompvalp l;
[1,1,1,1,1,1,1,1,0,0]
&gt; map (\x -&gt; (exactp x and ratcompvalp x)) l;
[1,1,1,0,0,1,1,0,0,0]
&gt; map intcompvalp l;
[1,1,0,0,0,1,0,0,0,0]
&gt; map (\x -&gt; (exactp x and intcompvalp x)) l;
[1,1,0,0,0,1,0,0,0,0]
&gt; map ratvalp l;
[1,1,1,1,1,0,0,0,0,0]
&gt; map (\x -&gt; (exactp x and ratvalp x)) l;
[1,1,1,0,0,0,0,0,0,0]
&gt; map intvalp l; // for comparison
[1,1,0,0,0,0,0,0,0,0]
&gt; map (\x -&gt; (exactp x and intvalp x)) l;
[1,1,0,0,0,0,0,0,0,0]
&gt;

See `Type and Value Tests`_ for some details of rational type and value tests.
</pre>
</div>
<div class="section" id="rational-complex-arithmetic-operators-and-relations">
<h2><a class="toc-backref" href="#id86">14.3&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">rational</span></tt> <tt class="docutils literal"><span class="pre">complex</span></tt> Arithmetic Operators and Relations</a></h2>
<a name="+ (complex)"><a name="- (complex)"><a name="* (complex)"><a name="/ (complex)"><a name="% (complex)"><a name="== (complex)"><a name="~= (complex)"><p id="id29">The standard arithmetic operators (+), (−), (*), (/), (%), (), (==) and (~=) are
overloaded to have at least one complex and/or rational operand, but (&lt;), (&lt;=),
(&gt;), (&gt;=) are not, as complex numbers are unordered.</p>
<p><strong>Example 63</strong> <tt class="docutils literal"><span class="pre">rational</span></tt> complex arithmetic:</p>
<pre class="literal-block">
&gt; let w = 1%2 +: 3%4;
&gt; let z = 5%6 +: 7%8
&gt; w + z;
4%3+:13%8
&gt; w % z;
618%841+:108%841
&gt; w / z
0.734839476813318+:0.128418549346017
&gt; w ^ 2;
-0.3125+:0.75
&gt; w == z
0
&gt; w == w
1
&gt;
</pre>
</div>
<div class="section" id="rational-complex-maths">
<h2><a class="toc-backref" href="#id87">14.4&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">rational</span></tt> <tt class="docutils literal"><span class="pre">complex</span></tt> Maths</a></h2>
<p>The standard functions <tt class="docutils literal"><span class="pre">re</span></tt> and <tt class="docutils literal"><span class="pre">im</span></tt> work with rational complex numbers (see
<a class="reference internal" href="#rational-complex-constructors-and-deconstructors">Rational Complex Constructors and 'Deconstructors'</a>).</p>
<a name="polar (complex)"><a name="abs (complex)"><a name="arg (complex)"><p id="arg-complex">The standard functions <tt class="docutils literal"><span class="pre">polar</span></tt>, <tt class="docutils literal"><span class="pre">abs</span></tt> and <tt class="docutils literal"><span class="pre">arg</span></tt> work with rational complex
numbers, but the results are inexact.</p>
<p><strong>Example 64</strong> <tt class="docutils literal"><span class="pre">rational</span></tt> complex maths:</p>
<pre class="literal-block">
&gt; polar (1%2) (1%2);
0.438791280945186+:0.239712769302102
&gt; abs (4%2 +: 3%2);
2.5
&gt; arg (-1%1);
3.14159265358979
&gt;
</pre>
<p>There are some additional useful functions for calculating with rational complex
numbers and more general mathematical values.</p>
<a name="norm_gauss"><table class="docutils field-list" frame="void" id="norm-gauss" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">norm_gauss c:</th><td class="field-body">returns the Gaussian norm ||c|| of any <tt class="docutils literal"><span class="pre">complex</span></tt> (or <tt class="docutils literal"><span class="pre">real</span></tt>) number c;
this is the square of the absolute value, and is returned as an (exact)
<tt class="docutils literal"><span class="pre">integer</span></tt>.</td>
</tr>
</tbody>
</table>
<a name="div_mod_gauss"><table class="docutils field-list" frame="void" id="div-mod-gauss" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">div_mod_gauss n d:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">performs Gaussian integer division, returning (q, r) where q is a (not always
unique) quotient, and r is a (not always unique) remainder. q and r are such
that n = q * d + r and ||r|| &lt; ||d|| (equivalently, |r| &lt; |d|).</td>
</tr>
</tbody>
</table>
<a name="n_div_gauss"><table class="docutils field-list" frame="void" id="n-div-gauss" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">n_div_gauss d:</th><td class="field-body">returns just a quotient from Gaussian integer division as produced by
div_mod_gauss n d.</td>
</tr>
</tbody>
</table>
<a name="n_mod_gauss"><table class="docutils field-list" frame="void" id="n-mod-gauss" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">n_mod_gauss d:</th><td class="field-body">returns just a remainder from Gaussian integer division as produced by
div_mod_gauss n d.</td>
</tr>
</tbody>
</table>
<a name="gcd_gauss"><table class="docutils field-list" frame="void" id="gcd-gauss" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">gcd_gauss c1 c2:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">returns a GCD G of the Gaussian integers c1,c2. This is chosen so that s.t.
ℜ(G) &gt; 0, and either |ℑ(G)| &lt; ℜ(G) or ℑ(G) = ℜ(G) &gt; 0;</td>
</tr>
</tbody>
</table>
<a name="euclid_gcd"><table class="docutils field-list" frame="void" id="euclid-gcd" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">euclid_gcd zerofun modfun x y:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">returns a (non-unique) GCD calculated by performing the Euclidean algorithm on
the values x and y (of any type) where zerofun is a predicate for equality to
0, and modfun is a binary modulus (remainder) function.</td>
</tr>
</tbody>
</table>
<a name="euclid_alg"><table class="docutils field-list" frame="void" id="euclid-alg" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">euclid_alg zerofun divfun x y:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">returns (g, a, b) where the g is a (non-unique) GCD and a, b are (arbitrary,
non-unique) values such that a * x + b * y = g calculated by performing the
generalised Euclidean algorithm on the values x and y (of any type) where
zerofun is a predicate for equality to 0, and div is a binary quotient
function.</td>
</tr>
</tbody>
</table>
<p><strong>Example 65</strong> More rational complex and other maths:</p>
<pre class="literal-block">
&gt; norm_gauss (1 +: 3);
10
&gt; abs (1 +: 3);
3.16227766016838
&gt; norm_gauss (-5);
25
&gt; let (q, r) = div_mod_gauss 100 (12 +: 5);
&gt; (q, r);
(7+:(-3),1+:1)
&gt; q * (12 +: 5) + r;
100+:0
&gt; 100 div_gauss (12 +: 5);
7+:(-3)
&gt; 100 mod_gauss (12 +: 5);
1+:1
&gt; div_mod_gauss 23 5;
(5+:0,-2+:0)
&gt; gcd_gauss (1 +: 2) (3 +: 4);
1+:0
&gt; gcd_gauss 25 15;
5+:0
&gt; euclid_gcd (==0) (mod_gauss) (1+: 2) (3 +: 4);
1+:0
&gt; euclid_gcd (==0) (mod) 25 15;
5
&gt; let (g, a, c) = euclid_alg (==0) (div_gauss) (1 +: 2) (3 +: 4);
g;
1+:0
&gt;  (a, b);
(-2+:0,1+:0)
&gt; a * (1 +: 2) + B * (3 +: 4);
1+:0
&gt; let (g, a, b) = euclid_alg (==0) (div) 25 15;
g;
5
&gt;  (a, b);
(-1,2)
&gt; a * 25 + b * 15;
5
&gt;
</pre>
</div>
<div class="section" id="rational-complex-type-simplification">
<h2><a class="toc-backref" href="#id88">14.5&nbsp;&nbsp;&nbsp;<tt class="docutils literal"><span class="pre">rational</span></tt> <tt class="docutils literal"><span class="pre">complex</span></tt> Type Simplification</a></h2>
<a name="comp_simplify"><table class="docutils field-list" frame="void" id="comp-simplify" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">comp_simplify c:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">returns q with <tt class="docutils literal"><span class="pre">complex</span></tt> numbers simplified to <tt class="docutils literal"><span class="pre">reals</span></tt>, if possible.</td>
</tr>
</tbody>
</table>
<a name="ratcomp_simplify"><table class="docutils field-list" frame="void" id="ratcomp-simplify" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">ratcomp_simplify c:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">returns q with <tt class="docutils literal"><span class="pre">rationals</span></tt> simplified to <tt class="docutils literal"><span class="pre">integers</span></tt>, and <tt class="docutils literal"><span class="pre">complex</span></tt>
numbers simplified to <tt class="docutils literal"><span class="pre">reals</span></tt>, if possible.</td>
</tr>
</tbody>
</table>
<p><strong>Example 66</strong> <tt class="docutils literal"><span class="pre">rational</span></tt> complex number type simplification:</p>
<pre class="literal-block">
&gt; let l = [9+:1, 9%1+:1, 9%2+:1, 4.5+:1, 9%1+:0, 9%2+:0, 4.5+:0.0];
&gt; l;
[9+:1,9%1+:1,9%2+:1,4.5+:1,9%1+:0,9%2+:0,4.5+:0.0]
&gt; map_comp_simplify l;
[9+:1,9%1+:1,9%2+:1,4.5+:1,9%1,9%2,4.5+:0.0]
&gt; map ratcomp_simplify l;
[9+:1,9+:1,9%2+:1,4.5+:1,9,9%2,4.5+:0.0]

See `Rational Type Simplification`_ for some details of rational type
simplification.
</pre>
</div>
</div>
<div class="section" id="string-formatting-and-evaluation">
<h1><a class="toc-backref" href="#id89">15&nbsp;&nbsp;&nbsp;String Formatting and Evaluation</a></h1>
<div class="section" id="the-naming-of-the-string-conversion-functions">
<h2><a class="toc-backref" href="#id90">15.1&nbsp;&nbsp;&nbsp;The Naming of the String Conversion Functions</a></h2>
<p>There are several families of functions for converting between <tt class="docutils literal"><span class="pre">strings</span></tt> and
<tt class="docutils literal"><span class="pre">rationals</span></tt>.</p>
<p>The functions that convert from <tt class="docutils literal"><span class="pre">rationals</span></tt> to strings have names based on
that of the standard function <tt class="docutils literal"><span class="pre">str</span></tt>. The <tt class="docutils literal"><span class="pre">str_*</span></tt> functions convert to a
formatted string, and depend on a 'format structure' parameter (see
<a class="reference internal" href="#internationalisation-and-format-structures">Internationalisation and Format Structures</a>). The <tt class="docutils literal"><span class="pre">strs_*</span></tt> functions convert
to a tuple of string fragments.</p>
<p>The functions that convert from strings to <tt class="docutils literal"><span class="pre">rationals</span></tt> have names based on
that of the standard function <tt class="docutils literal"><span class="pre">val</span></tt>. The <tt class="docutils literal"><span class="pre">val_*</span></tt> functions convert from a
formatted string, and depend on a format structure parameter. The <tt class="docutils literal"><span class="pre">sval_*</span></tt>
functions convert from a tuple of string fragments.</p>
<p>There are also <tt class="docutils literal"><span class="pre">join_*</span></tt> and <tt class="docutils literal"><span class="pre">split_*</span></tt> functions to join string fragments
into formatted strings, and to split formatted strings into string fragments,
respectively; these depend on a format structure parameter. These functions are
not always invertible, because some of the functions reduce an error term to
just a sign, e.g. <a class="reference internal" href="#str-real-approx-dp">str_real_approx_dp</a> may round a value. Thus sometimes the
<tt class="docutils literal"><span class="pre">join_*</span></tt> and <tt class="docutils literal"><span class="pre">split_*</span></tt> pairs, and the <tt class="docutils literal"><span class="pre">str_*</span></tt> and <tt class="docutils literal"><span class="pre">val_*</span></tt> pairs are not
quite mutual inverses.</p>
<a name="fmt"></div>
<div class="section" id="internationalisation-and-format-structures">
<span id="fmt"></span><h2><a class="toc-backref" href="#id91">15.2&nbsp;&nbsp;&nbsp;Internationalisation and Format Structures</a></h2>
<p>Many of the string formatting functions in the following sections are
parameterised by a 'format structure'. Throughout this document, the formal
parameter for the format structure will be <a class="reference internal" href="#fmt">fmt</a>. This is simply a map from
some string 'codes' to functions as follows. The functions are mostly from
strings to a string, or from a string to a tuple of strings.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">&quot;sm&quot;:</th><td class="field-body">a function mapping a sign and an unsigned mantissa (or integer) strings to a
signed mantissa (or integer) string.</td>
</tr>
<tr class="field"><th class="field-name">&quot;se&quot;:</th><td class="field-body">a function mapping a sign and an unsigned exponent string to a signed exponent
string.</td>
</tr>
<tr class="field"><th class="field-name">&quot;-s&quot;:</th><td class="field-body">a function mapping a signed number string to a pair containing a sign and the
unsigned number string.</td>
</tr>
<tr class="field"><th class="field-name">&quot;gi&quot;:</th><td class="field-body">a function mapping an integer representing the group size and an integer
string to a grouped integer string.</td>
</tr>
<tr class="field"><th class="field-name">&quot;gf&quot;:</th><td class="field-body">a function mapping an integer representing the group size and a fraction-part
string to a grouped fraction-part string.</td>
</tr>
<tr class="field"><th class="field-name">&quot;-g&quot;:</th><td class="field-body">a function mapping a grouped number string to an ungrouped number string.</td>
</tr>
<tr class="field"><th class="field-name">&quot;zi&quot;:</th><td class="field-body">a function mapping an integer number string to a number string. The input
string representing zero integer part is &quot;&quot;, which should be mapped to the
desired representation of zero. All other number strings should be returned
unaltered.</td>
</tr>
<tr class="field"><th class="field-name">&quot;zf&quot;:</th><td class="field-body">a function mapping a fraction-part number string to a number string. The input
string representing zero fraction part is &quot;&quot;, which should be mapped to the
desired representation of zero. All other number strings should be returned
unaltered.</td>
</tr>
<tr class="field"><th class="field-name">&quot;ir&quot;:</th><td class="field-body">a function mapping initial and recurring parts of a fraction part to the
desired format.</td>
</tr>
<tr class="field"><th class="field-name">&quot;-ir&quot;:</th><td class="field-body">a function mapping a formatted fraction part to the component initial and
recurring parts.</td>
</tr>
<tr class="field"><th class="field-name">&quot;if&quot;:</th><td class="field-body">a function mapping an integer string and fraction part string to the
radix-point formatted string.</td>
</tr>
<tr class="field"><th class="field-name">&quot;-if&quot;:</th><td class="field-body">a function mapping a radix-point formatted string to the component integer
fraction part strings</td>
</tr>
<tr class="field"><th class="field-name">&quot;me&quot;:</th><td class="field-body">a function mapping a mantissa string and exponent string to the formatted
exponential string.</td>
</tr>
<tr class="field"><th class="field-name">&quot;-me&quot;:</th><td class="field-body">a function mapping a formatted exponential string to the component mantissa
and exponent strings.</td>
</tr>
<tr class="field"><th class="field-name">&quot;e&quot;:</th><td class="field-body">a function mapping an ‘error’ number (not string) and a number string to a
formatted number string indicating the sign of the error.</td>
</tr>
<tr class="field"><th class="field-name">&quot;-e&quot;:</th><td class="field-body">a function mapping a formatted number string indicating the sign of the error
to the component ‘error’ string (not number) and number strings.</td>
</tr>
</tbody>
</table>
<p>Depending upon the format structure, some parameters of some of the functions
taking a format structure may have no effect. For example, an <tt class="docutils literal"><span class="pre">intGroup</span></tt>
parameter specifying the size of the integer digit groups will have no effect if
the integer group separator is the empty string.</p>
<a name="create_format"><table class="docutils field-list" frame="void" id="create-format" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">create_format options:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">is a function that provides an easy way to prepare a 'format structure' from
the simpler ‘options structure’. The options structure is another dictionary,
but from more descriptive strings to a string or tuple of strings.</td>
</tr>
</tbody>
</table>
<p>For example, <tt class="docutils literal"><span class="pre">format_uk</span></tt> is generated from <tt class="docutils literal"><span class="pre">options_uk</span></tt> as follows:</p>
<pre class="literal-block">
public options_uk;
const options_uk =
  dict [
    (&quot;sign&quot;, (&quot;-&quot;,&quot;&quot;,&quot;&quot;)),             //alternative: (&quot;-&quot;,&quot; &quot;,&quot;+&quot;)
    (&quot;exponent sign&quot;, (&quot;-&quot;,&quot;&quot;,&quot;&quot;)),    //alternative: (&quot;-&quot;,&quot;&quot;,&quot;+&quot;)
    (&quot;group separator&quot;, &quot;,&quot;),          //might be &quot; &quot; or &quot;.&quot; or &quot;’&quot; elsewhere
    (&quot;zero&quot;, &quot;0&quot;),
    (&quot;radix point&quot;, &quot;.&quot;),              //might be &quot;,&quot; elsewhere
    (&quot;fraction group separator&quot;, &quot;,&quot;),
    (&quot;fraction zero&quot;, &quot;0&quot;),            //alternative: &quot;&quot;
    (&quot;recur brackets&quot;, (&quot;[&quot;,&quot;...]&quot;)),
    (&quot;exponent&quot;, &quot;*10^&quot;),              //(poor) alternative: &quot;e&quot;
    (&quot;error sign&quot;, (&quot;-&quot;,&quot;&quot;,&quot;+&quot;)),
    (&quot;error brackets&quot;, (&quot;(&quot;,&quot;)&quot;)),
  ];

public format_uk;
const format_uk = create_format options_uk;
</pre>
<p>The exponent string need not depend on the radix, as the numerals for the
number radix in that radix are always &quot;10&quot;.</p>
<p>Beware of using &quot;e&quot; or &quot;E&quot; as an exponent string as these have the potential of
being treated as digits in, e.g., hexadecimal.</p>
<p>Format structures do not have to be generated via create format; they may also
be constructed directly.</p>
</div>
<div class="section" id="digit-grouping">
<h2><a class="toc-backref" href="#id92">15.3&nbsp;&nbsp;&nbsp;Digit Grouping</a></h2>
<p>Some functions take <tt class="docutils literal"><span class="pre">group</span></tt> parameters. A value of 0 means &quot;don’t group&quot;.</p>
</div>
<div class="section" id="radices">
<h2><a class="toc-backref" href="#id93">15.4&nbsp;&nbsp;&nbsp;Radices</a></h2>
<p>The functions that produce a decimal expansion take a Radix argument. The
fraction parts are expanded in that radix (or ‘base’), in addition to the
integer parts. The parameter Radix is not restricted to the usual {2, 8, 10,
16}, but may be any <tt class="docutils literal"><span class="pre">integer</span></tt> from 2 to 36; the numerals (‘digits’) are chosen
from [&quot;0&quot;, . . . , &quot;9&quot;, &quot;A&quot;, . . . , &quot;Z&quot;]. The letter-digits are always upper
case.</p>
<p>The functions do not attach a prefix (such as &quot;0x&quot; for hexadecimal) to the
resulting string.</p>
</div>
<div class="section" id="error-terms">
<h2><a class="toc-backref" href="#id94">15.5&nbsp;&nbsp;&nbsp;Error Terms</a></h2>
<p>Some functions return a value including an 'error' term (in a tuple) or sign (at
the end of a string). Such an error is represents what the next digit would be
as a fraction of the radix.</p>
<p><strong>Example 67</strong> Error term in the tuple of string 'fragments':</p>
<pre class="literal-block">
&gt; strs_real_approx_sf 10 floor 3 (234567%100000);
(&quot;+&quot;,&quot;2&quot;,&quot;34&quot;,567%1000)
&gt; strs_real_approx_sf 10 ceil 3 (234567%100000);
(&quot;+&quot;,&quot;2&quot;,&quot;35&quot;,-433%1000)
&gt;
</pre>
<p>(See the function <a class="reference internal" href="#strs-real-approx-sf">strs_real_approx_sf</a>.)</p>
<p>In strings, only the sign of the error term is given. A “+” should be read as
“and a bit more”; “-” as “but a bit less”.</p>
<p><strong>Example 68</strong> Error sign in the string:</p>
<pre class="literal-block">
&gt; str_real_approx_sf format_uk 10 0 0 floor 3 (234567%100000);
&quot;2.34(+)&quot;
&gt; str_real_approx_sf format_uk 10 0 0 ceil 3 (234567%100000);
&quot;2.35(-)&quot;
&gt;
</pre>
<p>(See the function <a class="reference internal" href="#str-real-approx-sf">str_real_approx_sf</a>.)</p>
</div>
</div>
<div class="section" id="q-fraction-string-i-n-d">
<h1><a class="toc-backref" href="#id95">16&nbsp;&nbsp;&nbsp;<strong>Q</strong> ↔ Fraction String (“i + n/d”)</a></h1>
<div class="section" id="formatting-to-fraction-strings">
<h2><a class="toc-backref" href="#id96">16.1&nbsp;&nbsp;&nbsp;Formatting to Fraction Strings</a></h2>
<a name="str_vulgar"><table class="docutils field-list" frame="void" id="str-vulgar" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">str_vulgar q:</th><td class="field-body"><p class="first">returns a String representing the <tt class="docutils literal"><span class="pre">rational</span></tt> (or <tt class="docutils literal"><span class="pre">integer</span></tt>) q in the
form</p>
<ul class="last simple">
<li>“[−]n/d”</li>
</ul>
</td>
</tr>
</tbody>
</table>
<a name="str_vulgar_or_int"><table class="docutils field-list" frame="void" id="str-vulgar-or-int" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">str_vulgar_or_int q:</th></tr>
<tr><td>&nbsp;</td><td class="field-body"><p class="first">returns a String representing the <tt class="docutils literal"><span class="pre">rational</span></tt> (or <tt class="docutils literal"><span class="pre">integer</span></tt>) q in one of
the forms</p>
<ul class="last simple">
<li>“[−]n/d”</li>
<li>“[−]i”</li>
</ul>
</td>
</tr>
</tbody>
</table>
<a name="str_mixed"><table class="docutils field-list" frame="void" id="str-mixed" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">str_mixed q:</th><td class="field-body"><p class="first">returns a String representing the <tt class="docutils literal"><span class="pre">rational</span></tt> (or <tt class="docutils literal"><span class="pre">integer</span></tt>) q in one of
the forms</p>
<ul class="last simple">
<li>“i + n/d”</li>
<li>“−(i + n/d)”</li>
<li>“[−]n/d”</li>
<li>“[−]i”</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><strong>Example 69</strong> The fraction string representations:</p>
<pre class="literal-block">
&gt; let l = while (&lt;= 3%2) (+(1%2)) (-3%2);
&gt; l;
[-3%2,-1%1,-1%2,0%1,1%2,1%1,3%2]
&gt; map str_vulgar l;
[&quot;-3/2&quot;,&quot;-1/1&quot;,&quot;-1/2&quot;,&quot;0/1&quot;,&quot;1/2&quot;,&quot;1/1&quot;,&quot;3/2&quot;]
&gt; map str_vulgar_or_int l;
[&quot;-3/2&quot;,&quot;-1&quot;,&quot;-1/2&quot;,&quot;0&quot;,&quot;1/2&quot;,&quot;1&quot;,&quot;3/2&quot;]
&gt; map str_mixed l;
[&quot;-(1+1/2)&quot;,&quot;-1&quot;,&quot;-1/2&quot;,&quot;0&quot;,&quot;1/2&quot;,&quot;1&quot;,&quot;1+1/2&quot;]
&gt;
</pre>
<p>These might be compared to the behaviour of the standard function <tt class="docutils literal"><span class="pre">str</span></tt>.</p>
<a name="str"><table class="docutils field-list" frame="void" id="str" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">str x:</th><td class="field-body">returns a <tt class="docutils literal"><span class="pre">string</span></tt> representing the value x.</td>
</tr>
</tbody>
</table>
<p><strong>Example 70</strong> The standard function str:</p>
<pre class="literal-block">
&gt; map str l;
[&quot;-3%2&quot;,&quot;-1%1&quot;,&quot;-1%2&quot;,&quot;0%1&quot;,&quot;1%2&quot;,&quot;1%1&quot;,&quot;3%2&quot;]
&gt;
</pre>
</div>
<div class="section" id="evaluation-of-fraction-strings">
<h2><a class="toc-backref" href="#id97">16.2&nbsp;&nbsp;&nbsp;Evaluation of Fraction Strings</a></h2>
<a name="val_vulgar"><table class="docutils field-list" frame="void" id="val-vulgar" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">val_vulgar strg:</th></tr>
<tr><td>&nbsp;</td><td class="field-body"><p class="first">returns a <tt class="docutils literal"><span class="pre">rational</span></tt> q represented by the string strg in the form</p>
<ul class="last simple">
<li>“[−]n/d”</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Such strings can also be evaluated by the <tt class="docutils literal"><span class="pre">val_mixed</span></tt> function.</p>
<a name="val_mixed"><table class="docutils field-list" frame="void" id="val-mixed" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">val_mixed strg:</th><td class="field-body"><p class="first">returns a <tt class="docutils literal"><span class="pre">rational</span></tt> q represented by the <tt class="docutils literal"><span class="pre">string</span></tt> strg</p>
<ul class="last simple">
<li>“i + n/d”</li>
<li>“−(i + n/d)”</li>
<li>“[−]n/d” — thus val_mixed strictly extends val_vulgar</li>
<li>“[−]i”</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><strong>Example 71</strong> Evaluating fraction strings:</p>
<pre class="literal-block">
&gt; val_vulgar &quot;-22/7&quot;;
-22%7
&gt; val_mixed &quot;1+5/6&quot;;
11%6
&gt;
</pre>
<p>These might be compared to the behaviour of the standard function val.</p>
<a name="val"><table class="docutils field-list" frame="void" id="val" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">val s:</th><td class="field-body">evaluates the <tt class="docutils literal"><span class="pre">string</span></tt> s.</td>
</tr>
</tbody>
</table>
<p><strong>Example 72</strong> The standard function val:</p>
<pre class="literal-block">
&gt; val &quot;1+5%6&quot;;
11%6
&gt; val &quot;1+5/6&quot;;
1.83333333333333
&gt;
</pre>
</div>
</div>
<div class="section" id="q-recurring-numeral-expansion-string-i-fr">
<h1><a class="toc-backref" href="#id98">17&nbsp;&nbsp;&nbsp;<strong>Q</strong> ↔ Recurring Numeral Expansion String (“I.FR”)</a></h1>
<p>See <a class="reference internal" href="#internationalisation-and-format-structures">Internationalisation and Format Structures</a> for information about the
formatting structure to be supplied in the <a class="reference internal" href="#fmt">fmt</a> parameter.</p>
<div class="section" id="formatting-to-recurring-expansion-strings">
<h2><a class="toc-backref" href="#id99">17.1&nbsp;&nbsp;&nbsp;Formatting to Recurring Expansion Strings</a></h2>
<a name="str_real_recur"><table class="docutils field-list" frame="void" id="str-real-recur" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">str_real_recur fmt radix intGroup q:</th></tr>
<tr><td>&nbsp;</td><td class="field-body"><p class="first">returns a <tt class="docutils literal"><span class="pre">string</span></tt> (exactly) representing the <tt class="docutils literal"><span class="pre">rational</span></tt> (or <tt class="docutils literal"><span class="pre">integer</span></tt>)
q as base-Radix expansion of one the forms</p>
<ul class="last simple">
<li>“[−]int.frac”</li>
<li>“[−]int.init frac part[smallest recurring frac part. . . ]”</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Note that there is no fracGroup parameter.</p>
<p>Beware that the string returned by this function can be very long. The length of
the recurring part of such a decimal expansion may be up to one less than the
simplest denominator of q.</p>
<p><strong>Example 73</strong> The recurring radix expansion-type string representations:</p>
<pre class="literal-block">
&gt; str_real_recur format_uk 10 3 (4000001%4); // grouped with commas
&quot;1,000,000.25&quot;
&gt; str_real_recur format_uk 10 0 (4000001%4); // no grouping
&quot;1000000.25&quot;
&gt; str_real_recur format_uk 10 3 (1000000%3);
&quot;333,333.[3...]&quot;
&gt; str_real_recur format_uk 10 3 (1000000%7);
&quot;142,857.[142857...]&quot;
&gt; str_real_recur format_uk 10 3 (-1%700);
&quot;-0.00[142857...]&quot;
&gt; str_real_recur format_uk 10 3 (127%128);
&quot;0.9921875&quot;
&gt; str_real_recur format_uk 2 4 (-127%128);
&quot;-0.1111111&quot;
&gt; str_real_recur format_uk 16 4 (127%128);
&quot;0.FE&quot;
&gt; str_real_recur format_uk 10 0 (70057%350) // 1%7 + 10001%50;
&quot;200.16[285714...]&quot;
&gt;
</pre>
<p>The function allows expansion to different radices (bases).</p>
<p><strong>Example 74</strong> The recurring radix expansion in decimal and hexadecimal:</p>
<pre class="literal-block">
&gt; str_real_recur format_uk 10 0 (1%100);
&quot;0.01&quot;
&gt; str_real_recur format_uk 16 0 (1%100);
&quot;0.0[28F5C...]&quot;
&gt;
</pre>
<p><strong>Example 75</strong> The recurring radix expansion in duodecimal:</p>
<pre class="literal-block">
&gt; str_real_recur format_uk 12 0 (1%100);
&quot;0.0[15343A0B62A68781B059...]&quot;
&gt;
</pre>
<p>Note that this bracket notation is not standard in the literature. Usually the
recurring numerals are indicated by a single dot over the initial and final
numerals of the recurring part, or an overline over the recurring part. For
example 1/70 = 0.0˙14285˙7 = 0.0142857 and 1/3 = 0.˙3 = 0.3.</p>
<a name="strs_real_recur"><table class="docutils field-list" frame="void" id="strs-real-recur" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">strs_real_recur radix q:</th></tr>
<tr><td>&nbsp;</td><td class="field-body"><p class="first">returns a quadruple of the four strings:</p>
<ul class="last simple">
<li>the sign,</li>
<li>integer part (which is empty for 0),</li>
<li>initial fraction part</li>
<li>and recurring fraction part (either and both of which may be empty).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><strong>Example 76</strong> The recurring radix expansion in decimal — the fragments:</p>
<pre class="literal-block">
&gt; strs_real_recur 10 (100%7);
(&quot;+&quot;,&quot;14&quot;,&quot;&quot;,&quot;285714&quot;)
&gt; strs_real_recur 10 (-1%700);
(&quot;-&quot;,&quot;&quot;,&quot;00&quot;,&quot;142857&quot;)
&gt; strs_real_recur 10 (70057%350);
(&quot;+&quot;,&quot;200&quot;,&quot;16&quot;,&quot;285714&quot;)
&gt;
</pre>
<p>This function may be used to also, e.g. format the integer part with
comma-separated groupings.</p>
<a name="join_str_real_recur"><dl class="docutils" id="join-str-real-recur">
<dt>:join_str_real_recur fmt intGroup sign i fracInit fracRecur&quot;</dt>
<dd>formats the parts in the quadruple returned by <a class="reference internal" href="#strs-real-recur">strs_real_recur</a> to the sort
of string as returned by <a class="reference internal" href="#str-real-recur">str_real_recur</a>.</dd>
</dl>
</div>
<div class="section" id="evaluation-of-recurring-expansion-strings">
<h2><a class="toc-backref" href="#id100">17.2&nbsp;&nbsp;&nbsp;Evaluation of Recurring Expansion Strings</a></h2>
<p>The <tt class="docutils literal"><span class="pre">str_*</span></tt> and <tt class="docutils literal"><span class="pre">val_*</span></tt> functions depend on a 'format structure' parameter
(fmt) such as format uk. Conversions may be performed between <tt class="docutils literal"><span class="pre">rationals</span></tt> and
differently formatted strings if a suitable alternative format structure is
supplied. See <a class="reference internal" href="#internationalisation-and-format-structures">Internationalisation and Format Structures</a> for information
about formatting structures.</p>
<a name="val_real_recur"><table class="docutils field-list" frame="void" id="val-real-recur" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">val_real_recur fmt radix strg:</th></tr>
<tr><td>&nbsp;</td><td class="field-body"><p class="first">returns the <tt class="docutils literal"><span class="pre">rational</span></tt> q represented by the base-radix expansion <tt class="docutils literal"><span class="pre">string</span></tt>
strg of one the forms</p>
<ul class="last simple">
<li>“[−]int.frac”</li>
<li>“[−]int.init frac part[recurring frac part. . . ]”</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><strong>Example 77</strong> Conversion from the recurring radix expansion-type string
representations:</p>
<pre class="literal-block">
&gt; val_real_recur format_uk 10 &quot;-12.345&quot;;
-2469%200
&gt; val_real_recur format_uk 10 &quot;0.3&quot;;
3%10
&gt; val_real_recur format_uk 10 &quot;0.[3...]&quot;;
1%3
&gt; val_real_recur format_uk 10 &quot;.333[33...]&quot;;
1%3
&gt; val_real_recur format_uk 10 &quot;.[9...]&quot;;
1%1
</pre>
<a name="sval_real_recur"><table class="docutils field-list" frame="void" id="sval-real-recur" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">sval_real_recur radix sign iStr fracStr recurPartStr:</th></tr>
<tr><td>&nbsp;</td><td class="field-body"><p class="first">returns the <tt class="docutils literal"><span class="pre">rational</span></tt> q represented by the parts</p>
<ul class="last simple">
<li>sign</li>
<li>integer part</li>
<li>initial fraction part</li>
<li>recurring fraction part</li>
</ul>
</td>
</tr>
</tbody>
</table>
<a name="split_str_real_recur"><table class="docutils field-list" frame="void" id="split-str-real-recur" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">split_str_real_recur Fmt strg:</th></tr>
<tr><td>&nbsp;</td><td class="field-body"><p class="first">returns a tuple containing the parts</p>
<ul class="last simple">
<li>sign</li>
<li>integer part</li>
<li>initial fraction part</li>
<li>recurring fraction part
of one the forms
- “[−]int.frac”
- “[−]int.init frac part[recurring frac part. . . ]”</li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="q-numeral-expansion-string-i-f-10e">
<h1><a class="toc-backref" href="#id101">18&nbsp;&nbsp;&nbsp;<strong>Q</strong> ↔ Numeral Expansion String (“I.F × 10E”)</a></h1>
<p>See <a class="reference internal" href="#internationalisation-and-format-structures">Internationalisation and Format Structures</a> for information about the
formatting structure to be supplied in the <a class="reference internal" href="#fmt">fmt</a> parameter.</p>
<p>The exponent string &quot;*10^&quot; need not depend on the radix, as the numerals for
the number radix in that radix are always &quot;10&quot;.</p>
<div class="section" id="formatting-to-expansion-strings">
<h2><a class="toc-backref" href="#id102">18.1&nbsp;&nbsp;&nbsp;Formatting to Expansion Strings</a></h2>
<div class="section" id="functions-for-fixed-decimal-places">
<h3><a class="toc-backref" href="#id103">18.1.1&nbsp;&nbsp;&nbsp;Functions for Fixed Decimal Places</a></h3>
<a name="str_real_approx_dp"><table class="docutils field-list" frame="void" id="str-real-approx-dp" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">str_real_approx_dp fmt radix intGroup fracGroup roundfun dp q:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">returns a string representing a numeral expansion approximation of q to dp
decimal places, using rounding mode <a class="reference internal" href="#roundfun">roundfun</a> (see <a class="reference internal" href="#rounding-to-integer">Rounding to Integer</a>)
<a class="reference internal" href="#roundfun">roundfun</a> is usually <a class="reference internal" href="#round">round</a> or <a class="reference internal" href="#round-unbiased">round_unbiased</a>. (dp may be positive,
zero or negative; non-positive dps may look misleading — use e.g. scientific
notation instead.)</td>
</tr>
</tbody>
</table>
<p><strong>Example 78</strong> Decimal places:</p>
<pre class="literal-block">
&gt; str_real_approx_dp format_uk 10 3 3 round 2 (22%7);
&quot;3.14(+)&quot;
&gt; str_real_approx_dp format_uk 10 3 3 ceil 2 (22%7);
&quot;3.15(-)&quot;
&gt;
</pre>
<a name="strs_real_approx_dp"><table class="docutils field-list" frame="void" id="strs-real-approx-dp" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">strs_real_approx_dp radix roundfun do q:</th></tr>
<tr><td>&nbsp;</td><td class="field-body"><p class="first">returns a tuple of strings</p>
<ul class="simple">
<li>sign</li>
<li>integer part</li>
<li>fraction part</li>
</ul>
<p>representing an expansion to a number of decimal places, together with</p>
<ul class="last simple">
<li>the rounding “error”: a fraction representing the next numerals.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><strong>Example 79</strong> Decimal places — the fragments:</p>
<pre class="literal-block">
&gt; strs_real_approx_dp 10 round 2 (22%7);
(&quot;+&quot;,&quot;3&quot;,&quot;14&quot;,2%7)
&gt; strs_real_approx_dp 10 ceil 2 (22%7);
(&quot;+&quot;,&quot;3&quot;,&quot;15&quot;,-5%7)
&gt;
</pre>
<a name="join_str_real_approx"><table class="docutils field-list" frame="void" id="join-str-real-approx" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">join_str_real_approx fmt intGroup fracGroup sign i frac err:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">formats the parts in the quadruple returned by <a class="reference internal" href="#strs-real-approx-dp">strs_real_approx_dp</a> or
<a class="reference internal" href="#strs-real-approx-sf">strs_real_approx_sf</a> to the sort of string as returned by
<a class="reference internal" href="#str-real-approx-dp">str_real_approx_dp</a> or <a class="reference internal" href="#str-real-approx-sf">str_real_approx_sf</a>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="functions-for-significant-figures">
<h3><a class="toc-backref" href="#id104">18.1.2&nbsp;&nbsp;&nbsp;Functions for Significant Figures</a></h3>
<a name="str_real_approx_sf"><table class="docutils field-list" frame="void" id="str-real-approx-sf" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">str_real_approx_sf fmt radix intGroup fracGroup roundfun sf q:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">returns a string representing a numeral expansion approximation of q to sf
significant figures, using rounding mode <a class="reference internal" href="#roundfun">roundfun</a> (see <a class="reference internal" href="#rounding-to-integer">Rounding to
Integer</a>).</td>
</tr>
</tbody>
</table>
<p>Round is usually <a class="reference internal" href="#round">round</a> or <a class="reference internal" href="#round-unbiased">round_unbiased</a>. (sf must be positive.)</p>
<p><strong>Example 80</strong> Significant figures:</p>
<pre class="literal-block">
&gt; str_real_approx_sf format_uk 10 3 3 floor 2 (22%7);
&quot;3.1(+)&quot;
&gt; str_real_approx_sf format_uk 10 3 3 floor 2 ((-22)%7);
&quot;-3.2(+)&quot;
&gt;
</pre>
<a name="strs_real_approx_sf"><table class="docutils field-list" frame="void" id="strs-real-approx-sf" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">strs_real_approx_sf radix roundfun sf q:</th></tr>
<tr><td>&nbsp;</td><td class="field-body"><p class="first">returns a tuple of strings</p>
<ul class="simple">
<li>sign,</li>
<li>integer part,</li>
<li>fraction part, representing an expansion to a number of significant figures,
together with</li>
<li>the rounding “error”: a fraction representing the next numerals</li>
</ul>
</td>
</tr>
<tr class="field"><th class="field-name" colspan="2">join_str_real_approx:</th></tr>
<tr><td>&nbsp;</td><td class="field-body"><p class="first last">see <a class="reference internal" href="#join-str-real-approx">join_str_real_approx</a>.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="functions-for-scientific-notation-and-engineering-notation">
<h3><a class="toc-backref" href="#id105">18.1.3&nbsp;&nbsp;&nbsp;Functions for Scientific Notation and Engineering Notation</a></h3>
<a name="str_real_approx_sci"><table class="docutils field-list" frame="void" id="str-real-approx-sci" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">str_real_approx_sci fmt radix intGroup fracGroup roundfun sf q:</th></tr>
<tr><td>&nbsp;</td><td class="field-body"><p class="first">returns a string expansion with a number of significant figures in scientific
notation, using rounding mode <a class="reference internal" href="#roundfun">roundfun</a> (see <a class="reference internal" href="#rounding-to-integer">Rounding to Integer</a>).</p>
<p class="last">(sf must be positive; expStep is usually 3, radix is usually 10, <a class="reference internal" href="#roundfun">roundfun</a>
is usually <a class="reference internal" href="#round">round</a> or <a class="reference internal" href="#round-unbiased">round_unbiased</a>; <a class="reference internal" href="#str-real-approx-sci">str_real_approx_sci</a> is equivalent
to <a class="reference internal" href="#str-real-approx-eng">str_real_approx_eng</a> (below) with expStep = 1.)</p>
</td>
</tr>
</tbody>
</table>
<a name="strs_real_approx_sci"><table class="docutils field-list" frame="void" id="strs-real-approx-sci" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">strs_real_approx_sci radix roundfun sf q:</th></tr>
<tr><td>&nbsp;</td><td class="field-body"><p class="first">returns a tuple of strings:</p>
<ul class="simple">
<li>sign of mantissa,</li>
<li>integer part of mantissa,</li>
<li>fraction part of mantissa,</li>
<li>sign of exponent,</li>
<li>exponent magnitude</li>
</ul>
<p>representing an expansion to a number of significant figures in scientific
notation together with</p>
<ul class="last simple">
<li>the rounding &quot;error&quot;: a fraction representing the next numerals.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<a name="str_real_approx_eng"><table class="docutils field-list" frame="void" id="str-real-approx-eng" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">str_real_approx_eng fmt expStep radix intGroup fracGroup round sf q:</th></tr>
<tr><td>&nbsp;</td><td class="field-body"><p class="first">returns a string expansion with a number of significant figures in engineering
notation, using rounding mode roundfun.</p>
<p>The ExpStep parameter specifies the granularity of the exponent; specifically,
the exponent will always be divisible by expStep.</p>
<p class="last">(sf must be positive; expStep is usually 3 and must be positive, radix is
usually 10, <a class="reference internal" href="#roundfun">roundfun</a> is usually <a class="reference internal" href="#round">round</a> or <a class="reference internal" href="#round-unbiased">round_unbiased</a>.)</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Example 81</strong> Engineering notation:</p>
<pre class="literal-block">
&gt; str_real_approx_eng format_uk 3 10 3 3 round 7 (rational 999950);
&quot;999.950,0*10^3&quot;
&gt; str_real_approx_eng format_uk 3 10 3 3 round 4 999950;
&quot;1.000*10^6(-)&quot;
&gt;
</pre>
<a name="strs_real_approx_eng"><table class="docutils field-list" frame="void" id="strs-real-approx-eng" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">strs_real_approx_eng expStep radix roundfun sf q:</th></tr>
<tr><td>&nbsp;</td><td class="field-body"><p class="first">returns a tuple of strings:</p>
<ul class="simple">
<li>sign of mantissa,</li>
<li>integer part of mantissa,</li>
<li>fraction part of mantissa,</li>
<li>sign of exponent,</li>
<li>exponent magnitude</li>
</ul>
<p>representing an expansion to a number of significant figures in engineering
notation together with</p>
<ul class="last simple">
<li>the rounding “error”: a fraction representing the next numerals.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><strong>Example 82</strong> Engineering notation — the fragments:</p>
<pre class="literal-block">
&gt; strs_real_approx_eng 3 10 round 7 (rational 999950);
(&quot;+&quot;,&quot;999&quot;,&quot;9500&quot;,&quot;+&quot;,&quot;3&quot;,0%1)
&gt; strs_real_approx_eng 3 10 round 4 999950;
(&quot;+&quot;,&quot;1&quot;,&quot;000&quot;,&quot;+&quot;,&quot;6&quot;,-1%20)
&gt;
</pre>
<a name="join_str_real_eng"><table class="docutils field-list" frame="void" id="join-str-real-eng" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">join_str_real_eng fmt intGroup fracGroup mantSign mantI mantF rac expSign expI err:</th></tr>
<tr><td>&nbsp;</td><td class="field-body">formats the parts in the quadruple returned by <tt class="docutils literal"><span class="pre">strs_real_approx_eng</span></tt> or
strs_real_approx_sci to the sort of string as returned by
<a class="reference internal" href="#str-real-approx-eng">str_real_approx_eng</a> or <cite>str_real_approx_sci</cite>.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="evaluation-of-expansion-strings">
<h2><a class="toc-backref" href="#id106">18.2&nbsp;&nbsp;&nbsp;Evaluation of Expansion Strings</a></h2>
<p>The <tt class="docutils literal"><span class="pre">str_*</span></tt> and <tt class="docutils literal"><span class="pre">val_*</span></tt> functions depend on a 'format structure' parameter
(fmt) such as format uk. Conversions may be performed between <tt class="docutils literal"><span class="pre">rationals</span></tt> and
differently formatted strings if a suitable alternative format structure is
supplied. See <a class="reference internal" href="#internationalisation-and-format-structures">Internationalisation and Format Structures</a> for information
about formatting structures.</p>
<a name="val_real_eng"><table class="docutils field-list" frame="void" id="val-real-eng" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">val_real_eng fmt radix strg:</th></tr>
<tr><td>&nbsp;</td><td class="field-body"><p class="first">returns the <tt class="docutils literal"><span class="pre">rational</span></tt> q represented by the base-radix expansion <tt class="docutils literal"><span class="pre">string</span></tt>
strg of one the forms</p>
<ul class="last simple">
<li>“[−]int.frac”</li>
<li>“[−]int.frace[−]exponent”</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><strong>Example 83</strong> Conversion from the recurring radix expansion-type string
representations:</p>
<pre class="literal-block">
&gt; val_real_eng format_uk 10 &quot;-12.345&quot;;
-2469%200
&gt; val_real_eng format_uk 10 &quot;-12.345*10^2&quot;;
-2469%2
&gt;
</pre>
<a name="sval_real_eng"><table class="docutils field-list" frame="void" id="sval-real-eng" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">sval_real_eng radix signStr mantIStr mantF racStr expSignStr expStr:</th></tr>
<tr><td>&nbsp;</td><td class="field-body"><p class="first">returns the <tt class="docutils literal"><span class="pre">rational</span></tt> q represented by the parts</p>
<ul class="last simple">
<li>sign</li>
<li>integer part of mantissa</li>
<li>fraction part of mantissa</li>
<li>sign of exponent</li>
<li>exponent</li>
</ul>
</td>
</tr>
</tbody>
</table>
<a name="split_str_real_eng"><p id="split-str-real-eng">:split_str_real_eng fmt strg — returns a tuple containing the string parts</p>
<blockquote>
<ul class="simple">
<li>sign</li>
<li>integer part of mantissa</li>
<li>fraction part of mantissa</li>
<li>sign of exponent</li>
<li>exponent</li>
<li>the “error” sign</li>
</ul>
<p>of one the forms</p>
<ul class="simple">
<li>“[−]int.frac”</li>
<li>“[−]int.frac ×10^[−]exponent”</li>
</ul>
</blockquote>
<p>These functions can deal with the fixed decimal places, the significant figures
and the scientific notation in addition to the engineering notation.</p>
</div>
</div>
<div class="section" id="numeral-string-q-approximation">
<h1><a class="toc-backref" href="#id107">19&nbsp;&nbsp;&nbsp;Numeral String → <strong>Q</strong> — Approximation</a></h1>
<p>This section describes functions to approximate by a <tt class="docutils literal"><span class="pre">rational</span></tt> a real number
represented by a string. See <a class="reference internal" href="#r-q-approximation">R → Q — Approximation</a> for approximation
by a <tt class="docutils literal"><span class="pre">rational</span></tt> of a <tt class="docutils literal"><span class="pre">double</span></tt>.</p>
<p>The <tt class="docutils literal"><span class="pre">str_*</span></tt> and <tt class="docutils literal"><span class="pre">val_*</span></tt> functions depend on a 'format structure' parameter
(fmt) such as format uk. Conversions may be performed between <tt class="docutils literal"><span class="pre">rationals</span></tt> and
differently formatted strings if a format structure is supplied. See
<a class="reference internal" href="#internationalisation-and-format-structures">Internationalisation and Format Structures</a> for information about formatting
structures.</p>
<a name="val_eng_approx_epsilon"><dl class="docutils" id="val-eng-approx-epsilon">
<dt>:val_eng_approx_epsilon fmt radix epsilon strg</dt>
<dd><p class="first">Find the least complex <tt class="docutils literal"><span class="pre">rational</span></tt> approximation q to the number represented
by the base-radix expansion <tt class="docutils literal"><span class="pre">string</span></tt> str in one of the forms</p>
<ul class="simple">
<li>“[−]int.frac”</li>
<li>“[−]int.frac ×10^[−]exponent”</li>
</ul>
<p class="last">that is &quot;-close. That is find a q such that |q − val str| ≤ ε.</p>
</dd>
</dl>
<p><strong>Example 84</strong> <tt class="docutils literal"><span class="pre">rational</span></tt> from a long string:</p>
<pre class="literal-block">
&gt; let strg = &quot;123.456,789,876,543,212,345,678,987,654,321*10^27&quot;;
&gt; let x = val_real_eng format_uk 10 str;
&gt; x;
123456789876543212345678987654321%1000
&gt; let q = val_eng_approx_epsilon format_uk 10 (1%100) strg;
&gt; q;
1975308638024691397530863802469%16
&gt; double (x - q);
0.0085
&gt; str_real_approx_eng format_uk 3 10 3 3 round 30 q;
&quot;123.456,789,876,543,212,345,678,987,654*10^27(+)&quot;
&gt; str_real_approx_eng format_uk 3 10 3 3 round 42 q;
&quot;123.456,789,876,543,212,345,678,987,654,312,500,000,000*10^27&quot;
&gt; double q;
1.23456789876543e+029
&gt;
</pre>
<a name="val_eng_interval_epsilon"><table class="docutils field-list" frame="void" id="val-eng-interval-epsilon" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">val_eng_interval_epsilon fmt radix epsilon strg:</th></tr>
<tr><td>&nbsp;</td><td class="field-body"><p class="first">Find the least complex <tt class="docutils literal"><span class="pre">rational</span></tt> interval containing the number represented
by the base-radix expansion <tt class="docutils literal"><span class="pre">string</span></tt> strg in one of the forms</p>
<ul class="simple">
<li>“[−]int.frac”</li>
<li>“[−]int.frac ×10^[−]exponent”</li>
</ul>
<p class="last">that is &quot;-small.</p>
</td>
</tr>
</tbody>
</table>
<a name="val_eng_approx_max_den"><table class="docutils field-list" frame="void" id="val-eng-approx-max-den" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">val_eng_approx_max_den fmt radix maxDen strg:</th></tr>
<tr><td>&nbsp;</td><td class="field-body"><p class="first">Find the closest <tt class="docutils literal"><span class="pre">rational</span></tt> approximation to the number represented by the
base-rRadix expansion <tt class="docutils literal"><span class="pre">string</span></tt> strg in one of the forms</p>
<ul class="simple">
<li>“[−]int.frac”</li>
<li>“[−]int.frac ×10^[−]exponent”</li>
</ul>
<p class="last">that has a denominator no greater than maxDen. (maxDen &gt; 0)</p>
</td>
</tr>
</tbody>
</table>
<a name="val_eng_interval_max_den"><table class="docutils field-list" frame="void" id="val-eng-interval-max-den" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">val_eng_interval_max_den fmt radix maxDen strg:</th></tr>
<tr><td>&nbsp;</td><td class="field-body"><p class="first">Find the smallest <tt class="docutils literal"><span class="pre">rational</span></tt> interval containing the number represented by
the base-radix expansion <tt class="docutils literal"><span class="pre">string</span></tt> strg in one of the forms</p>
<ul class="simple">
<li>“[−]int.frac”</li>
<li>“[−]int.frac ×10^[−]exponent”</li>
</ul>
<p class="last">that has endpoints with denominators no greater than maxDen. (maxDen &gt; 0)</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Example 85</strong> Other <tt class="docutils literal"><span class="pre">rationals</span></tt> from a long string:</p>
<pre class="literal-block">
&gt; val_eng_approx_epsilon format_uk 10 (1%100) strg;
1975308638024691397530863802469%16
&gt; val_eng_interval_epsilon format_uk 10 (1%100) strg;
interval::Ivl 3086419746913580308641974691358%25 3456790116543209945679011654321%28
&gt; val_eng_approx_max_den format_uk 10 100 strg;
9999999980000000199999998000000%81
&gt; val_eng_interval_max_den format_uk 10 100 strg;
interval::Ivl 9999999980000000199999998000000%81 3456790116543209945679011654321%28
&gt;
</pre>
</div>
<div class="section" id="index">
<h1><a class="toc-backref" href="#id108">20&nbsp;&nbsp;&nbsp;Index</a></h1>
<div class="line-block">
<div class="line"><a class="reference internal" href="#id1">+</a></div>
<div class="line"><a class="reference internal" href="#complex">+ (complex)</a></div>
<div class="line"><a class="reference internal" href="#id13">+ (intervals)</a></div>
<div class="line"><a class="reference internal" href="#id23">+:</a></div>
<div class="line"><a class="reference internal" href="#id2">-</a></div>
<div class="line"><a class="reference internal" href="#id24">- (complex)</a></div>
<div class="line"><a class="reference internal" href="#id14">- (intervals)</a></div>
<div class="line"><a class="reference internal" href="#id3">*</a></div>
<div class="line"><a class="reference internal" href="#id25">* (complex)</a></div>
<div class="line"><a class="reference internal" href="#id15">* (intervals)</a></div>
<div class="line"><a class="reference internal" href="#id4">/</a></div>
<div class="line"><a class="reference internal" href="#id26">/ (complex)</a></div>
<div class="line"><a class="reference internal" href="#id16">/ (intervals)</a></div>
<div class="line"><a class="reference internal" href="#id6">%</a></div>
<div class="line"><a class="reference internal" href="#id27">% (complex)</a></div>
<div class="line"><a class="reference internal" href="#id17">% (intervals)</a></div>
<div class="line"><a class="reference internal" href="#id5">^</a></div>
<div class="line"><a class="reference internal" href="#id7">==</a></div>
<div class="line"><a class="reference internal" href="#id28">== (complex)</a></div>
<div class="line"><a class="reference internal" href="#id18">== (intervals)</a></div>
<div class="line"><a class="reference internal" href="#id8">~=</a></div>
<div class="line"><a class="reference internal" href="#id29">~= (complex)</a></div>
<div class="line"><a class="reference internal" href="#id19">~= (intervals)</a></div>
<div class="line"><a class="reference internal" href="#id9">&lt;</a></div>
<div class="line"><a class="reference internal" href="#id10">&lt;=</a></div>
<div class="line"><a class="reference internal" href="#id11">&gt;</a></div>
<div class="line"><a class="reference internal" href="#id12">&gt;=</a></div>
<div class="line"><a class="reference internal" href="#id20"># (intervals)</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#abs">abs</a></div>
<div class="line"><a class="reference internal" href="#abs-complex">abs (complex)</a></div>
<div class="line"><a class="reference internal" href="#abs-intervals">abs (intervals)</a></div>
<div class="line"><a class="reference internal" href="#after">after</a></div>
<div class="line"><a class="reference internal" href="#arg-complex">arg (complex)</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#before">before</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#ceil">ceil</a></div>
<div class="line"><a class="reference internal" href="#ceil-multiple">ceil_multiple</a></div>
<div class="line"><a class="reference internal" href="#cmp">cmp</a></div>
<div class="line"><a class="reference internal" href="#cmp-complexity">cmp_complexity</a></div>
<div class="line"><a class="reference internal" href="#complexity-rel">complexity_rel</a></div>
<div class="line"><a class="reference internal" href="#complexp">complexp</a></div>
<div class="line"><a class="reference internal" href="#compvalp">compvalp</a></div>
<div class="line"><a class="reference internal" href="#comp-simplify">comp_simplify</a></div>
<div class="line"><a class="reference internal" href="#continued-fraction">continued_fraction</a></div>
<div class="line"><a class="reference internal" href="#continued-fraction-epsilon">continued_fraction_epsilon</a></div>
<div class="line"><a class="reference internal" href="#continued-fraction-max-terms">continued_fraction_max_terms</a></div>
<div class="line"><a class="reference internal" href="#id22">convergents</a></div>
<div class="line"><a class="reference internal" href="#create-format">create_format</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#den">den</a></div>
<div class="line"><a class="reference internal" href="#den-complex">den (complex)</a></div>
<div class="line"><a class="reference internal" href="#disjoint">disjoint</a></div>
<div class="line"><a class="reference internal" href="#div">div</a></div>
<div class="line"><a class="reference internal" href="#divide">divide</a></div>
<div class="line"><a class="reference internal" href="#div-mod-gauss">div_mod_gauss</a></div>
<div class="line"><a class="reference internal" href="#double">double</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#eq-cplx">eq_cplx</a></div>
<div class="line"><a class="reference internal" href="#euclid-alg">euclid_alg</a></div>
<div class="line"><a class="reference internal" href="#euclid-gcd">euclid_gcd</a></div>
<div class="line"><a class="reference internal" href="#evaluate-continued-fraction">evaluate_continued_fraction</a></div>
<div class="line"><a class="reference internal" href="#exactp">exactp</a></div>
<div class="line"><a class="reference internal" href="#exactp-intervals">exactp (intervals)</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#farey">farey</a></div>
<div class="line"><a class="reference internal" href="#floor">floor</a></div>
<div class="line"><a class="reference internal" href="#floor-multiple">floor_multiple</a></div>
<div class="line"><a class="reference internal" href="#frac">frac</a></div>
<div class="line"><a class="reference internal" href="#fraction">fraction</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#gcd">gcd</a></div>
<div class="line"><a class="reference internal" href="#gcd-gauss">gcd_gauss</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#im">im</a></div>
<div class="line"><a class="reference internal" href="#inexactp">inexactp</a></div>
<div class="line"><a class="reference internal" href="#inexactp-intervals">inexactp (intervals)</a></div>
<div class="line"><a class="reference internal" href="#int">int</a></div>
<div class="line"><a class="reference internal" href="#intcompvalp">intcompvalp</a></div>
<div class="line"><a class="reference internal" href="#interval">interval</a></div>
<div class="line"><a class="reference internal" href="#intinterval-valp">intinterval_valp</a></div>
<div class="line"><a class="reference internal" href="#intervalp">intervalp</a></div>
<div class="line"><a class="reference internal" href="#interval-valp">interval_valp</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#join-str-real-approx">join_str_real_approx</a></div>
<div class="line"><a class="reference internal" href="#join-str-real-eng">join_str_real_eng</a></div>
<div class="line"><a class="reference internal" href="#join-str-real-recur">join_str_real_recur</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#lcm">lcm</a></div>
<div class="line"><a class="reference internal" href="#least-cplx">least_cplx</a></div>
<div class="line"><a class="reference internal" href="#less-cplx">less_cplx</a></div>
<div class="line"><a class="reference internal" href="#less-eq-cplx">less_eq_cplx</a></div>
<div class="line"><a class="reference internal" href="#lower">lower</a></div>
<div class="line"><a class="reference internal" href="#lo-up">lo_up</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#max">max</a></div>
<div class="line"><a class="reference internal" href="#mediant">mediant</a></div>
<div class="line"><a class="reference internal" href="#min">min</a></div>
<div class="line"><a class="reference internal" href="#mod">mod</a></div>
<div class="line"><a class="reference internal" href="#modulus">modulus</a></div>
<div class="line"><a class="reference internal" href="#more-cplx">more_cplx</a></div>
<div class="line"><a class="reference internal" href="#more-eq-cplx">more_eq_cplx</a></div>
<div class="line"><a class="reference internal" href="#most-cplx">most_cplx</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#n-div-gauss">n_div_gauss</a></div>
<div class="line"><a class="reference internal" href="#n-mod-gauss">n_mod_gauss</a></div>
<div class="line"><a class="reference internal" href="#norm-gauss">norm_gauss</a></div>
<div class="line"><a class="reference internal" href="#not-eq-cplx">not_eq_cplx</a></div>
<div class="line"><a class="reference internal" href="#num">num</a></div>
<div class="line"><a class="reference internal" href="#num-complex">num (complex)</a></div>
<div class="line"><a class="reference internal" href="#num-den">num_den</a></div>
<div class="line"><a class="reference internal" href="#num-den-complex">num_den (complex)</a></div>
<div class="line"><a class="reference internal" href="#num-den-gauss">num_den_gauss</a></div>
<div class="line"><a class="reference internal" href="#num-den-nat">num_den_nat</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#polar-complex">polar (complex)</a></div>
<div class="line"><a class="reference internal" href="#pow">pow</a></div>
<div class="line"><a class="reference internal" href="#prefix-complexity-rel">prefix_complexity_rel</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#ratcompvalp">ratcompvalp</a></div>
<div class="line"><a class="reference internal" href="#rational">rational</a></div>
<div class="line"><a class="reference internal" href="#rationalp">rationalp</a></div>
<div class="line"><a class="reference internal" href="#rational-approx-epsilon">rational_approx_epsilon</a></div>
<div class="line"><a class="reference internal" href="#rational-approxs-epsilon">rational_approxs_epsilon</a></div>
<div class="line"><a class="reference internal" href="#rational-interval-epsilon">rational_interval_epsilon</a></div>
<div class="line"><a class="reference internal" href="#rational-approx-max-den">rational_approx_max_den</a></div>
<div class="line"><a class="reference internal" href="#rational-approxs-max-den">rational_approxs_max_den</a></div>
<div class="line"><a class="reference internal" href="#rational-interval-max-den">rational_interval_max_den</a></div>
<div class="line"><a class="reference internal" href="#ratinterval-valp">ratinterval_valp</a></div>
<div class="line"><a class="reference internal" href="#ratvalp">ratvalp</a></div>
<div class="line"><a class="reference internal" href="#ratcomp-simplify">ratcomp_simplify</a></div>
<div class="line"><a class="reference internal" href="#rat-simplify">rat_simplify</a></div>
<div class="line"><a class="reference internal" href="#re">re</a></div>
<div class="line"><a class="reference internal" href="#reciprocal">reciprocal</a></div>
<div class="line"><a class="reference internal" href="#round">round</a></div>
<div class="line"><a class="reference internal" href="#round-multiple-unbiased">round_multiple_unbiased</a></div>
<div class="line"><a class="reference internal" href="#round-multiple-zero-bias">round_multiple_zero_bias</a></div>
<div class="line"><a class="reference internal" href="#round-unbiased">round_unbiased</a></div>
<div class="line"><a class="reference internal" href="#round-zero-bias">round_zero_bias</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#quotient">quotient</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#sgn">sgn</a></div>
<div class="line"><a class="reference internal" href="#sgn-intervals">sgn (intervals)</a></div>
<div class="line"><a class="reference internal" href="#split-str-real-eng">split_str_real_eng</a></div>
<div class="line"><a class="reference internal" href="#split-str-real-recur">split_str_real_recur</a></div>
<div class="line"><a class="reference internal" href="#str">str</a></div>
<div class="line"><a class="reference internal" href="#strictly-after">strictly_after</a></div>
<div class="line"><a class="reference internal" href="#strictly-before">strictly_before</a></div>
<div class="line"><a class="reference internal" href="#strictly-disjoint">strictly_disjoint</a></div>
<div class="line"><a class="reference internal" href="#strictly-within">strictly_within</a></div>
<div class="line"><a class="reference internal" href="#strictly-without">strictly_without</a></div>
<div class="line"><a class="reference internal" href="#strs-real-approx-dp">strs_real_approx_dp</a></div>
<div class="line"><a class="reference internal" href="#strs-real-approx-eng">strs_real_approx_eng</a></div>
<div class="line"><a class="reference internal" href="#strs-real-approx-sf">strs_real_approx_sf</a></div>
<div class="line"><a class="reference internal" href="#strs-real-approx-sci">strs_real_approx_sci</a></div>
<div class="line"><a class="reference internal" href="#strs-real-recur">strs_real_recur</a></div>
<div class="line"><a class="reference internal" href="#str-mixed">str_mixed</a></div>
<div class="line"><a class="reference internal" href="#str-real-approx-dp">str_real_approx_dp</a></div>
<div class="line"><a class="reference internal" href="#str-real-approx-eng">str_real_approx_eng</a></div>
<div class="line"><a class="reference internal" href="#str-real-approx-sf">str_real_approx_sf</a></div>
<div class="line"><a class="reference internal" href="#str-real-approx-sci">str_real_approx_sci</a></div>
<div class="line"><a class="reference internal" href="#str-real-recur">str_real_recur</a></div>
<div class="line"><a class="reference internal" href="#str-vulgar">str_vulgar</a></div>
<div class="line"><a class="reference internal" href="#str-vulgar-or-int">str_vulgar_or_int</a></div>
<div class="line"><a class="reference internal" href="#sval-real-eng">sval_real_eng</a></div>
<div class="line"><a class="reference internal" href="#sval-real-recur">sval_real_recur</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#trunc">trunc</a></div>
<div class="line"><a class="reference internal" href="#trunc-multiple">trunc_multiple</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#upper">upper</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#val">val</a></div>
<div class="line"><a class="reference internal" href="#val-mixed">val_mixed</a></div>
<div class="line"><a class="reference internal" href="#val-eng-approx-epsilon">val_eng_approx_epsilon</a></div>
<div class="line"><a class="reference internal" href="#val-eng-approx-max-den">val_eng_approx_max_den</a></div>
<div class="line"><a class="reference internal" href="#val-eng-interval-epsilon">val_eng_interval_epsilon</a></div>
<div class="line"><a class="reference internal" href="#val-eng-interval-max-den">val_eng_interval_max_den</a></div>
<div class="line"><a class="reference internal" href="#val-real-eng">val_real_eng</a></div>
<div class="line"><a class="reference internal" href="#val-real-recur">val_real_recur</a></div>
<div class="line"><a class="reference internal" href="#val-vulgar">val_vulgar</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#within">within</a></div>
<div class="line"><a class="reference internal" href="#without">without</a></div>
</div>
</div>
</div>
</body>
</html>
