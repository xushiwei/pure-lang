<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.6: http://docutils.sourceforge.net/" />
<title>Pure Library Manual</title>
<meta name="author" content="Albert Gräf &lt;Dr.Graef&#64;t-online.de&gt;" />
<meta name="date" content="2010-02-24" />
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 5631 2008-08-24 13:01:23Z goodger $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left {
  clear: left }

img.align-right {
  clear: right }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block {
  margin-left: 2em ;
  margin-right: 2em }

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="pure-library-manual">
<h1 class="title">Pure Library Manual</h1>
<table class="docinfo" frame="void" rules="none">
<col class="docinfo-name" />
<col class="docinfo-content" />
<tbody valign="top">
<tr><th class="docinfo-name">Author:</th>
<td>Albert Gräf &lt;<a class="reference external" href="mailto:Dr.Graef&#64;t-online.de">Dr.Graef&#64;t-online.de</a>&gt;</td></tr>
<tr><th class="docinfo-name">Date:</th>
<td>2010-02-24</td></tr>
</tbody>
</table>
<!-- We use docutils to produce the documentation. Docstrings are extracted -->
<!-- with pure-doc. Please see the pure-doc documentation for details. -->
<!-- This module is always the first in the library docs, so produce the -->
<!-- title here. -->
<!-- Add all pertaining author and copyright information here. -->
<!-- Add all global docutils declarations here. -->
<p>Copyright (c) 2009-2010 by Albert Gräf. This document is available under
the <a class="reference external" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License</a>.</p>
<p>This manual describes the operations in the standard Pure library,
including the prelude and the other library modules which come bundled with
the interpreter.</p>
<p>There is a companion to this manual, the <a class="reference external" href="pure.html">Pure Manual</a> which describes the
Pure language and the operation of the Pure interpreter.</p>
<!-- Table of contents, switch on section numbering. -->
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="auto-toc simple">
<li><a class="reference internal" href="#prelude" id="id71">1&nbsp;&nbsp;&nbsp;Prelude</a><ul class="auto-toc">
<li><a class="reference internal" href="#basic-combinators" id="id72">1.1&nbsp;&nbsp;&nbsp;Basic Combinators</a></li>
<li><a class="reference internal" href="#lists-and-tuples" id="id73">1.2&nbsp;&nbsp;&nbsp;Lists and Tuples</a></li>
<li><a class="reference internal" href="#list-functions" id="id74">1.3&nbsp;&nbsp;&nbsp;List Functions</a><ul class="auto-toc">
<li><a class="reference internal" href="#common-list-functions" id="id75">1.3.1&nbsp;&nbsp;&nbsp;Common List Functions</a></li>
<li><a class="reference internal" href="#list-generators" id="id76">1.3.2&nbsp;&nbsp;&nbsp;List Generators</a></li>
<li><a class="reference internal" href="#zip-and-friends" id="id77">1.3.3&nbsp;&nbsp;&nbsp;Zip and Friends</a></li>
</ul>
</li>
<li><a class="reference internal" href="#string-functions" id="id78">1.4&nbsp;&nbsp;&nbsp;String Functions</a><ul class="auto-toc">
<li><a class="reference internal" href="#basic-string-functions" id="id79">1.4.1&nbsp;&nbsp;&nbsp;Basic String Functions</a></li>
<li><a class="reference internal" href="#low-level-operations" id="id80">1.4.2&nbsp;&nbsp;&nbsp;Low-Level Operations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#matrix-functions" id="id81">1.5&nbsp;&nbsp;&nbsp;Matrix Functions</a><ul class="auto-toc">
<li><a class="reference internal" href="#matrix-dimension-and-indexing" id="id82">1.5.1&nbsp;&nbsp;&nbsp;Matrix Dimension and Indexing</a></li>
<li><a class="reference internal" href="#matrix-inspection-and-manipulation" id="id83">1.5.2&nbsp;&nbsp;&nbsp;Matrix Inspection and Manipulation</a></li>
<li><a class="reference internal" href="#pointers-and-matrices" id="id84">1.5.3&nbsp;&nbsp;&nbsp;Pointers and Matrices</a></li>
</ul>
</li>
<li><a class="reference internal" href="#record-functions" id="id85">1.6&nbsp;&nbsp;&nbsp;Record Functions</a></li>
<li><a class="reference internal" href="#primitives" id="id86">1.7&nbsp;&nbsp;&nbsp;Primitives</a><ul class="auto-toc">
<li><a class="reference internal" href="#arithmetic" id="id87">1.7.1&nbsp;&nbsp;&nbsp;Arithmetic</a></li>
<li><a class="reference internal" href="#conversions" id="id88">1.7.2&nbsp;&nbsp;&nbsp;Conversions</a></li>
<li><a class="reference internal" href="#predicates" id="id89">1.7.3&nbsp;&nbsp;&nbsp;Predicates</a></li>
<li><a class="reference internal" href="#inspection" id="id90">1.7.4&nbsp;&nbsp;&nbsp;Inspection</a></li>
<li><a class="reference internal" href="#eval-and-friends" id="id91">1.7.5&nbsp;&nbsp;&nbsp;Eval and Friends</a></li>
<li><a class="reference internal" href="#expression-serialization" id="id92">1.7.6&nbsp;&nbsp;&nbsp;Expression Serialization</a></li>
<li><a class="reference internal" href="#other-special-primitives" id="id93">1.7.7&nbsp;&nbsp;&nbsp;Other Special Primitives</a></li>
<li><a class="reference internal" href="#pointer-operations" id="id94">1.7.8&nbsp;&nbsp;&nbsp;Pointer Operations</a></li>
<li><a class="reference internal" href="#sentries" id="id95">1.7.9&nbsp;&nbsp;&nbsp;Sentries</a></li>
<li><a class="reference internal" href="#expression-references" id="id96">1.7.10&nbsp;&nbsp;&nbsp;Expression References</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#mathematical-functions" id="id97">2&nbsp;&nbsp;&nbsp;Mathematical Functions</a><ul class="auto-toc">
<li><a class="reference internal" href="#imports" id="id98">2.1&nbsp;&nbsp;&nbsp;Imports</a></li>
<li><a class="reference internal" href="#basic-math-functions" id="id99">2.2&nbsp;&nbsp;&nbsp;Basic Math Functions</a></li>
<li><a class="reference internal" href="#complex-numbers" id="id100">2.3&nbsp;&nbsp;&nbsp;Complex Numbers</a></li>
<li><a class="reference internal" href="#rational-numbers" id="id101">2.4&nbsp;&nbsp;&nbsp;Rational Numbers</a></li>
<li><a class="reference internal" href="#semantic-number-predicates" id="id102">2.5&nbsp;&nbsp;&nbsp;Semantic Number Predicates</a></li>
</ul>
</li>
<li><a class="reference internal" href="#container-types" id="id103">3&nbsp;&nbsp;&nbsp;Container Types</a><ul class="auto-toc">
<li><a class="reference internal" href="#arrays" id="id104">3.1&nbsp;&nbsp;&nbsp;Arrays</a><ul class="auto-toc">
<li><a class="reference internal" href="#id40" id="id105">3.1.1&nbsp;&nbsp;&nbsp;Imports</a></li>
<li><a class="reference internal" href="#data-structure" id="id106">3.1.2&nbsp;&nbsp;&nbsp;Data Structure</a></li>
<li><a class="reference internal" href="#operations" id="id107">3.1.3&nbsp;&nbsp;&nbsp;Operations</a></li>
<li><a class="reference internal" href="#examples" id="id108">3.1.4&nbsp;&nbsp;&nbsp;Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#heaps" id="id109">3.2&nbsp;&nbsp;&nbsp;Heaps</a><ul class="auto-toc">
<li><a class="reference internal" href="#id43" id="id110">3.2.1&nbsp;&nbsp;&nbsp;Imports</a></li>
<li><a class="reference internal" href="#id44" id="id111">3.2.2&nbsp;&nbsp;&nbsp;Data Structure</a></li>
<li><a class="reference internal" href="#id45" id="id112">3.2.3&nbsp;&nbsp;&nbsp;Operations</a></li>
<li><a class="reference internal" href="#id47" id="id113">3.2.4&nbsp;&nbsp;&nbsp;Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dictionaries" id="id114">3.3&nbsp;&nbsp;&nbsp;Dictionaries</a><ul class="auto-toc">
<li><a class="reference internal" href="#id48" id="id115">3.3.1&nbsp;&nbsp;&nbsp;Imports</a></li>
<li><a class="reference internal" href="#id49" id="id116">3.3.2&nbsp;&nbsp;&nbsp;Data Structure</a></li>
<li><a class="reference internal" href="#id50" id="id117">3.3.3&nbsp;&nbsp;&nbsp;Operations</a></li>
<li><a class="reference internal" href="#id55" id="id118">3.3.4&nbsp;&nbsp;&nbsp;Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sets-and-bags" id="id119">3.4&nbsp;&nbsp;&nbsp;Sets and Bags</a><ul class="auto-toc">
<li><a class="reference internal" href="#id56" id="id120">3.4.1&nbsp;&nbsp;&nbsp;Imports</a></li>
<li><a class="reference internal" href="#id57" id="id121">3.4.2&nbsp;&nbsp;&nbsp;Data Structure</a></li>
<li><a class="reference internal" href="#id58" id="id122">3.4.3&nbsp;&nbsp;&nbsp;Operations</a></li>
<li><a class="reference internal" href="#id67" id="id123">3.4.4&nbsp;&nbsp;&nbsp;Examples</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#system-interface" id="id124">4&nbsp;&nbsp;&nbsp;System Interface</a><ul class="auto-toc">
<li><a class="reference internal" href="#id68" id="id125">4.1&nbsp;&nbsp;&nbsp;Imports</a></li>
<li><a class="reference internal" href="#errno-and-friends" id="id126">4.2&nbsp;&nbsp;&nbsp;Errno and Friends</a></li>
<li><a class="reference internal" href="#posix-locale" id="id127">4.3&nbsp;&nbsp;&nbsp;POSIX Locale</a></li>
<li><a class="reference internal" href="#signal-handling" id="id128">4.4&nbsp;&nbsp;&nbsp;Signal Handling</a></li>
<li><a class="reference internal" href="#time-functions" id="id129">4.5&nbsp;&nbsp;&nbsp;Time Functions</a></li>
<li><a class="reference internal" href="#process-functions" id="id130">4.6&nbsp;&nbsp;&nbsp;Process Functions</a></li>
<li><a class="reference internal" href="#basic-i-o-interface" id="id131">4.7&nbsp;&nbsp;&nbsp;Basic I/O Interface</a></li>
<li><a class="reference internal" href="#stat-and-friends" id="id132">4.8&nbsp;&nbsp;&nbsp;Stat and Friends</a></li>
<li><a class="reference internal" href="#readdir" id="id133">4.9&nbsp;&nbsp;&nbsp;Readdir</a></li>
<li><a class="reference internal" href="#shell-globbing" id="id134">4.10&nbsp;&nbsp;&nbsp;Shell Globbing</a></li>
<li><a class="reference internal" href="#regex-matching" id="id135">4.11&nbsp;&nbsp;&nbsp;Regex Matching</a><ul class="auto-toc">
<li><a class="reference internal" href="#basic-examples" id="id136">4.11.1&nbsp;&nbsp;&nbsp;Basic Examples</a></li>
<li><a class="reference internal" href="#regex-substitutions-and-splitting" id="id137">4.11.2&nbsp;&nbsp;&nbsp;Regex Substitutions and Splitting</a></li>
<li><a class="reference internal" href="#empty-matches" id="id138">4.11.3&nbsp;&nbsp;&nbsp;Empty Matches</a></li>
<li><a class="reference internal" href="#submatches" id="id139">4.11.4&nbsp;&nbsp;&nbsp;Submatches</a></li>
</ul>
</li>
<li><a class="reference internal" href="#additional-posix-functions" id="id140">4.12&nbsp;&nbsp;&nbsp;Additional POSIX Functions</a></li>
<li><a class="reference internal" href="#option-parsing" id="id141">4.13&nbsp;&nbsp;&nbsp;Option Parsing</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id70" id="id142">5&nbsp;&nbsp;&nbsp;Index</a></li>
</ul>
</div>
<div class="section" id="prelude">
<h1><a class="toc-backref" href="#id71">1&nbsp;&nbsp;&nbsp;Prelude</a></h1>
<p>The prelude defines the basic operations of the Pure language. This
includes the basic arithmetic and logical operations, string, list and
matrix functions, as well as the support operations required to implement
list and matrix comprehensions. The string, matrix and record operations
are in separate modules strings.pure, matrices.pure and records.pure, the
primitive arithmetic and logical operations can be found in
primitives.pure. Note that since the prelude module gets imported
automatically (unless the interpreter is invoked with the <tt class="docutils literal"><span class="pre">--no-prelude</span></tt>
option), all operations discussed in this section are normally available in
Pure programs without requiring any explicit import declarations.</p>
<p>The prelude also declares a signature of commonly used constant and
operator symbols.</p>
<a name="failed_cond"><a name="failed_match"><a name="stack_fault"><ul class="simple" id="stack-fault">
<span id="failed-match"></span><span id="failed-cond"></span><li>The built-in exception values <tt class="docutils literal"><span class="pre">failed_cond</span></tt> (failed conditional in
guard or if-then-else), <tt class="docutils literal"><span class="pre">failed_match</span></tt> (failed pattern match in lambda,
<tt class="docutils literal"><span class="pre">case</span></tt> expression, etc.) and <tt class="docutils literal"><span class="pre">stack_fault</span></tt> (not enough stack space,
<tt class="docutils literal"><span class="pre">PURE_STACK</span></tt> limit exceeded).</li>
</ul>
<a name="bad_list_value"><a name="bad_tuple_value"><a name="bad_string_value"><a name="bad_matrix_value"><a name="out_of_bounds"><a name="malloc_error"><ul class="simple" id="malloc-error">
<span id="out-of-bounds"></span><span id="bad-matrix-value"></span><span id="bad-string-value"></span><span id="bad-tuple-value"></span><span id="bad-list-value"></span><li>Other predefined exceptions: <tt class="docutils literal"><span class="pre">bad_string_value</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">bad_matrix_value</span>
<span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">bad_list_value</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">bad_tuple_value</span> <span class="pre">x</span></tt> (which are thrown by
some operations when they fail to find an expected value of the
corresponding type), <tt class="docutils literal"><span class="pre">out_of_bounds</span></tt> (which is thrown by the index
operator <tt class="docutils literal"><span class="pre">!</span></tt> if a list, tuple or matrix index is out of bounds), and
<tt class="docutils literal"><span class="pre">malloc_error</span></tt> which indicates a memory allocation error.</li>
</ul>
<a name="true"><a name="false"><ul class="simple" id="false">
<span id="true"></span><li>The truth values <tt class="docutils literal"><span class="pre">true</span></tt> and <tt class="docutils literal"><span class="pre">false</span></tt>. These are actually just integers
in Pure, but sometimes it's convenient to refer to them using these
symbolic constants. Note that if you also want to use these on the
left-hand side of equations, you still have to declare them as
<tt class="docutils literal"><span class="pre">nonfix</span></tt> symbols yourself, using a declaration like: <tt class="docutils literal"><span class="pre">nonfix</span> <span class="pre">false</span>
<span class="pre">true;</span></tt></li>
</ul>
<a name="operators"><p id="operators">Here's the list of predefined operator symbols. Note that the parser will
automagically give unary minus the same precedence level as the
corresponding binary operator.</p>
<pre class="literal-block">
infixl  1000   $$ ;                // sequence operator
infixr  1000   $ ;                 // right-associative application
infixr  1100   , ;                 // pair (tuple)
infix   1200   =&gt; ;                // key=&gt;value pairs (&quot;hash rocket&quot;)
infix   1300   .. ;                // arithmetic sequences
infixr  1400   || ;                // logical or (short-circuit)
infixr  1500   &amp;&amp; ;                // logical and (short-circuit)
prefix  1600   ~ ;                 // logical negation
infix   1700   &lt; &gt; &lt;= &gt;= == ~= ;   // relations
infix   1700   === ~== ;           // syntactic equality
infixr  1800   : ;                 // list cons
infix   1900   +: &lt;: ;             // complex numbers (cf. math.pure)
infixl  2000   &lt;&lt; &gt;&gt; ;             // bit shifts
infixl  2100   + - or ;            // addition, bitwise or
infixl  2200   * / div mod and ;   // multiplication, bitwise and
infixl  2200   % ;                 // exact division (cf. math.pure)
prefix  2300   not ;               // bitwise not
infixr  2400   ^ ;                 // exponentiation
prefix  2500   # ;                 // size operator
infixl  2600   ! !! ;              // indexing, slicing
infixr  2700   . ;                 // function composition
prefix  2800   ' ;                 // quote
postfix 2900   &amp; ;                 // thunk
</pre>
<!--  -->
<div class="section" id="basic-combinators">
<h2><a class="toc-backref" href="#id72">1.1&nbsp;&nbsp;&nbsp;Basic Combinators</a></h2>
<a name="combinators"><a name="$"><a name="."><p id="id2"><span id="id1"></span><span id="combinators"></span>The most important function combinators are <tt class="docutils literal"><span class="pre">$</span></tt> (right-associative
application) and <tt class="docutils literal"><span class="pre">.</span></tt> (function composition), which are also defined as
macros so that saturated calls of these are eliminated automatically.
Examples:</p>
<pre class="literal-block">
&gt; foo $ bar 99;
foo (bar 99)
&gt; (foo.bar) 99;
foo (bar 99)
</pre>
<a name="id"><a name="cst"><p id="cst"><span id="id"></span>The customary identity and constant combinators from the combinatorial
calculus are also available, in Pure these are named <tt class="docutils literal"><span class="pre">id</span></tt> and <tt class="docutils literal"><span class="pre">cst</span></tt>,
respectively:</p>
<pre class="literal-block">
&gt; map id (1..5);
[1,2,3,4,5]
&gt; map (cst 0) (1..5);
[0,0,0,0,0]
</pre>
<a name="void"><p id="void">There's also a combinator <tt class="docutils literal"><span class="pre">void</span></tt> which is basically equivalent to <tt class="docutils literal"><span class="pre">cst</span>
<span class="pre">()</span></tt>, but with the special twist that it is also defined as a macro
optimizing the case of &quot;throwaway&quot; list and matrix comprehensions. This is
useful if a comprehension is evaluated solely for its side effects. E.g.:</p>
<pre class="literal-block">
&gt; using system;
&gt; extern int rand();
&gt; foo = void [printf &quot;%d\n&quot; rand | _ = 1..3];
&gt; show foo
foo = do (\_ -&gt; printf &quot;%d\n&quot; rand) (1..3);
&gt; foo;
1714636915
1957747793
424238335
()
</pre>
<p>Note that the above list comprehension is actually implemented using <a class="reference internal" href="#do"><tt class="docutils literal"><span class="pre">do</span></tt></a>
(instead of <a class="reference internal" href="#map"><tt class="docutils literal"><span class="pre">map</span></tt></a>, which would normally be the case), so that the
intermediate list value of the comprehension is never constructed. This is
described in more detail in section <a class="reference external" href="pure.html#optimization-rules">Optimization Rules</a> of the Pure
Manual.</p>
<!--  -->
<p>In addition, Pure also provides the following combinators adopted from
Haskell:</p>
<a name="flip"><ul id="flip">
<li><p class="first"><tt class="docutils literal"><span class="pre">flip</span> <span class="pre">f</span></tt> swaps arguments of a binary function <tt class="docutils literal"><span class="pre">f</span></tt>, e.g.:</p>
<pre class="literal-block">
&gt; map (flip (/) 2) (1..3);
[0.5,1.0,1.5]
</pre>
<p>This combinator is also used by the compiler to implement right operator
sections, which allows you to write the above simply as:</p>
<pre class="literal-block">
&gt; map (/2) (1..3);
[0.5,1.0,1.5]
</pre>
</li>
</ul>
<a name="curry"><ul id="curry">
<li><p class="first"><tt class="docutils literal"><span class="pre">curry</span> <span class="pre">f</span></tt> turns a function <tt class="docutils literal"><span class="pre">f</span></tt> expecting a pair of values into a
curried function of two arguments:</p>
<pre class="literal-block">
&gt; using system;
&gt; dowith (curry (printf &quot;%d: %g\n&quot;)) (0..2) [0.0,2.718,3.14];
0: 0
1: 2.718
2: 3.14
()
</pre>
</li>
</ul>
<a name="uncurry"><ul id="uncurry">
<li><p class="first">Conversely, <tt class="docutils literal"><span class="pre">uncurry</span> <span class="pre">f</span></tt> turns a curried function <tt class="docutils literal"><span class="pre">f</span></tt> expecting two
arguments into a function processing a single pair argument:</p>
<pre class="literal-block">
&gt; map (uncurry (*)) [(2,3),(4,5),(6,7)];
[6,20,42]
</pre>
</li>
</ul>
<a name="curry3"><a name="uncurry3"><ul class="simple" id="uncurry3">
<span id="curry3"></span><li><tt class="docutils literal"><span class="pre">curry3</span></tt> and <tt class="docutils literal"><span class="pre">uncurry3</span></tt> are defined analogously, but are used to work
with ternary functions.</li>
</ul>
<a name="fix"><ul id="fix">
<li><p class="first">The (normal order) fixed point combinator <tt class="docutils literal"><span class="pre">fix</span></tt> allows you to create
recursive anonymous functions. It takes another function <tt class="docutils literal"><span class="pre">f</span></tt> as its
argument and applies <tt class="docutils literal"><span class="pre">f</span></tt> to <tt class="docutils literal"><span class="pre">fix</span> <span class="pre">f</span></tt> itself:</p>
<pre class="literal-block">
&gt; let fact = fix (\f n -&gt; if n&lt;=0 then 1 else n*f (n-1));
&gt; map fact (1..5);
[1,2,6,24,120]
</pre>
<p>See <a class="reference external" href="http://en.wikipedia.org/wiki/Fixed_point_combinator">Fixed point combinator</a> at Wikipedia for an explanation of how this magic works.
Just like in Haskell, <tt class="docutils literal"><span class="pre">fix</span></tt> can be used to produce least fixed points
of arbitrary functions. For instance:</p>
<pre class="literal-block">
&gt; fix (cst bar);
bar
&gt; let xs = fix (1:);
&gt; xs;
1:#&lt;thunk 0x7fe537fe2f90&gt;
&gt; xs!!(0..10);
[1,1,1,1,1,1,1,1,1,1,1]
</pre>
</li>
</ul>
<!--  -->
</div>
<div class="section" id="lists-and-tuples">
<h2><a class="toc-backref" href="#id73">1.2&nbsp;&nbsp;&nbsp;Lists and Tuples</a></h2>
<a name="lists"><a name="tuples"><a name="list size"><a name="tuple size"><a name="null"><a name="reverse"><a name="#"><a name=":"><a name=","><a name="!"><a name="!!"><p id="id7"><span id="id6"></span><span id="id5"></span><span id="id4"></span><span id="id3"></span><span id="reverse"></span><span id="null"></span><span id="tuple-size"></span><span id="list-size"></span><span id="tuples"></span><span id="lists"></span>The prelude defines the list and tuple constructors (<tt class="docutils literal"><span class="pre">x:y</span></tt>, <tt class="docutils literal"><span class="pre">x,y</span></tt>), as
well as equality (<tt class="docutils literal"><span class="pre">==</span></tt>) and inequality (<tt class="docutils literal"><span class="pre">~=</span></tt>) on these structures. (The
latter compare two lists or tuples by recursively comparing their members,
so <tt class="docutils literal"><span class="pre">==</span></tt> must be defined on the list or tuple members if you want to use
these operations.) It also provides the predicate <tt class="docutils literal"><span class="pre">null</span> <span class="pre">x</span></tt> which tests
whether <tt class="docutils literal"><span class="pre">x</span></tt> is the empty list or tuple, the function <tt class="docutils literal"><span class="pre">reverse</span> <span class="pre">x</span></tt> which
reverses a list or tuple, and the operators <tt class="docutils literal"><span class="pre">#x</span></tt> (size of a list or
tuple), <tt class="docutils literal"><span class="pre">x!i</span></tt> (indexing), <tt class="docutils literal"><span class="pre">x!!is</span></tt> (slicing) and <tt class="docutils literal"><span class="pre">x+y</span></tt> (list
concatenation). Note that there isn't a separate operation for
concatenating tuples, since the pairing operator already does this:</p>
<pre class="literal-block">
&gt; (1,2,3),(10,9,8);
1,2,3,10,9,8
</pre>
<p>This works because the <tt class="docutils literal"><span class="pre">(,)</span></tt> constructor is associative in Pure and will
always produce right-recursive pairs. This also implies that tuples are
always flat in Pure and can't be nested; if you need this, you should use
lists instead. Also note that the empty tuple <tt class="docutils literal"><span class="pre">()</span></tt> acts as a neutral
element with respect to <tt class="docutils literal"><span class="pre">(,)</span></tt>:</p>
<pre class="literal-block">
&gt; (),(a,b,c);
a,b,c
&gt; (a,b,c),();
a,b,c
</pre>
<a name="list concatenation"><a name="+ (list)"><p id="list"><span id="list-concatenation"></span>Lists are the usual right-recursive aggregates, pretty much the same as in
Lisp or Prolog except that they use a Haskell-like syntax. In difference to
Haskell, list concatenation is denoted <tt class="docutils literal"><span class="pre">+</span></tt>, and lists may contain an
arbitrary mixture of arguments, i.e., they are fully polymorphic:</p>
<pre class="literal-block">
&gt; 1:2:3:[];
[1,2,3]
&gt; [1,2,3]+[u,v,w]+[3.14];
[1,2,3,u,v,w,3.14]
</pre>
<p>Lists are <strong class="dfn">eager</strong> in Pure by default, but they can also be made <strong class="dfn">lazy</strong>, see
section <a class="reference external" href="pure.html#lazy-evaluation-and-streams">Lazy Evaluation and Streams</a> in the Pure Manual.</p>
<a name="arithmetic sequences"><a name=".."><p id="id8"><span id="arithmetic-sequences"></span>Arithmetic sequences can be constructed with the infix <tt class="docutils literal"><span class="pre">..</span></tt> operator:</p>
<pre class="literal-block">
&gt; 1..5;
[1,2,3,4,5]
&gt; 1:3..11;
[1,3,5,7,9,11]
</pre>
<p>Note that the Pure syntax differs from Haskell in that there are no
brackets around the construct and a step width is indicated by specifying
the first two elements as <tt class="docutils literal"><span class="pre">x:y</span></tt> instead of <tt class="docutils literal"><span class="pre">x,y</span></tt>. Also, to specify
infinite sequences you have to use an infinite upper bound (<tt class="docutils literal"><span class="pre">inf</span></tt> or
<tt class="docutils literal"><span class="pre">-inf</span></tt>):</p>
<pre class="literal-block">
&gt; 1:3..inf;
1:#&lt;thunk 0x7f696cd2dbd8&gt;
&gt; -1:-3..-inf;
-1:#&lt;thunk 0x7f696cd2fde8&gt;
</pre>
<p>The lower bounds of an arithmetic sequence must always be finite.</p>
<a name="sort"><p id="sort">Non-lazy lists can be sorted using the <tt class="docutils literal"><span class="pre">sort</span></tt> function, which provides an
interface to the C <tt class="docutils literal"><span class="pre">qsort()</span></tt> routine, please see your local qsort(3)
documentation for details. An order predicate <tt class="docutils literal"><span class="pre">p</span></tt> is specified as the
first argument, which must return a nonzero integer to indicate that its
first argument is &quot;less than&quot; its second argument. Example:</p>
<pre class="literal-block">
&gt; sort (&gt;) (1..10);
[10,9,8,7,6,5,4,3,2,1]
&gt; sort (&lt;) ans;
[1,2,3,4,5,6,7,8,9,10]
</pre>
<a name="list"><a name="tuple"><p id="tuple"><span id="id9"></span>You can convert between (finite) lists and tuples using the <tt class="docutils literal"><span class="pre">list</span></tt> and
<tt class="docutils literal"><span class="pre">tuple</span></tt> operations:</p>
<pre class="literal-block">
&gt; tuple (1..5);
1,2,3,4,5
&gt; list (a,b,c);
[a,b,c]
</pre>
<p>The <tt class="docutils literal"><span class="pre">list</span></tt> function can also be used to turn a finite lazy list into an
eager one:</p>
<pre class="literal-block">
&gt; list $ take 10 (-1:-3..-inf);
[-1,-3,-5,-7,-9,-11,-13,-15,-17,-19]
</pre>
<p>You can also achieve the same effect somewhat more conveniently by slicing
a finite part from a stream (see below):</p>
<pre class="literal-block">
&gt; (-1:-3..-inf)!!(0..9);
[-1,-3,-5,-7,-9,-11,-13,-15,-17,-19]
</pre>
<a name="stream"><p id="stream">Conversely, it is also possible to convert a list to a stream:</p>
<pre class="literal-block">
&gt; stream (1..10);
1:#&lt;thunk 0x7fe537fe2b58&gt;
</pre>
<p>This might appear a bit useless at first sight, since all elements of the
stream are in fact already known. However, this operation then allows you
to apply other functions to the list and have them evaluated in a lazy
fashion.</p>
<a name="list indexing"><a name="tuple indexing"><p id="tuple-indexing"><span id="list-indexing"></span>Indexing of lists and tuples is always zero-based (i.e., indices run from
<tt class="docutils literal"><span class="pre">0</span></tt> to <tt class="docutils literal"><span class="pre">#x-1</span></tt>), and an exception will be raised if the index is out of
bounds:</p>
<pre class="literal-block">
&gt; [1,2,3]!2;
3
&gt; [1,2,3]!4;
&lt;stdin&gt;, line 34: unhandled exception 'out_of_bounds' while evaluating
'[1,2,3]!4'
</pre>
<a name="list slicing"><a name="tuple slicing"><p id="tuple-slicing"><span id="list-slicing"></span>The slicing operator <tt class="docutils literal"><span class="pre">!!</span></tt> takes a list or tuple and a list of indices and
returns the list or tuple of the corresponding elements, respectively.
Indices which are out of the valid range are silently ignored:</p>
<pre class="literal-block">
&gt; (1..5)!!(3..10);
[4,5]
&gt; (1,2,3,4,5)!!(3..10);
4,5
</pre>
<p>Indices can actually be specified in any order, so that you can retrieve
any permutation of the members, also with duplicates. E.g.:</p>
<pre class="literal-block">
&gt; (1..5)!![2,4,4,1];
[3,5,5,2]
</pre>
<p>This is less efficient than the case of contiguous index ranges (which is
optimized so that it always works in linear time), because it requires
repeated traversals of the list for each index. For larger lists you should
hence use vectors or matrices instead, to avoid the quadratic complexity.</p>
<p>(The prelude actually implements the slicing operation in a fairly generic
way, so that it works with any kind of container data structure which
defines <tt class="docutils literal"><span class="pre">!</span></tt> in such a manner that it throws an exception when the index
is out of bounds. It also works with any kind of index container that
implements the <a class="reference internal" href="#catmap"><tt class="docutils literal"><span class="pre">catmap</span></tt></a> operation.)</p>
<!--  -->
</div>
<div class="section" id="list-functions">
<h2><a class="toc-backref" href="#id74">1.3&nbsp;&nbsp;&nbsp;List Functions</a></h2>
<p>This mostly comes straight from the Q prelude which in turn was based on
the first edition of the Bird/Wadler book, and is very similar to what you
can find in the Haskell prelude. Some functions have slightly different
names, though, and of course everything is typed dynamically.</p>
<div class="section" id="common-list-functions">
<h3><a class="toc-backref" href="#id75">1.3.1&nbsp;&nbsp;&nbsp;Common List Functions</a></h3>
<a name="any"><dl class="docutils" id="any">
<dt><tt class="docutils literal"><span class="pre">any</span> <span class="pre">p</span> <span class="pre">xs</span></tt></dt>
<dd>tests whether the predicate <tt class="docutils literal"><span class="pre">p</span></tt> holds for any of the members of <tt class="docutils literal"><span class="pre">xs</span></tt></dd>
</dl>
<a name="all"><dl class="docutils" id="all">
<dt><tt class="docutils literal"><span class="pre">all</span> <span class="pre">p</span> <span class="pre">xs</span></tt></dt>
<dd>tests whether the predicate <tt class="docutils literal"><span class="pre">p</span></tt> holds for all of the members of <tt class="docutils literal"><span class="pre">xs</span></tt></dd>
</dl>
<a name="cat"><span class="target" id="cat"></span><dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">cat</span> <span class="pre">xs</span></tt></dt>
<dd>concatenate a list of lists</dd>
</dl>
<a name="catmap"><dl class="docutils" id="catmap">
<dt><tt class="docutils literal"><span class="pre">catmap</span> <span class="pre">f</span> <span class="pre">xs</span></tt></dt>
<dd>convenience function which combines <a class="reference internal" href="#cat"><tt class="docutils literal"><span class="pre">cat</span></tt></a> and <a class="reference internal" href="#map"><tt class="docutils literal"><span class="pre">map</span></tt></a>; this is also used
to implement list comprehensions</dd>
</dl>
<a name="do"><dl class="docutils" id="do">
<dt><tt class="docutils literal"><span class="pre">do</span> <span class="pre">f</span> <span class="pre">xs</span></tt></dt>
<dd>apply <tt class="docutils literal"><span class="pre">f</span></tt> to all members of <tt class="docutils literal"><span class="pre">xs</span></tt>, like <a class="reference internal" href="#map"><tt class="docutils literal"><span class="pre">map</span></tt></a>, but throw away all
intermediate results and return <tt class="docutils literal"><span class="pre">()</span></tt></dd>
</dl>
<a name="drop"><dl class="docutils" id="drop">
<dt><tt class="docutils literal"><span class="pre">drop</span> <span class="pre">n</span> <span class="pre">xs</span></tt></dt>
<dd>remove <tt class="docutils literal"><span class="pre">n</span></tt> elements from the front of <tt class="docutils literal"><span class="pre">xs</span></tt></dd>
</dl>
<a name="dropwhile"><dl class="docutils" id="dropwhile">
<dt><tt class="docutils literal"><span class="pre">dropwhile</span> <span class="pre">p</span> <span class="pre">xs</span></tt></dt>
<dd>remove elements from the front of <tt class="docutils literal"><span class="pre">xs</span></tt> while the predicate <tt class="docutils literal"><span class="pre">p</span></tt> is
satisfied</dd>
</dl>
<a name="filter"><dl class="docutils" id="filter">
<dt><tt class="docutils literal"><span class="pre">filter</span> <span class="pre">p</span> <span class="pre">xs</span></tt></dt>
<dd>return the list of all members of <tt class="docutils literal"><span class="pre">xs</span></tt> satisfying the predicate <tt class="docutils literal"><span class="pre">p</span></tt></dd>
</dl>
<a name="foldl"><dl class="docutils" id="foldl">
<dt><tt class="docutils literal"><span class="pre">foldl</span> <span class="pre">f</span> <span class="pre">a</span> <span class="pre">xs</span></tt></dt>
<dd>accumulate the binary function <tt class="docutils literal"><span class="pre">f</span></tt> over all members of <tt class="docutils literal"><span class="pre">xs</span></tt>,
starting from the initial value <tt class="docutils literal"><span class="pre">a</span></tt> and working from the front of the
list towards its end</dd>
</dl>
<a name="foldl1"><dl class="docutils" id="foldl1">
<dt><tt class="docutils literal"><span class="pre">foldl1</span> <span class="pre">f</span> <span class="pre">xs</span></tt></dt>
<dd>accumulate the binary function <tt class="docutils literal"><span class="pre">f</span></tt> over all members of <tt class="docutils literal"><span class="pre">xs</span></tt>,
starting from the value <tt class="docutils literal"><span class="pre">head</span> <span class="pre">xs</span></tt> and working from the front of the
list towards its end; <tt class="docutils literal"><span class="pre">xs</span></tt> must be nonempty</dd>
</dl>
<a name="foldr"><dl class="docutils" id="foldr">
<dt><tt class="docutils literal"><span class="pre">foldr</span> <span class="pre">f</span> <span class="pre">a</span> <span class="pre">xs</span></tt></dt>
<dd>accumulate the binary function <tt class="docutils literal"><span class="pre">f</span></tt> over all members of <tt class="docutils literal"><span class="pre">xs</span></tt>,
starting from the initial value <tt class="docutils literal"><span class="pre">a</span></tt> and working from the end of the
list towards its front</dd>
</dl>
<a name="foldr1"><dl class="docutils" id="foldr1">
<dt><tt class="docutils literal"><span class="pre">foldr1</span> <span class="pre">f</span> <span class="pre">xs</span></tt></dt>
<dd>accumulate the binary function <tt class="docutils literal"><span class="pre">f</span></tt> over all members of <tt class="docutils literal"><span class="pre">xs</span></tt>,
starting from the value <tt class="docutils literal"><span class="pre">last</span> <span class="pre">xs</span></tt> and working from the end of the
list towards its front; <tt class="docutils literal"><span class="pre">xs</span></tt> must be nonempty</dd>
</dl>
<a name="head"><dl class="docutils" id="head">
<dt><tt class="docutils literal"><span class="pre">head</span> <span class="pre">xs</span></tt></dt>
<dd>return the first element of <tt class="docutils literal"><span class="pre">xs</span></tt>; <tt class="docutils literal"><span class="pre">xs</span></tt> must be nonempty</dd>
</dl>
<a name="index"><dl class="docutils" id="index">
<dt><tt class="docutils literal"><span class="pre">index</span> <span class="pre">xs</span> <span class="pre">x</span></tt></dt>
<dd><p class="first">search for an occurrence of <tt class="docutils literal"><span class="pre">x</span></tt> in <tt class="docutils literal"><span class="pre">xs</span></tt> and return the index of the
first occurrence, if any, <tt class="docutils literal"><span class="pre">-1</span></tt> otherwise</p>
<p class="last">Note: This uses equality (<tt class="docutils literal"><span class="pre">==</span></tt>) to decide whether a member of <tt class="docutils literal"><span class="pre">xs</span></tt> is
an occurrence of <tt class="docutils literal"><span class="pre">x</span></tt>, so <tt class="docutils literal"><span class="pre">==</span></tt> must have an appropriate definition on
the list members.</p>
</dd>
</dl>
<a name="init"><dl class="docutils" id="init">
<dt><tt class="docutils literal"><span class="pre">init</span> <span class="pre">xs</span></tt></dt>
<dd>return all but the last element of <tt class="docutils literal"><span class="pre">xs</span></tt>; <tt class="docutils literal"><span class="pre">xs</span></tt> must be nonempty</dd>
</dl>
<a name="last"><dl class="docutils" id="last">
<dt><tt class="docutils literal"><span class="pre">last</span> <span class="pre">xs</span></tt></dt>
<dd>return the last element of <tt class="docutils literal"><span class="pre">xs</span></tt>; <tt class="docutils literal"><span class="pre">xs</span></tt> must be nonempty</dd>
</dl>
<a name="listmap"><dl class="docutils" id="listmap">
<dt><tt class="docutils literal"><span class="pre">listmap</span> <span class="pre">f</span> <span class="pre">xs</span></tt></dt>
<dd>convenience function which works like <a class="reference internal" href="#map"><tt class="docutils literal"><span class="pre">map</span></tt></a>, but also deals with matrix
and string arguments while ensuring that the result is always a list;
this is primarily used to implement list comprehensions</dd>
</dl>
<a name="map"><dl class="docutils" id="map">
<dt><tt class="docutils literal"><span class="pre">map</span> <span class="pre">f</span> <span class="pre">xs</span></tt></dt>
<dd>apply <tt class="docutils literal"><span class="pre">f</span></tt> to each member of <tt class="docutils literal"><span class="pre">xs</span></tt></dd>
</dl>
<a name="scanl"><dl class="docutils" id="scanl">
<dt><tt class="docutils literal"><span class="pre">scanl</span> <span class="pre">f</span> <span class="pre">a</span> <span class="pre">xs</span></tt></dt>
<dd>accumulate the binary function <tt class="docutils literal"><span class="pre">f</span></tt> over all members of <tt class="docutils literal"><span class="pre">xs</span></tt>,
as with <tt class="docutils literal"><span class="pre">foldl</span></tt>, but return all intermediate results as a list</dd>
</dl>
<a name="scanl1"><dl class="docutils" id="scanl1">
<dt><tt class="docutils literal"><span class="pre">scanl1</span> <span class="pre">f</span> <span class="pre">xs</span></tt></dt>
<dd>accumulate the binary function <tt class="docutils literal"><span class="pre">f</span></tt> over all members of <tt class="docutils literal"><span class="pre">xs</span></tt>,
as with <tt class="docutils literal"><span class="pre">foldl1</span></tt>, but return all intermediate results as a list</dd>
</dl>
<a name="scanr"><dl class="docutils" id="scanr">
<dt><tt class="docutils literal"><span class="pre">scanr</span> <span class="pre">f</span> <span class="pre">a</span> <span class="pre">xs</span></tt></dt>
<dd>accumulate the binary function <tt class="docutils literal"><span class="pre">f</span></tt> over all members of <tt class="docutils literal"><span class="pre">xs</span></tt>,
as with <tt class="docutils literal"><span class="pre">foldr</span></tt>, but return all intermediate results as a list</dd>
</dl>
<a name="scanr1"><dl class="docutils" id="scanr1">
<dt><tt class="docutils literal"><span class="pre">scanr1</span> <span class="pre">f</span> <span class="pre">xs</span></tt></dt>
<dd>accumulate the binary function <tt class="docutils literal"><span class="pre">f</span></tt> over all members of <tt class="docutils literal"><span class="pre">xs</span></tt>,
as with <tt class="docutils literal"><span class="pre">foldr1</span></tt>, but return all intermediate results as a list</dd>
</dl>
<a name="sort (list)"><dl class="docutils" id="sort-list">
<dt><tt class="docutils literal"><span class="pre">sort</span> <span class="pre">p</span> <span class="pre">xs</span></tt></dt>
<dd>Sorts the elements of the list <tt class="docutils literal"><span class="pre">xs</span></tt> in ascending order according to the
given predicate <tt class="docutils literal"><span class="pre">p</span></tt>, using the C <tt class="docutils literal"><span class="pre">qsort</span></tt> function. The predicate
<tt class="docutils literal"><span class="pre">p</span></tt> is invoked with two arguments and should return a truth value
indicating whether the first argument is &quot;less than&quot; the second. (An
exception is raised if the result of a comparison is not a machine
integer.)</dd>
</dl>
<a name="tail"><dl class="docutils" id="tail">
<dt><tt class="docutils literal"><span class="pre">tail</span> <span class="pre">xs</span></tt></dt>
<dd>return all but the first element of <tt class="docutils literal"><span class="pre">xs</span></tt>; <tt class="docutils literal"><span class="pre">xs</span></tt> must be nonempty</dd>
</dl>
<a name="take"><dl class="docutils" id="take">
<dt><tt class="docutils literal"><span class="pre">take</span> <span class="pre">n</span> <span class="pre">xs</span></tt></dt>
<dd>take <tt class="docutils literal"><span class="pre">n</span></tt> elements from the front of <tt class="docutils literal"><span class="pre">xs</span></tt></dd>
</dl>
<a name="takewhile"><dl class="docutils" id="takewhile">
<dt><tt class="docutils literal"><span class="pre">takewhile</span> <span class="pre">p</span> <span class="pre">xs</span></tt></dt>
<dd>take elements from the front of <tt class="docutils literal"><span class="pre">xs</span></tt> while the predicate <tt class="docutils literal"><span class="pre">p</span></tt> is
satisfied</dd>
</dl>
<!--  -->
</div>
<div class="section" id="list-generators">
<h3><a class="toc-backref" href="#id76">1.3.2&nbsp;&nbsp;&nbsp;List Generators</a></h3>
<p>Some useful (infinite) list generators, as well as some finite (and eager)
variations of these. The latter work like a combination of <tt class="docutils literal"><span class="pre">take</span></tt> or
<tt class="docutils literal"><span class="pre">takewhile</span></tt> and the former, but are implemented directly for better
efficiency.</p>
<a name="cycle"><dl class="docutils" id="cycle">
<dt><tt class="docutils literal"><span class="pre">cycle</span> <span class="pre">xs</span></tt></dt>
<dd>cycles through the elements of the nonempty list <tt class="docutils literal"><span class="pre">xs</span></tt>, ad infinitum</dd>
</dl>
<a name="cyclen"><dl class="docutils" id="cyclen">
<dt><tt class="docutils literal"><span class="pre">cyclen</span> <span class="pre">n</span> <span class="pre">xs</span></tt></dt>
<dd>eager version of <tt class="docutils literal"><span class="pre">cycle</span></tt>, returns the first <tt class="docutils literal"><span class="pre">n</span></tt> elements of
<tt class="docutils literal"><span class="pre">cycle</span> <span class="pre">xs</span></tt></dd>
</dl>
<a name="iterate"><dl class="docutils" id="iterate">
<dt><tt class="docutils literal"><span class="pre">iterate</span> <span class="pre">f</span> <span class="pre">x</span></tt></dt>
<dd>returns the stream containing <tt class="docutils literal"><span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">f</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">f</span> <span class="pre">(f</span> <span class="pre">x)</span></tt>, etc.,
ad infinitum</dd>
</dl>
<a name="iteraten"><dl class="docutils" id="iteraten">
<dt><tt class="docutils literal"><span class="pre">iteraten</span> <span class="pre">n</span> <span class="pre">f</span> <span class="pre">x</span></tt></dt>
<dd>eager version of <tt class="docutils literal"><span class="pre">iterate</span></tt>, returns the first <tt class="docutils literal"><span class="pre">n</span></tt> elements of
<tt class="docutils literal"><span class="pre">iterate</span> <span class="pre">f</span> <span class="pre">x</span></tt></dd>
</dl>
<a name="iterwhile"><dl class="docutils" id="iterwhile">
<dt><tt class="docutils literal"><span class="pre">iterwhile</span> <span class="pre">p</span> <span class="pre">f</span> <span class="pre">x</span></tt></dt>
<dd>another eager version of <tt class="docutils literal"><span class="pre">iterate</span></tt>, returns the list of all elements
from the front of <tt class="docutils literal"><span class="pre">iterate</span> <span class="pre">f</span> <span class="pre">x</span></tt> for which the predicate <tt class="docutils literal"><span class="pre">p</span></tt> holds</dd>
</dl>
<a name="repeat"><dl class="docutils" id="repeat">
<dt><tt class="docutils literal"><span class="pre">repeat</span> <span class="pre">x</span></tt></dt>
<dd>returns an infinite stream of <tt class="docutils literal"><span class="pre">x</span></tt>s</dd>
</dl>
<a name="repeatn"><dl class="docutils" id="repeatn">
<dt><tt class="docutils literal"><span class="pre">repeatn</span> <span class="pre">n</span> <span class="pre">x</span></tt></dt>
<dd>eager version of <tt class="docutils literal"><span class="pre">repeat</span></tt>, returns a list with <tt class="docutils literal"><span class="pre">n</span></tt> <tt class="docutils literal"><span class="pre">x</span></tt>s</dd>
</dl>
<!--  -->
</div>
<div class="section" id="zip-and-friends">
<h3><a class="toc-backref" href="#id77">1.3.3&nbsp;&nbsp;&nbsp;Zip and Friends</a></h3>
<a name="unzip"><dl class="docutils" id="unzip">
<dt><tt class="docutils literal"><span class="pre">unzip</span> <span class="pre">xys</span></tt></dt>
<dd>takes a list of pairs to a pair of lists of corresponding elements</dd>
</dl>
<a name="unzip3"><dl class="docutils" id="unzip3">
<dt><tt class="docutils literal"><span class="pre">unzip3</span> <span class="pre">xyzs</span></tt></dt>
<dd><tt class="docutils literal"><span class="pre">unzip</span></tt> with triples</dd>
</dl>
<a name="zip"><dl class="docutils" id="zip">
<dt><tt class="docutils literal"><span class="pre">zip</span> <span class="pre">xs</span> <span class="pre">ys</span></tt></dt>
<dd>return the list of corresponding pairs <tt class="docutils literal"><span class="pre">(x,y)</span></tt> where <tt class="docutils literal"><span class="pre">x</span></tt> runs
through the elements of <tt class="docutils literal"><span class="pre">xs</span></tt> and <tt class="docutils literal"><span class="pre">y</span></tt> runs through the elements
of <tt class="docutils literal"><span class="pre">y</span></tt></dd>
</dl>
<a name="zip3"><dl class="docutils" id="zip3">
<dt><tt class="docutils literal"><span class="pre">zip3</span> <span class="pre">xs</span> <span class="pre">ys</span> <span class="pre">zs</span></tt></dt>
<dd><tt class="docutils literal"><span class="pre">zip</span></tt> with three lists, returns a list of triples</dd>
</dl>
<a name="zipwith"><dl class="docutils" id="zipwith">
<dt><tt class="docutils literal"><span class="pre">zipwith</span> <span class="pre">f</span> <span class="pre">xs</span> <span class="pre">ys</span></tt></dt>
<dd>apply the binary function <tt class="docutils literal"><span class="pre">f</span></tt> to corresponding elements of <tt class="docutils literal"><span class="pre">xs</span></tt>
and <tt class="docutils literal"><span class="pre">ys</span></tt></dd>
</dl>
<a name="zipwith3"><dl class="docutils" id="zipwith3">
<dt><tt class="docutils literal"><span class="pre">zipwith3</span> <span class="pre">f</span> <span class="pre">xs</span> <span class="pre">ys</span> <span class="pre">zs</span></tt></dt>
<dd>apply the ternary function <tt class="docutils literal"><span class="pre">f</span></tt> to corresponding elements of <tt class="docutils literal"><span class="pre">xs</span></tt>,
<tt class="docutils literal"><span class="pre">ys</span></tt> and <tt class="docutils literal"><span class="pre">zs</span></tt></dd>
</dl>
<p>Pure also has the following variations of <tt class="docutils literal"><span class="pre">zipwith</span></tt>/<tt class="docutils literal"><span class="pre">zipwith3</span></tt> which
throw away all intermediate results and return <tt class="docutils literal"><span class="pre">()</span></tt>. That is, these work
like <a class="reference internal" href="#do"><tt class="docutils literal"><span class="pre">do</span></tt></a> but pull arguments from two or three lists, respectively:</p>
<a name="dowith"><dl class="docutils" id="dowith">
<dt><tt class="docutils literal"><span class="pre">dowith</span> <span class="pre">f</span> <span class="pre">xs</span> <span class="pre">ys</span></tt></dt>
<dd>apply the binary function <tt class="docutils literal"><span class="pre">f</span></tt> to corresponding elements of <tt class="docutils literal"><span class="pre">xs</span></tt>
and <tt class="docutils literal"><span class="pre">ys</span></tt>, return <tt class="docutils literal"><span class="pre">()</span></tt></dd>
</dl>
<a name="dowith3"><dl class="docutils" id="dowith3">
<dt><tt class="docutils literal"><span class="pre">dowith3</span> <span class="pre">f</span> <span class="pre">xs</span> <span class="pre">ys</span> <span class="pre">zs</span></tt></dt>
<dd>apply the ternary function <tt class="docutils literal"><span class="pre">f</span></tt> to corresponding elements of <tt class="docutils literal"><span class="pre">xs</span></tt>,
<tt class="docutils literal"><span class="pre">ys</span></tt> and <tt class="docutils literal"><span class="pre">zs</span></tt>, return <tt class="docutils literal"><span class="pre">()</span></tt></dd>
</dl>
<!--  -->
</div>
</div>
<div class="section" id="string-functions">
<h2><a class="toc-backref" href="#id78">1.4&nbsp;&nbsp;&nbsp;String Functions</a></h2>
<a name="strings"><p id="strings">Pure strings are null-terminated character strings encoded in UTF-8, see
the <a class="reference external" href="pure.html">Pure Manual</a> for details. The prelude provides various operations on
strings, including a complete set of list-like operations, so that strings
can be used mostly as if they were lists, although they are really
implemented as C character arrays for reasons of efficiency. Pure also has
some powerful operations to convert between Pure expressions and their
string representation, see <a class="reference internal" href="#eval-and-friends">Eval and Friends</a> for those.</p>
<div class="section" id="basic-string-functions">
<h3><a class="toc-backref" href="#id79">1.4.1&nbsp;&nbsp;&nbsp;Basic String Functions</a></h3>
<a name="string concatenation"><a name="string indexing"><a name="string slicing"><a name="+ (string)"><a name="! (string)"><a name="!! (string)"><p id="id11"><span id="id10"></span><span id="string"></span><span id="string-slicing"></span><span id="string-indexing"></span><span id="string-concatenation"></span>Concatenation, indexing and slicing works just like with lists:</p>
<pre class="literal-block">
&gt; &quot;abc&quot;+&quot;xyz&quot;;
&quot;abcxyz&quot;
&gt; let s = &quot;The quick brown fox jumps over the lazy dog.&quot;;
&gt; s!5;
&quot;u&quot;
&gt; s!!(20..24);
&quot;jumps&quot;
</pre>
<a name="string size"><a name="null (string)"><a name="# (string)"><p id="id12"><span id="null-string"></span><span id="string-size"></span>Checking for empty strings and determining the size of a string also works
as expected:</p>
<pre class="literal-block">
&gt; null &quot;&quot;;
1
&gt; null s;
0
&gt; #s;
44
</pre>
<p>You can search for the location of a substring in a string, and extract a
substring of a given length:</p>
<a name="index (string)"><dl class="docutils" id="index-string">
<dt><tt class="docutils literal"><span class="pre">index</span> <span class="pre">s</span> <span class="pre">u</span></tt></dt>
<dd>Returns the (zero-based) index of the first occurrence of the substring
<tt class="docutils literal"><span class="pre">u</span></tt> in <tt class="docutils literal"><span class="pre">s</span></tt>, or -1 if <tt class="docutils literal"><span class="pre">u</span></tt> is not found in <tt class="docutils literal"><span class="pre">s</span></tt>.</dd>
</dl>
<a name="substr"><dl class="docutils" id="substr">
<dt><tt class="docutils literal"><span class="pre">substr</span> <span class="pre">s</span> <span class="pre">i</span> <span class="pre">n</span></tt></dt>
<dd>Extracts a substring of (at most) <tt class="docutils literal"><span class="pre">n</span></tt> characters at position <tt class="docutils literal"><span class="pre">i</span></tt> in
<tt class="docutils literal"><span class="pre">s</span></tt>. This takes care of all corner cases, adjusting index and number of
characters so that the index range stays confined to the source string.</dd>
</dl>
<p>Example:</p>
<pre class="literal-block">
&gt; index s &quot;jumps&quot;;
20
&gt; substr s 20 10;
&quot;jumps over&quot;
</pre>
<p>Note that Pure doesn't have a separate type for individual characters.
Instead, these are represented as strings <tt class="docutils literal"><span class="pre">c</span></tt> containing exactly one
(UTF-8) character (i.e., <tt class="docutils literal"><span class="pre">#c==1</span></tt>). It is possible to convert such single
character strings to the corresponding integer character codes, and vice
versa:</p>
<a name="ord"><dl class="docutils" id="ord">
<dt><tt class="docutils literal"><span class="pre">ord</span> <span class="pre">c</span></tt></dt>
<dd>Ordinal number of a single character string <tt class="docutils literal"><span class="pre">c</span></tt>. This is the
character's code point in the Unicode character set.</dd>
</dl>
<a name="chr"><dl class="docutils" id="chr">
<dt><tt class="docutils literal"><span class="pre">chr</span> <span class="pre">n</span></tt></dt>
<dd>Converts an integer back to the character with the corresponding code
point.</dd>
</dl>
<a name="character arithmetic"><p id="character-arithmetic">In addition, the usual character arithmetic works, including arithmetic
sequences of characters, so that you can write stuff like the following:</p>
<pre class="literal-block">
&gt; &quot;a&quot;-&quot;A&quot;;
32
&gt; &quot;u&quot;-32;
&quot;U&quot;
&gt; &quot;a&quot;..&quot;k&quot;;
[&quot;a&quot;,&quot;b&quot;,&quot;c&quot;,&quot;d&quot;,&quot;e&quot;,&quot;f&quot;,&quot;g&quot;,&quot;h&quot;,&quot;i&quot;,&quot;j&quot;,&quot;k&quot;]
</pre>
<p>Strings are also ordered lexicographically based on their character codes:</p>
<pre class="literal-block">
&gt; &quot;awe&quot;&gt;&quot;awesome&quot;;
0
&gt; &quot;foo&quot;&gt;=&quot;bar&quot;;
1
</pre>
<p>For convenience, the prelude provides the following functions to convert
between strings and lists (or other aggregates) of characters.</p>
<a name="chars"><a name="list (string)"><dl class="docutils" id="list-string">
<span id="chars"></span><dt><tt class="docutils literal"><span class="pre">chars</span> <span class="pre">s</span></tt>, <tt class="docutils literal"><span class="pre">list</span> <span class="pre">s</span></tt></dt>
<dd>Convert a string <tt class="docutils literal"><span class="pre">s</span></tt> to a list of characters.</dd>
</dl>
<a name="tuple (string)"><a name="matrix (string)"><dl class="docutils" id="matrix-string">
<span id="tuple-string"></span><dt><tt class="docutils literal"><span class="pre">tuple</span> <span class="pre">s</span></tt>, <tt class="docutils literal"><span class="pre">matrix</span> <span class="pre">s</span></tt></dt>
<dd>Convert a string <tt class="docutils literal"><span class="pre">s</span></tt> to a tuple or (symbolic) matrix of characters,
respectively.</dd>
</dl>
<a name="strcat"><dl class="docutils" id="strcat">
<dt><tt class="docutils literal"><span class="pre">strcat</span> <span class="pre">xs</span></tt></dt>
<dd>Concatenate a list <tt class="docutils literal"><span class="pre">xs</span></tt> of strings (in particular, this converts a
list of characters back to a string).</dd>
</dl>
<a name="string"><dl class="docutils" id="id13">
<dt><tt class="docutils literal"><span class="pre">string</span> <span class="pre">xs</span></tt></dt>
<dd>Convert a list, tuple or (symbolic) matrix of strings to a string.
In the case of a list, this is synonymous with <tt class="docutils literal"><span class="pre">strcat</span></tt>, but it also
works with the other types of aggregates.</dd>
</dl>
<p>For instance:</p>
<pre class="literal-block">
&gt; list &quot;abc&quot;;
[&quot;a&quot;,&quot;b&quot;,&quot;c&quot;]
&gt; string (&quot;a&quot;..&quot;z&quot;);
&quot;abcdefghijklmnopqrstuvwxyz&quot;
</pre>
<p>The following functions are provided to deal with strings of &quot;tokens&quot;
separated by a given delimiter string.</p>
<a name="split"><dl class="docutils" id="split">
<dt><tt class="docutils literal"><span class="pre">split</span> <span class="pre">delim</span> <span class="pre">s</span></tt></dt>
<dd>Splits <tt class="docutils literal"><span class="pre">s</span></tt> into a list of substrings delimited by <tt class="docutils literal"><span class="pre">delim</span></tt>.</dd>
</dl>
<a name="join"><dl class="docutils" id="join">
<dt><tt class="docutils literal"><span class="pre">join</span> <span class="pre">delim</span> <span class="pre">xs</span></tt></dt>
<dd>Joins the list of strings <tt class="docutils literal"><span class="pre">xs</span></tt> to a single string, interpolating the
given <tt class="docutils literal"><span class="pre">delim</span></tt> string.</dd>
</dl>
<p>Example:</p>
<pre class="literal-block">
&gt; let xs = split &quot; &quot; s; xs;
[&quot;The&quot;,&quot;quick&quot;,&quot;brown&quot;,&quot;fox&quot;,&quot;jumps&quot;,&quot;over&quot;,&quot;the&quot;,&quot;lazy&quot;,&quot;dog.&quot;]
&gt; join &quot;:&quot; xs;
&quot;The:quick:brown:fox:jumps:over:the:lazy:dog.&quot;
</pre>
<p>We mention in passing here that more elaborate string matching, splitting
and replacement operations based on regular expressions are provided by the
system module, see <a class="reference internal" href="#system-interface">System Interface</a>.</p>
<p>If that isn't enough already, most generic list operations carry over to
strings in the obvious way, treating the string like a list of characters.
(Some operations will actually return character lists in that case, so you
might have to apply <tt class="docutils literal"><span class="pre">string</span></tt> explicitly to convert these back to a
string.) For instance:</p>
<pre class="literal-block">
&gt; filter (&gt;=&quot;k&quot;) s;
&quot;qukrownoxumpsovrtlzyo&quot;
&gt; string $ map pred &quot;ibm&quot;;
&quot;hal&quot;
</pre>
<p>List comprehensions can draw values from strings, too:</p>
<pre class="literal-block">
&gt; string [x+1 | x=&quot;HAL&quot;];
&quot;IBM&quot;
</pre>
<!--  -->
</div>
<div class="section" id="low-level-operations">
<h3><a class="toc-backref" href="#id80">1.4.2&nbsp;&nbsp;&nbsp;Low-Level Operations</a></h3>
<p>The following routines are provided by the runtime to turn raw C <tt class="docutils literal"><span class="pre">char*</span></tt>
pointers (also called <strong class="dfn">byte strings</strong> in Pure parlance, to distinguish them
from Pure's &quot;cooked&quot; UTF-8 string values) into corresponding Pure
strings. Normally you don't have to worry about this, because the C
interface already takes care of the necessary marshalling, but in some
low-level code these operations are useful. Also note that here and in the
following, the <tt class="docutils literal"><span class="pre">cstring</span></tt> routines also convert the string between the
system encoding and Pure's internal UTF-8 representation.</p>
<a name="string (pointer)"><a name="cstring"><dl class="docutils" id="cstring">
<span id="string-pointer"></span><dt><tt class="docutils literal"><span class="pre">string</span> <span class="pre">s</span></tt>, <tt class="docutils literal"><span class="pre">cstring</span> <span class="pre">s</span></tt></dt>
<dd>Convert a pointer <tt class="docutils literal"><span class="pre">s</span></tt> to a Pure string. <tt class="docutils literal"><span class="pre">s</span></tt> must point to a
null-terminated C string. These routines take ownership of the original
string value, assuming it to be <tt class="docutils literal"><span class="pre">malloc</span></tt>ed, so you should only use
these for C strings which are specifically intended to be freed by the
user.</dd>
</dl>
<a name="string_dup"><a name="cstring_dup"><dl class="docutils" id="cstring-dup">
<span id="string-dup"></span><dt><tt class="docutils literal"><span class="pre">string_dup</span> <span class="pre">s</span></tt>, <tt class="docutils literal"><span class="pre">cstring_dup</span> <span class="pre">s</span></tt></dt>
<dd>Convert a pointer <tt class="docutils literal"><span class="pre">s</span></tt> to a Pure string. Like above, but these functions
take a copy of the string, leaving the original C string untouched.</dd>
</dl>
<!--  -->
<p>The reverse transformations are also provided. These take a Pure string to
a byte string (raw <tt class="docutils literal"><span class="pre">char*</span></tt>).</p>
<a name="byte_string"><a name="byte_cstring"><dl class="docutils" id="byte-cstring">
<span id="byte-string"></span><dt><tt class="docutils literal"><span class="pre">byte_string</span> <span class="pre">s</span></tt>, <tt class="docutils literal"><span class="pre">byte_cstring</span> <span class="pre">s</span></tt></dt>
<dd>Construct a byte string from a Pure string <tt class="docutils literal"><span class="pre">s</span></tt>. The result is a raw
pointer object pointing to the converted string. The original Pure string
is always copied (and, in the case of <tt class="docutils literal"><span class="pre">byte_cstring</span></tt>, converted to the
system encoding). The resulting byte string is a <tt class="docutils literal"><span class="pre">malloc</span></tt>ed pointer
which can be used like a C <tt class="docutils literal"><span class="pre">char*</span></tt>, and has to be freed explicitly by
the caller when no longer needed.</dd>
</dl>
<!--  -->
<p>Finally, it is also possible to convert Pure string lists to byte string
vectors and vice versa. These are useful if you need to pass an
<tt class="docutils literal"><span class="pre">argv</span></tt>-like string vector (i.e., a <tt class="docutils literal"><span class="pre">char**</span></tt> or <tt class="docutils literal"><span class="pre">char*[]</span></tt>) to C
routines. The computed C vectors are <tt class="docutils literal"><span class="pre">malloc</span></tt>ed pointers which have an
extra <tt class="docutils literal"><span class="pre">NULL</span></tt> pointer as the last entry, and should thus be usable for
almost any purpose which requires such a string vector in C. They also take
care of garbage-collecting themselves. The original string data is always
copied. As usual, the <tt class="docutils literal"><span class="pre">cstring</span></tt> variants do automatic conversions to the
system encoding.</p>
<a name="byte_string_pointer"><a name="byte_cstring_pointer"><dl class="docutils" id="byte-cstring-pointer">
<span id="byte-string-pointer"></span><dt><tt class="docutils literal"><span class="pre">byte_string_pointer</span> <span class="pre">xs</span></tt>, <tt class="docutils literal"><span class="pre">byte_cstring_pointer</span> <span class="pre">xs</span></tt></dt>
<dd>Convert a list of Pure strings to a C <tt class="docutils literal"><span class="pre">char**</span></tt>.</dd>
</dl>
<a name="string_list"><a name="cstring_list"><dl class="docutils" id="cstring-list">
<span id="string-list"></span><dt><tt class="docutils literal"><span class="pre">string_list</span> <span class="pre">n</span> <span class="pre">p</span></tt>, <tt class="docutils literal"><span class="pre">cstring_list</span> <span class="pre">n</span> <span class="pre">p</span></tt></dt>
<dd>Convert a C <tt class="docutils literal"><span class="pre">char**</span></tt> to a list of Pure strings.</dd>
</dl>
<p>Note that the back conversions take an additional first argument which
denotes the number of strings to retrieve. If you know that the vector is
<tt class="docutils literal"><span class="pre">NULL</span></tt>-terminated then this can also be an infinite value (<tt class="docutils literal"><span class="pre">inf</span></tt>) in
which case the number of elements will be figured out automatically.
Processing always stops at the first <tt class="docutils literal"><span class="pre">NULL</span></tt> pointer encountered.</p>
<!--  -->
</div>
</div>
<div class="section" id="matrix-functions">
<h2><a class="toc-backref" href="#id81">1.5&nbsp;&nbsp;&nbsp;Matrix Functions</a></h2>
<p>Most of the generic list operations are implemented on matrices as well,
see <a class="reference internal" href="#common-list-functions">Common List Functions</a>. Hence stuff like <tt class="docutils literal"><span class="pre">map</span></tt> and <tt class="docutils literal"><span class="pre">zipwith</span></tt>
works as expected:</p>
<pre class="literal-block">
&gt; map succ {1,2,3;4,5,6};
{2,3,4;5,6,7}
&gt; zipwith (+) {1,2,3;4,5,6} {1,0,1;0,2,0};
{2,2,4;4,7,6}
</pre>
<p>The matrix module also provides a bunch of other specialized matrix
operations, including all the necessary operations for matrix
comprehensions. We briefly summarize the most important operations below;
please refer to matrices.pure for all the gory details.</p>
<p>Also make sure you check <a class="reference external" href="pure.html#matrix-computations">Matrix Computations</a> in the Pure Manual for some
more examples, and the <a class="reference internal" href="#record-functions">Record Functions</a> section for an implementation of
records using symbolic vectors.</p>
<div class="section" id="matrix-dimension-and-indexing">
<h3><a class="toc-backref" href="#id82">1.5.1&nbsp;&nbsp;&nbsp;Matrix Dimension and Indexing</a></h3>
<a name="matrix size"><a name="matrix dimensions"><a name="# (matrix)"><a name="dim"><p id="dim"><span id="matrix"></span><span id="matrix-dimensions"></span><span id="matrix-size"></span>The size of a matrix (number of elements) can be obtained using <tt class="docutils literal"><span class="pre">#</span></tt>, and
the <tt class="docutils literal"><span class="pre">dim</span></tt> function can be used to return its dimensions (number of rows
and columns):</p>
<pre class="literal-block">
&gt; #{1,2,3;4,5,6};
6
&gt; dim {1,2,3;4,5,6};
2,3
</pre>
<a name="null (matrix)"><p id="null-matrix"><tt class="docutils literal"><span class="pre">null</span> <span class="pre">x</span></tt> can be used to check for empty matrices. Note that there are
various kinds of these, as a matrix may have zero rows or columns, or both.</p>
<a name="! (matrix)"><p id="id14">Indexing and slicing works pretty much like in MATLAB and Octave, except
that you use the Pure operators <tt class="docutils literal"><span class="pre">!</span></tt> and <tt class="docutils literal"><span class="pre">!!</span></tt> for that. It is possible
to access elements with a one-dimensional index (in row-major oder):</p>
<pre class="literal-block">
&gt; x!3;
4
</pre>
<p>Or you can specify a pair of row and column index:</p>
<pre class="literal-block">
&gt; x!(1,0);
4
</pre>
<a name="!! (matrix)"><p id="id15">Slicing works accordingly. You can either specify a list of (one- or
two-dimensional) indices, in which case the result is always a row vector:</p>
<pre class="literal-block">
&gt; x!!(2..5);
{3,4,5,6}
</pre>
<p>Or you can specify a pair of row and column index lists:</p>
<pre class="literal-block">
&gt; x!!(0..1,1..2);
{2,3;5,6}
</pre>
<p>The following abbreviations are provided to grab a slice from a row or
column:</p>
<pre class="literal-block">
&gt; x!!(1,1..2);
{5,6}
&gt; x!!(0..1,1);
{2;5}
</pre>
</div>
<div class="section" id="matrix-inspection-and-manipulation">
<h3><a class="toc-backref" href="#id83">1.5.2&nbsp;&nbsp;&nbsp;Matrix Inspection and Manipulation</a></h3>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">dmatrixp</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">cmatrixp</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">imatrixp</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">smatrixp</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">nmatrixp</span> <span class="pre">x</span></tt></dt>
<dd>Check for different kinds of matrices (double, complex, int, symbolic and
numeric, i.e., non-symbolic).</dd>
<dt><tt class="docutils literal"><span class="pre">vectorp</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">rowvectorp</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">colvectorp</span> <span class="pre">x</span></tt></dt>
<dd>Check for different kinds of vectors (these are just matrices with one
row or column).</dd>
</dl>
<a name="stride"><dl class="docutils" id="stride">
<dt><tt class="docutils literal"><span class="pre">stride</span> <span class="pre">x</span></tt></dt>
<dd>The stride of a matrix denotes the real row size of the underlying C
array, see the description of the <a class="reference internal" href="#pack"><tt class="docutils literal"><span class="pre">pack</span></tt></a> function below for further
details. There's little use for this value in Pure, but it may be needed
when interfacing to C.</dd>
</dl>
<a name="row"><a name="col"><dl class="docutils" id="col">
<span id="row"></span><dt><tt class="docutils literal"><span class="pre">row</span> <span class="pre">x</span> <span class="pre">i</span></tt>, <tt class="docutils literal"><span class="pre">col</span> <span class="pre">x</span> <span class="pre">i</span></tt></dt>
<dd>Extract the <tt class="docutils literal"><span class="pre">i</span></tt>th row or column of a matrix.</dd>
</dl>
<a name="rows"><a name="cols"><dl class="docutils" id="cols">
<span id="rows"></span><dt><tt class="docutils literal"><span class="pre">rows</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">cols</span> <span class="pre">x</span></tt></dt>
<dd>Return the list of all rows or columns of a matrix.</dd>
</dl>
<a name="list (matrix)"><a name="list2 (matrix)"><a name="tuple (matrix)"><a name="matrix"><dl class="docutils" id="id16">
<span id="tuple-matrix"></span><span id="list2-matrix"></span><span id="list-matrix"></span><dt><tt class="docutils literal"><span class="pre">list</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">list2</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">tuple</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">matrix</span> <span class="pre">xs</span></tt></dt>
<dd><p class="first">Convert a matrix to a list or tuple, and vice versa. <tt class="docutils literal"><span class="pre">list</span> <span class="pre">x</span></tt> converts
a matrix <tt class="docutils literal"><span class="pre">x</span></tt> to a flat list of its elements, while <tt class="docutils literal"><span class="pre">list2</span></tt> converts
it to a list of lists. Likewise, <tt class="docutils literal"><span class="pre">tuple</span> <span class="pre">x</span></tt> converts the matrix <tt class="docutils literal"><span class="pre">x</span></tt> to
a tuple. Conversely, <tt class="docutils literal"><span class="pre">matrix</span> <span class="pre">xs</span></tt> converts a list or tuple to a
corresponding matrix.</p>
<p class="last">Note that <tt class="docutils literal"><span class="pre">matrix</span></tt> turns a list of lists or matrices specifying the
rows of the matrix to the corresponding rectangular matrix; otherwise,
the result is a row vector. Also note that the matrix function may throw
a <tt class="docutils literal"><span class="pre">bad_matrix_value</span> <span class="pre">x</span></tt> in case of dimension mismatch, where <tt class="docutils literal"><span class="pre">x</span></tt>
denotes the offending submatrix.</p>
</dd>
</dl>
<a name="diag"><a name="subdiag"><a name="supdiag"><dl class="docutils" id="supdiag">
<span id="subdiag"></span><span id="diag"></span><dt><tt class="docutils literal"><span class="pre">diag</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">subdiag</span> <span class="pre">x</span> <span class="pre">k</span></tt>, <tt class="docutils literal"><span class="pre">supdiag</span> <span class="pre">x</span> <span class="pre">k</span></tt>:</dt>
<dd>Extract (sub-,super-) diagonals from a matrix. Sub- and super-diagonals
for <tt class="docutils literal"><span class="pre">k=0</span></tt> return the main diagonal. Indices for sub- and
super-diagonals can also be negative, in which case the corresponding
super- or sub-diagonal is returned instead. In each case the result is a
row vector.</dd>
</dl>
<a name="submat"><dl class="docutils" id="submat">
<dt><tt class="docutils literal"><span class="pre">submat</span> <span class="pre">x</span> <span class="pre">(i,j)</span> <span class="pre">(n,m)</span></tt></dt>
<dd>Extract a submatrix of a given size at a given offset. The result shares
the underlying storage with the input matrix (i.e., matrix elements are
<em>not</em> copied) and so this is a comparatively cheap operation.</dd>
</dl>
<a name="rowcat"><a name="colcat"><dl class="docutils" id="colcat">
<span id="rowcat"></span><dt><tt class="docutils literal"><span class="pre">rowcat</span> <span class="pre">xs</span></tt>, <tt class="docutils literal"><span class="pre">colcat</span> <span class="pre">xs</span></tt></dt>
<dd>Construct matrices from lists of rows and columns. These take either
scalars or submatrices as inputs; corresponding dimensions must match.
<tt class="docutils literal"><span class="pre">rowcat</span></tt> combines submatrices vertically, like <tt class="docutils literal"><span class="pre">{x;y}</span></tt>; <tt class="docutils literal"><span class="pre">colcat</span></tt>
combines them horizontally, like <tt class="docutils literal"><span class="pre">{x,y}</span></tt>. Note: Like the built-in
matrix constructs, these operations may throw a <tt class="docutils literal"><span class="pre">bad_matrix_value</span> <span class="pre">x</span></tt>
exception in case of dimension mismatch, where <tt class="docutils literal"><span class="pre">x</span></tt> denotes the
offending submatrix.</dd>
</dl>
<a name="matcat"><dl class="docutils" id="matcat">
<dt><tt class="docutils literal"><span class="pre">matcat</span> <span class="pre">xs</span></tt></dt>
<dd>Construct a matrix from a (symbolic) matrix of other matrices and/or
scalars. This works like a combination of <tt class="docutils literal"><span class="pre">rowcat</span></tt> and <tt class="docutils literal"><span class="pre">colcat</span></tt>, but
draws its input from a matrix instead of a list of matrices, and
preserves the overall layout of the &quot;host&quot; matrix. The net effect is that
the host matrix is flattened out. If all elements of the input matrix are
scalars already, the input matrix is returned unchanged.</dd>
</dl>
<a name="rowcatmap"><a name="colcatmap"><span class="target" id="colcatmap"><span id="rowcatmap"></span></span><dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">rowcatmap</span> <span class="pre">f</span> <span class="pre">xs</span></tt>, <tt class="docutils literal"><span class="pre">colcatmap</span> <span class="pre">f</span> <span class="pre">xs</span></tt></dt>
<dd>Combinations of <a class="reference internal" href="#rowcat"><tt class="docutils literal"><span class="pre">rowcat</span></tt></a>, <a class="reference internal" href="#colcat"><tt class="docutils literal"><span class="pre">colcat</span></tt></a> and <a class="reference internal" href="#map"><tt class="docutils literal"><span class="pre">map</span></tt></a>. These are used, in
particular, for implementing matrix comprehensions.</dd>
</dl>
<!--  -->
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">dmatrix</span> <span class="pre">(n,m)</span></tt>, <tt class="docutils literal"><span class="pre">cmatrix</span> <span class="pre">(n,m)</span></tt>, <tt class="docutils literal"><span class="pre">imatrix</span> <span class="pre">(n,m)</span></tt></dt>
<dd>Convenience functions to create zero matrices with the given dimensions
(either a pair denoting the number of rows and columns, or just the row
size in order to create a row vector).</dd>
</dl>
<a name="diagmat"><a name="subdiagmat"><a name="supdiagmat"><dl class="docutils" id="supdiagmat">
<span id="subdiagmat"></span><span id="diagmat"></span><dt><tt class="docutils literal"><span class="pre">diagmat</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">subdiagmat</span> <span class="pre">x</span> <span class="pre">k</span></tt>, <tt class="docutils literal"><span class="pre">supdiagmat</span> <span class="pre">x</span> <span class="pre">k</span></tt></dt>
<dd>Create a (sub-,super-) diagonal matrix from a row vector <tt class="docutils literal"><span class="pre">x</span></tt> of size
<tt class="docutils literal"><span class="pre">n</span></tt>. The result is always a square matrix with dimension <tt class="docutils literal"><span class="pre">(n+k,n+k)</span></tt>,
which is of the same matrix type (double, complex, int, symbolic) as the
input and has the elements of the vector on its <tt class="docutils literal"><span class="pre">k</span></tt>th sub- or
super-diagonal, with all other elements zero. A negative value for <tt class="docutils literal"><span class="pre">k</span></tt>
turns a sub- into a super-diagonal matrix and vice versa.</dd>
</dl>
<a name="dmatrix"><a name="cmatrix"><a name="imatrix"><a name="smatrix"><span class="target" id="smatrix"><span id="imatrix"></span><span id="cmatrix"></span><span id="dmatrix"></span></span><dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">dmatrix</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">cmatrix</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">imatrix</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">smatrix</span> <span class="pre">x</span></tt></dt>
<dd>Matrix conversions. These convert between different types of numeric and
symbolic matrices. The same operations also convert a list directly to a
row vector; this is usually much faster than the generic <a class="reference internal" href="#id16"><tt class="docutils literal"><span class="pre">matrix</span></tt></a>
operation, but requires that the elements already are of the appropriate
type.</dd>
</dl>
<a name="re (matrix)"><a name="im (matrix)"><a name="conj (matrix)"><dl class="docutils" id="conj-matrix">
<span id="im-matrix"></span><span id="re-matrix"></span><dt><tt class="docutils literal"><span class="pre">re</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">im</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">conj</span> <span class="pre">x</span></tt></dt>
<dd>Extract the real and imaginary parts and compute the conjugate of a
numeric matrix.</dd>
</dl>
<a name="pack"><a name="packed"><span class="target" id="packed"><span id="pack"></span></span><dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">pack</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">packed</span> <span class="pre">x</span></tt></dt>
<dd><p class="first">Pack a matrix. This creates a copy of the matrix which has the data in
contiguous storage. It also frees up extra memory if the matrix was
created as a slice from a bigger matrix (see <a class="reference internal" href="#submat"><tt class="docutils literal"><span class="pre">submat</span></tt></a> above) which has
since gone the way of the dodo.</p>
<p class="last">The <tt class="docutils literal"><span class="pre">packed</span></tt> predicate can be used to verify whether a matrix is
already packed. Note that even if a matrix is already packed, <tt class="docutils literal"><span class="pre">pack</span></tt>
will make a copy of it anyway, so <tt class="docutils literal"><span class="pre">pack</span></tt> also provides a quick way
to copy a matrix, e.g., if you want to pass it as an input/output
parameter to a GSL routine.</p>
</dd>
</dl>
<a name="redim"><dl class="docutils" id="redim">
<dt><tt class="docutils literal"><span class="pre">redim</span> <span class="pre">(n,m)</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">redim</span> <span class="pre">n</span> <span class="pre">x</span></tt></dt>
<dd><p class="first">Change the dimensions of a matrix without changing its size. The total
number of elements must match that of the input matrix. Reuses the
underlying storage of the input matrix if possible (i.e., if the matrix
is <a class="reference internal" href="#packed"><tt class="docutils literal"><span class="pre">packed</span></tt></a>).</p>
<p class="last">You can also redim a matrix to a given row size <tt class="docutils literal"><span class="pre">n</span></tt>. In this case the
row size must divide the total size of the matrix.</p>
</dd>
</dl>
<a name="rowvector"><a name="colvector"><dl class="docutils" id="colvector">
<span id="rowvector"></span><dt><tt class="docutils literal"><span class="pre">rowvector</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">colvector</span> <span class="pre">x</span></tt></dt>
<dd>Convenience functions to convert a matrix to a row or column vector.</dd>
</dl>
<a name="sort (matrix)"><dl class="docutils" id="sort-matrix">
<dt><tt class="docutils literal"><span class="pre">sort</span> <span class="pre">p</span> <span class="pre">x</span></tt></dt>
<dd><p class="first">Sorts the elements of a matrix (non-destructively, i.e., without changing
the original matrix) according to the given predicate, using the C
<tt class="docutils literal"><span class="pre">qsort</span></tt> function. This works exactly the same as with lists (see
<a class="reference internal" href="#common-list-functions">Common List Functions</a>), except that it takes and returns a matrix
instead of a list. Note that the function sorts <em>all</em> elements of the
matrix in one go (regardless of the dimensions), as if the matrix was a
single big vector. The result matrix has the same dimensions as the input
matrix. Example:</p>
<pre class="literal-block">
&gt; sort (&lt;) {10,9;8,7;6,5};
{5,6;7,8;9,10}
</pre>
<p>If you'd like to sort the individual rows instead, you can do that as
follows:</p>
<pre class="literal-block">
&gt; sort_rows p = rowcat . map (sort p) . rows;
&gt; sort_rows (&lt;) {10,9;8,7;6,5};
{9,10;7,8;5,6}
</pre>
<p>Likewise, to sort the columns of a matrix:</p>
<pre class="literal-block">
&gt; sort_cols p = colcat . map (sort p) . cols;
&gt; sort_cols (&lt;) {10,9;8,7;6,5};
{6,5;8,7;10,9}
</pre>
<p class="last">Also note that the pure-gsl module provides an interface to the GSL
routines for sorting numeric (int and double) vectors using the standard
order. These will usually be much faster than <tt class="docutils literal"><span class="pre">sort</span></tt>, whereas <tt class="docutils literal"><span class="pre">sort</span></tt>
is more flexible in that it also allows you to sort symbolic matrices and
to choose the order predicate.</p>
</dd>
</dl>
<a name="transpose (matrix)"><dl class="docutils" id="transpose-matrix">
<dt><tt class="docutils literal"><span class="pre">transpose</span> <span class="pre">x</span></tt></dt>
<dd><p class="first">Transpose a matrix. Example:</p>
<pre class="last literal-block">
&gt; transpose {1,2,3;4,5,6};
{1,4;2,5;3,6}
</pre>
</dd>
</dl>
<a name="rowrev"><a name="colrev"><a name="reverse (matrix)"><dl class="docutils" id="reverse-matrix">
<span id="colrev"></span><span id="rowrev"></span><dt><tt class="docutils literal"><span class="pre">rowrev</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">colrev</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">reverse</span> <span class="pre">x</span></tt></dt>
<dd>Reverse a matrix. <tt class="docutils literal"><span class="pre">rowrev</span></tt> reverses the rows, <tt class="docutils literal"><span class="pre">colrev</span></tt> the columns,
<tt class="docutils literal"><span class="pre">reverse</span></tt> both dimensions.</dd>
</dl>
<!--  -->
</div>
<div class="section" id="pointers-and-matrices">
<h3><a class="toc-backref" href="#id84">1.5.3&nbsp;&nbsp;&nbsp;Pointers and Matrices</a></h3>
<p>The matrix module offers a bunch of low-level operations for converting
between matrices and raw pointers. These are typically used to shovel
around massive amounts of numeric data between Pure and external C
routines, when performance and throughput is an important consideration
(e.g., graphics, video and audio applications). The usual caveats apply.</p>
<a name="pointer (matrix)"><dl class="docutils" id="pointer-matrix">
<dt><tt class="docutils literal"><span class="pre">pointer</span> <span class="pre">x</span></tt></dt>
<dd>Get a pointer to the underlying C array of a matrix. The data is <em>not</em>
copied. Hence you have to be careful when passing such a pointer to C
functions if the underlying data is non-contiguous; when in doubt, first
use the <a class="reference internal" href="#pack"><tt class="docutils literal"><span class="pre">pack</span></tt></a> function to place the data in contiguous storage, or use
one of the matrix-pointer conversion routines below.</dd>
</dl>
<a name="double_pointer"><a name="float_pointer"><a name="complex_pointer"><a name="complex_float_pointer"><a name="int_pointer"><a name="short_pointer"><a name="byte_pointer"><p id="byte-pointer"><span id="short-pointer"></span><span id="int-pointer"></span><span id="complex-float-pointer"></span><span id="complex-pointer"></span><span id="float-pointer"></span><span id="double-pointer"></span>The following operations copy the contents of a matrix to a given pointer
and return that pointer, converting to the target data type on the fly if
necessary. The given pointer may also be <tt class="docutils literal"><span class="pre">NULL</span></tt>, in which case suitable
memory is malloced and returned; otherwise the caller must ensure that the
memory pointed to by <tt class="docutils literal"><span class="pre">p</span></tt> is big enough for the contents of the given
matrix.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">double_pointer</span> <span class="pre">p</span> <span class="pre">x</span></tt></li>
<li><tt class="docutils literal"><span class="pre">float_pointer</span> <span class="pre">p</span> <span class="pre">x</span></tt></li>
<li><tt class="docutils literal"><span class="pre">complex_pointer</span> <span class="pre">p</span> <span class="pre">x</span></tt></li>
<li><tt class="docutils literal"><span class="pre">complex_float_pointer</span> <span class="pre">p</span> <span class="pre">x</span></tt></li>
<li><tt class="docutils literal"><span class="pre">int_pointer</span> <span class="pre">p</span> <span class="pre">x</span></tt></li>
<li><tt class="docutils literal"><span class="pre">short_pointer</span> <span class="pre">p</span> <span class="pre">x</span></tt></li>
<li><tt class="docutils literal"><span class="pre">byte_pointer</span> <span class="pre">p</span> <span class="pre">x</span></tt></li>
</ul>
<a name="double_matrix"><a name="float_matrix"><a name="complex_matrix"><a name="complex_float_matrix"><a name="int_matrix"><a name="short_matrix"><a name="byte_matrix"><p id="byte-matrix"><span id="short-matrix"></span><span id="int-matrix"></span><span id="complex-float-matrix"></span><span id="complex-matrix"></span><span id="float-matrix"></span><span id="double-matrix"></span>Conversely, the following functions allow you to create a numeric matrix
from a pointer, copying the data and converting it from the source type on
the fly if necessary. The source pointer <tt class="docutils literal"><span class="pre">p</span></tt> may also be <tt class="docutils literal"><span class="pre">NULL</span></tt>, in
which case the new matrix is filled with zeros instead.  Otherwise the
caller must ensure that the pointer points to properly initialized memory
big enough for the requested dimensions. The given dimension may also be
just an integer <tt class="docutils literal"><span class="pre">n</span></tt> if a row vector is to be created.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">double_matrix</span> <span class="pre">(n,m)</span> <span class="pre">p</span></tt></li>
<li><tt class="docutils literal"><span class="pre">float_matrix</span> <span class="pre">(n,m)</span> <span class="pre">p</span></tt></li>
<li><tt class="docutils literal"><span class="pre">complex_matrix</span> <span class="pre">(n,m)</span> <span class="pre">p</span></tt></li>
<li><tt class="docutils literal"><span class="pre">complex_float_matrix</span> <span class="pre">(n,m)</span> <span class="pre">p</span></tt></li>
<li><tt class="docutils literal"><span class="pre">int_matrix</span> <span class="pre">(n,m)</span> <span class="pre">p</span></tt></li>
<li><tt class="docutils literal"><span class="pre">short_matrix</span> <span class="pre">(n,m)</span> <span class="pre">p</span></tt></li>
<li><tt class="docutils literal"><span class="pre">byte_matrix</span> <span class="pre">(n,m)</span> <span class="pre">p</span></tt></li>
</ul>
<a name="double_matrix_view"><a name="complex_matrix_view"><a name="int_matrix_view"><p id="int-matrix-view"><span id="complex-matrix-view"></span><span id="double-matrix-view"></span>Finally, you can use the following operations to create a numeric matrix
view of existing data, without copying the data. The data must be double,
complex or int, the pointer must not be <tt class="docutils literal"><span class="pre">NULL</span></tt> and the caller must also
ensure that the memory persists for the entire lifetime of the matrix
object. The given dimension may also be just an integer <tt class="docutils literal"><span class="pre">n</span></tt> if a row
vector view is to be created.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">double_matrix_view</span> <span class="pre">(n,m)</span> <span class="pre">p</span></tt></li>
<li><tt class="docutils literal"><span class="pre">complex_matrix_view</span> <span class="pre">(n,m)</span> <span class="pre">p</span></tt></li>
<li><tt class="docutils literal"><span class="pre">int_matrix_view</span> <span class="pre">(n,m)</span> <span class="pre">p</span></tt></li>
</ul>
<!--  -->
</div>
</div>
<div class="section" id="record-functions">
<h2><a class="toc-backref" href="#id85">1.6&nbsp;&nbsp;&nbsp;Record Functions</a></h2>
<p>As of Pure 0.41, the prelude also provides a basic record data structure,
implemented as symbolic vectors of <tt class="docutils literal"><span class="pre">key=&gt;value</span></tt> pairs which support a few
dictionary-like operations such as <tt class="docutils literal"><span class="pre">member</span></tt>, <tt class="docutils literal"><span class="pre">insert</span></tt> and indexing.
Records may be represented as row, column or empty vectors (i.e., the
number of rows or columns must be zero or one). They must be symbolic
matrices consisting only of &quot;hash pairs&quot; <tt class="docutils literal"><span class="pre">key=&gt;value</span></tt>, where the keys can
be either symbols or strings. The values can be any kind of Pure data; in
particular, they may themselves be records, so records can be nested.</p>
<p>The following operations are provided. Please note that all updates of
record members are non-destructive and thus involve copying, which might be
slow for large record values; if this is a problem then you should use
dictionaries instead (cf. <a class="reference internal" href="#dictionaries">Dictionaries</a>). Or you can create mutable records
by using expression references (cf. <a class="reference internal" href="#expression-references">Expression References</a>) as values,
which allow you to modify the data in-place.</p>
<p>Also note that records with duplicate keys are permitted; in such a case
the following operations will always operate on the <em>last</em> entry for a
given key.</p>
<!-- recordp: -->
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">recordp</span> <span class="pre">x</span></tt></dt>
<dd>Check for record values.</dd>
</dl>
<!-- record: -->
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">record</span> <span class="pre">x</span></tt></dt>
<dd>Normalizes a record. This removes duplicate keys and orders the record by
keys (using an apparently random but well-defined order of the key
values), so that normalized records are syntactically equal (<tt class="docutils literal"><span class="pre">===</span></tt>) if
and only if they contain the same hash pairs. For convenience, this
function can also be used directly on lists and tuples of hash pairs to
convert them to a normalized record value.</dd>
</dl>
<a name="# (record)"><dl class="docutils" id="record">
<dt><tt class="docutils literal"><span class="pre">#x</span></tt></dt>
<dd>The size of a record (number of entries it contains). Duplicate entries
are counted. (This is in fact just the standard matrix size operation.)</dd>
</dl>
<a name="member (record)"><dl class="docutils" id="member-record">
<dt><tt class="docutils literal"><span class="pre">member</span> <span class="pre">x</span> <span class="pre">y</span></tt></dt>
<dd>Check whether <tt class="docutils literal"><span class="pre">x</span></tt> contains the key <tt class="docutils literal"><span class="pre">y</span></tt>.</dd>
</dl>
<a name="! (record)"><dl class="docutils" id="id17">
<dt><tt class="docutils literal"><span class="pre">x!y</span></tt></dt>
<dd>Retrieves the (last) value associated with the key <tt class="docutils literal"><span class="pre">y</span></tt> in <tt class="docutils literal"><span class="pre">x</span></tt>, if
any, otherwise throws an <tt class="docutils literal"><span class="pre">out_of_bound</span></tt> exception.</dd>
</dl>
<a name="!! (record)"><dl class="docutils" id="id18">
<dt><tt class="docutils literal"><span class="pre">x!!ys</span></tt></dt>
<dd>Slicing also works as expected, by virtue of the generic definition of
slicing provided by the matrix data structure.</dd>
</dl>
<a name="insert (record)"><a name="update (record)"><dl class="docutils" id="update-record">
<span id="insert-record"></span><dt><tt class="docutils literal"><span class="pre">insert</span> <span class="pre">x</span> <span class="pre">(y=&gt;z)</span></tt>, <tt class="docutils literal"><span class="pre">update</span> <span class="pre">x</span> <span class="pre">y</span> <span class="pre">z</span></tt></dt>
<dd>Associate the key <tt class="docutils literal"><span class="pre">y</span></tt> with the value <tt class="docutils literal"><span class="pre">z</span></tt> in <tt class="docutils literal"><span class="pre">x</span></tt>. If <tt class="docutils literal"><span class="pre">x</span></tt> already
contains the key <tt class="docutils literal"><span class="pre">y</span></tt> then the corresponding value is updated (the last
such value if <tt class="docutils literal"><span class="pre">x</span></tt> contains more than one association for <tt class="docutils literal"><span class="pre">y</span></tt>),
otherwise a new member is inserted at the end of the record.</dd>
</dl>
<a name="delete (record)"><dl class="docutils" id="delete-record">
<dt><tt class="docutils literal"><span class="pre">delete</span> <span class="pre">x</span> <span class="pre">y</span></tt></dt>
<dd>Delete the key <tt class="docutils literal"><span class="pre">y</span></tt> (and its associated value) from <tt class="docutils literal"><span class="pre">x</span></tt>. If <tt class="docutils literal"><span class="pre">x</span></tt>
contains more than one entry for <tt class="docutils literal"><span class="pre">y</span></tt> then the last such entry is
removed.</dd>
</dl>
<p>Here are a few basic examples:</p>
<pre class="literal-block">
&gt; let r = {x=&gt;5, y=&gt;12};
&gt; r!y; r!![y,x];              // indexing and slicing
12
{12,5}
&gt; keys r; vals r;             // keys and values of a record
{x,y}
{5,12}
&gt; insert r (x=&gt;99);           // update an existing entry
{x=&gt;99,y=&gt;12}
&gt; insert ans (z=&gt;77);         // add a new entry
{x=&gt;99,y=&gt;12,z=&gt;77}
&gt; delete ans z;               // delete an existing entry
{x=&gt;99,y=&gt;12}
&gt; let r = {r,x=&gt;7,z=&gt;3}; r;   // duplicate key x
{x=&gt;5,y=&gt;12,x=&gt;7,z=&gt;3}
&gt; r!x, r!z;                   // indexing returns the last value of x
7,3
&gt; delete r x;                 // delete removes the last entry for x
{x=&gt;5,y=&gt;12,z=&gt;3}
&gt; record r;                   // normalize (remove dups and sort)
{x=&gt;7,y=&gt;12,z=&gt;3}
&gt; record [x=&gt;5, x=&gt;7, y=&gt;12]; // construct a normalized record from a list
{x=&gt;7,y=&gt;12}
&gt; record (x=&gt;5, x=&gt;7, y=&gt;12); // ... or a tuple
{x=&gt;7,y=&gt;12}
</pre>
<p>More examples can be found in the <a class="reference external" href="pure.html#record-data">Record Data</a> section in the Pure
Manual.</p>
<!--  -->
</div>
<div class="section" id="primitives">
<h2><a class="toc-backref" href="#id86">1.7&nbsp;&nbsp;&nbsp;Primitives</a></h2>
<p>This prelude module is a collection of various lowlevel operations, which
are implemented either directly by machine instructions or by C functions
provided in the runtime. In particular, this module defines the basic
arithmetic and logic operations on machine integers, bigints and floating
point numbers, as well as various type checking predicates and conversions
between different types. Some low-level pointer operations are also
provided, as well as &quot;sentries&quot; (Pure's flavour of object finalizers) and
&quot;references&quot; (mutable expression pointers).</p>
<div class="section" id="arithmetic">
<h3><a class="toc-backref" href="#id87">1.7.1&nbsp;&nbsp;&nbsp;Arithmetic</a></h3>
<p>The basic arithmetic and logic operations provided by this module are
summarized in the following table:</p>
<a name="+"><a name="-"><a name="*"><a name="/"><a name="div"><a name="mod"><a name="^"><a name="=="><a name="~="><a name="<"><a name=">"><a name="<="><a name=">="><a name="~"><a name="&&"><a name="||"><a name="not"><a name="and"><a name="or"><a name="<<"><a name=">>"><table border="1" class="docutils" id="id34">
<span id="id33"></span><span id="or"></span><span id="and"></span><span id="not"></span><span id="id32"></span><span id="id31"></span><span id="id30"></span><span id="id29"></span><span id="id28"></span><span id="id27"></span><span id="id26"></span><span id="id25"></span><span id="id24"></span><span id="id23"></span><span id="mod"></span><span id="div"></span><span id="id22"></span><span id="id21"></span><span id="id20"></span><span id="id19"></span><colgroup>
<col width="16%" />
<col width="22%" />
<col width="61%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Kind</th>
<th class="head">Operator</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>Arithmetic</td>
<td><tt class="docutils literal"><span class="pre">+</span></tt> <tt class="docutils literal"><span class="pre">-</span></tt>
<tt class="docutils literal"><span class="pre">*</span></tt> <tt class="docutils literal"><span class="pre">/</span></tt>
<tt class="docutils literal"><span class="pre">div</span></tt> <tt class="docutils literal"><span class="pre">mod</span></tt>
<tt class="docutils literal"><span class="pre">^</span></tt></td>
<td>addition, subtraction (also unary minus),
multiplication, division (inexact),
exact int/bigint division/modulus,
exponentiation (inexact)</td>
</tr>
<tr><td>Comparisons</td>
<td><tt class="docutils literal"><span class="pre">==</span></tt> <tt class="docutils literal"><span class="pre">~=</span></tt>
<tt class="docutils literal"><span class="pre">&lt;</span></tt> <tt class="docutils literal"><span class="pre">&gt;</span></tt>
<tt class="docutils literal"><span class="pre">&lt;=</span></tt> <tt class="docutils literal"><span class="pre">&gt;=</span></tt></td>
<td>equality, inequality,
less than, greater than,
less than or equal, greater than or equal</td>
</tr>
<tr><td>Logic</td>
<td><tt class="docutils literal"><span class="pre">~</span></tt>
<tt class="docutils literal"><span class="pre">&amp;&amp;</span></tt> <tt class="docutils literal"><span class="pre">||</span></tt></td>
<td>logical not,
and, or (short-circuit)</td>
</tr>
<tr><td>Bitwise</td>
<td><tt class="docutils literal"><span class="pre">not</span></tt>
<tt class="docutils literal"><span class="pre">and</span></tt> <tt class="docutils literal"><span class="pre">or</span></tt>
<tt class="docutils literal"><span class="pre">&lt;&lt;</span></tt> <tt class="docutils literal"><span class="pre">&gt;&gt;</span></tt></td>
<td>bitwise not,
and, or,
bit shifts</td>
</tr>
</tbody>
</table>
<p>Precedence and and associativity of the operators can be found in the
<a class="reference internal" href="#operators">operators</a> table at the beginning of this section.</p>
<p>The names of some operations are at odds with C. Note, in particular, that
logical negation is denoted <tt class="docutils literal"><span class="pre">~</span></tt> instead of <tt class="docutils literal"><span class="pre">!</span></tt> (and, consequently,
<tt class="docutils literal"><span class="pre">~=</span></tt> denotes inequality, rather than <tt class="docutils literal"><span class="pre">!=</span></tt>), and the bitwise operations
are named differently. This is necessary because Pure uses <tt class="docutils literal"><span class="pre">!</span></tt>, <tt class="docutils literal"><span class="pre">&amp;</span></tt> and
<tt class="docutils literal"><span class="pre">|</span></tt> for other purposes. Also, <tt class="docutils literal"><span class="pre">/</span></tt> always denotes inexact (double)
division in Pure, whereas the integer division operators are called <tt class="docutils literal"><span class="pre">div</span></tt>
and <tt class="docutils literal"><span class="pre">mod</span></tt>. (<tt class="docutils literal"><span class="pre">%</span></tt>, which is not defined by this module, also has a
different meaning in Pure; it's the exact division operator, see <a class="reference internal" href="#rational-numbers">Rational
Numbers</a>.)</p>
<p>The above operations are implemented for int, bigint and, where
appropriate, double and pointer operands. (Pointer arithmetic comprises
<tt class="docutils literal"><span class="pre">+</span></tt> and <tt class="docutils literal"><span class="pre">-</span></tt> and works in the usual way, i.e., <tt class="docutils literal"><span class="pre">p-q</span></tt> returns the byte
offset between two pointers <tt class="docutils literal"><span class="pre">p</span></tt> and <tt class="docutils literal"><span class="pre">q</span></tt>, and <tt class="docutils literal"><span class="pre">p+n</span></tt> or <tt class="docutils literal"><span class="pre">p-n</span></tt> offsets
a pointer <tt class="docutils literal"><span class="pre">p</span></tt> by the given integer <tt class="docutils literal"><span class="pre">n</span></tt> denoting the amount of bytes.)
The math module (see <a class="reference internal" href="#mathematical-functions">Mathematical Functions</a>) also provides
implementations of the arithmetic and comparison operators for rational,
complex and complex rational numbers.</p>
<p>Note that the logical operations are actually implemented as special forms
in order to provide for short-circuit evaluation. This needs special
support from the compiler to work. The primitives module still provides
definitions for these, as well as other special forms like <tt class="docutils literal"><span class="pre">quote</span></tt> and
the thunking operator <tt class="docutils literal"><span class="pre">&amp;</span></tt> so that they may be used as function values and
in partial applications, but when used in this manner they lose all their
special call-by-name properties; see <a class="reference external" href="pure.html#special-forms">Special Forms</a> in the Pure Manual
for details.</p>
<p>The constants <tt class="docutils literal"><span class="pre">inf</span></tt> and <tt class="docutils literal"><span class="pre">nan</span></tt> are defined as the usual IEEE floating
point infinities and NaNs, and the predicates <tt class="docutils literal"><span class="pre">infp</span></tt> and <tt class="docutils literal"><span class="pre">nanp</span></tt> are
provided to check for these kinds of values.</p>
<p>In addition, the following arithmetic and numeric functions are provided:</p>
<a name="abs"><a name="sgn"><dl class="docutils" id="sgn">
<span id="abs"></span><dt><tt class="docutils literal"><span class="pre">abs</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">sgn</span> <span class="pre">x</span></tt></dt>
<dd>Absolute value and sign of a number.</dd>
</dl>
<a name="min"><a name="max"><dl class="docutils" id="max">
<span id="min"></span><dt><tt class="docutils literal"><span class="pre">min</span> <span class="pre">x</span> <span class="pre">y</span></tt>, <tt class="docutils literal"><span class="pre">max</span> <span class="pre">x</span> <span class="pre">y</span></tt></dt>
<dd>Minimum and maximum of two values. This works with any kind of values
which have the ordering relations defined on them.</dd>
</dl>
<a name="succ"><a name="pred"><dl class="docutils" id="pred">
<span id="succ"></span><dt><tt class="docutils literal"><span class="pre">succ</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">pred</span> <span class="pre">x</span></tt></dt>
<dd>Successor (<tt class="docutils literal"><span class="pre">+1</span></tt>) and predecessor (<tt class="docutils literal"><span class="pre">-1</span></tt>) functions.</dd>
</dl>
<a name="gcd"><a name="lcd"><dl class="docutils" id="lcd">
<span id="gcd"></span><dt><tt class="docutils literal"><span class="pre">gcd</span> <span class="pre">x</span> <span class="pre">y</span></tt>, <tt class="docutils literal"><span class="pre">lcd</span> <span class="pre">x</span> <span class="pre">y</span></tt></dt>
<dd>The greatest common divisor and least common multiple functions from the
GMP library. These return a bigint if at least one of the arguments is a
bigint, a machine int otherwise.</dd>
</dl>
<a name="pow"><dl class="docutils" id="pow">
<dt><tt class="docutils literal"><span class="pre">pow</span> <span class="pre">x</span> <span class="pre">y</span></tt></dt>
<dd>Computes exact powers of ints and bigints. The result is always a
bigint. Note that <tt class="docutils literal"><span class="pre">y</span></tt> must always be nonnegative here, but see the math
module (<a class="reference internal" href="#mathematical-functions">Mathematical Functions</a>) which deals with the case <tt class="docutils literal"><span class="pre">y&lt;0</span></tt>
using rational numbers.</dd>
</dl>
</div>
<div class="section" id="conversions">
<h3><a class="toc-backref" href="#id88">1.7.2&nbsp;&nbsp;&nbsp;Conversions</a></h3>
<p>These operations convert between various types of Pure values.</p>
<a name="hash"><dl class="docutils" id="hash">
<dt><tt class="docutils literal"><span class="pre">hash</span> <span class="pre">x</span></tt></dt>
<dd>Compute a 32 bit hash code of a Pure expression.</dd>
</dl>
<a name="int"><a name="bigint"><a name="double"><a name="pointer"><dl class="docutils" id="pointer">
<span id="double"></span><span id="bigint"></span><span id="int"></span><dt><tt class="docutils literal"><span class="pre">int</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">bigint</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">double</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">pointer</span> <span class="pre">x</span></tt></dt>
<dd>Conversions between the different numeric and pointer types.</dd>
</dl>
<a name="ubyte"><a name="ushort"><a name="uint"><a name="uint64"><a name="ulong"><dl class="docutils" id="ulong">
<span id="uint64"></span><span id="uint"></span><span id="ushort"></span><span id="ubyte"></span><dt><tt class="docutils literal"><span class="pre">ubyte</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">ushort</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">uint</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">uint64</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">ulong</span> <span class="pre">x</span></tt></dt>
<dd>Convert signed (8/16/32/64) bit integers to the corresponding unsigned
quantities. These functions behave as if the value was &quot;cast&quot; to the
corresponding unsigned C type, and are most useful for dealing with
unsigned integers returned by external C routines. The routines always
use the smallest Pure int type capable of holding the result: <tt class="docutils literal"><span class="pre">int</span></tt> for
<tt class="docutils literal"><span class="pre">ubyte</span></tt> and <tt class="docutils literal"><span class="pre">ushort</span></tt>, <tt class="docutils literal"><span class="pre">bigint</span></tt> for <tt class="docutils literal"><span class="pre">uint</span></tt>, <tt class="docutils literal"><span class="pre">uint64</span></tt> and
<tt class="docutils literal"><span class="pre">ulong</span></tt>. All routines take int parameters. In the case of <tt class="docutils literal"><span class="pre">uint64</span></tt>, a
bigint parameter is also permitted (which is what the C interface returns
for 64 bit values). Also note that <tt class="docutils literal"><span class="pre">ulong</span></tt> reduces to either <tt class="docutils literal"><span class="pre">uint</span></tt>
or <tt class="docutils literal"><span class="pre">uint64</span></tt>, depending on the size of <tt class="docutils literal"><span class="pre">long</span></tt> for the host
architecture.</dd>
</dl>
<p>The following <span class="target" id="rounding-functions">rounding functions</span> work with all kinds of numbers:</p>
<a name="floor"><a name="ceil"><dl class="docutils" id="ceil">
<span id="floor"></span><dt><tt class="docutils literal"><span class="pre">floor</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">ceil</span> <span class="pre">x</span></tt></dt>
<dd>Floor and ceil.</dd>
</dl>
<a name="round"><a name="trunc"><dl class="docutils" id="trunc">
<span id="round"></span><dt><tt class="docutils literal"><span class="pre">round</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">trunc</span> <span class="pre">x</span></tt></dt>
<dd>Round or truncate to an integer.</dd>
</dl>
<a name="frac"><dl class="docutils" id="frac">
<dt><tt class="docutils literal"><span class="pre">frac</span> <span class="pre">x</span></tt></dt>
<dd>Fractional part (<tt class="docutils literal"><span class="pre">x-trunc</span> <span class="pre">x</span></tt>).</dd>
</dl>
<p>Note that all these functions return double values for double arguments, so
if you need an integer result then you'll have to apply a suitable
conversion, as in <tt class="docutils literal"><span class="pre">int</span> <span class="pre">(floor</span> <span class="pre">x)</span></tt>.</p>
</div>
<div class="section" id="predicates">
<h3><a class="toc-backref" href="#id89">1.7.3&nbsp;&nbsp;&nbsp;Predicates</a></h3>
<p>A syntactic equality test is provided, as well as various type checking
predicates.</p>
<a name="same"><a name="==="><a name="~=="><dl class="docutils" id="id36">
<span id="id35"></span><span id="same"></span><dt><tt class="docutils literal"><span class="pre">x===y</span></tt>, <tt class="docutils literal"><span class="pre">x~==y</span></tt>, <tt class="docutils literal"><span class="pre">same</span> <span class="pre">x</span> <span class="pre">y</span></tt></dt>
<dd>Syntactic equality. In difference to <tt class="docutils literal"><span class="pre">==</span></tt> and <tt class="docutils literal"><span class="pre">~=</span></tt> this is defined on
all Pure expressions. Basically, two expressions are syntactically equal
if they print out the same in the interpreter. In the special case of
pointer objects and closures, which do not have a syntactic
representation in Pure, <tt class="docutils literal"><span class="pre">x</span></tt> and <tt class="docutils literal"><span class="pre">y</span></tt> must be the same object (same
pointer value or function).</dd>
</dl>
<a name="intp"><a name="bigintp"><a name="doublep"><a name="stringp"><a name="pointerp"><a name="matrixp"><dl class="docutils" id="matrixp">
<span id="pointerp"></span><span id="stringp"></span><span id="doublep"></span><span id="bigintp"></span><span id="intp"></span><dt><tt class="docutils literal"><span class="pre">intp</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">bigintp</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">doublep</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">stringp</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">pointerp</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">matrixp</span> <span class="pre">x</span></tt></dt>
<dd>Predicates to check for the built-in types.</dd>
</dl>
<a name="charp"><dl class="docutils" id="charp">
<dt><tt class="docutils literal"><span class="pre">charp</span> <span class="pre">x</span></tt></dt>
<dd>Single character string predicate.</dd>
</dl>
<a name="numberp"><a name="complexp"><a name="realp"><a name="rationalp"><a name="integerp"><dl class="docutils" id="integerp">
<span id="rationalp"></span><span id="realp"></span><span id="complexp"></span><span id="numberp"></span><dt><tt class="docutils literal"><span class="pre">numberp</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">complexp</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">realp</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">rationalp</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">integerp</span> <span class="pre">x</span></tt></dt>
<dd>Additional number predicates.</dd>
</dl>
<a name="exactp"><a name="inexactp"><dl class="docutils" id="inexactp">
<span id="exactp"></span><dt><tt class="docutils literal"><span class="pre">exactp</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">inexactp</span> <span class="pre">x</span></tt></dt>
<dd>Check whether a number is exact (i.e., doesn't contain any double
components).</dd>
</dl>
<a name="applp"><a name="listp"><a name="listnp"><a name="tuplep"><dl class="docutils" id="tuplep">
<span id="listnp"></span><span id="listp"></span><span id="applp"></span><dt><tt class="docutils literal"><span class="pre">applp</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">listp</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">listnp</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">tuplep</span> <span class="pre">x</span></tt></dt>
<dd>Predicates to check for function applications, proper lists, list nodes
and proper tuples.</dd>
</dl>
<a name="funp"><a name="lambdap"><a name="thunkp"><a name="varp"><dl class="docutils" id="varp">
<span id="thunkp"></span><span id="lambdap"></span><span id="funp"></span><dt><tt class="docutils literal"><span class="pre">funp</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">lambdap</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">thunkp</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">varp</span> <span class="pre">x</span></tt></dt>
<dd>Predicates to check for various kinds of function objects (named,
anonymous or thunk), and free variable symbols.</dd>
</dl>
<a name="atomp"><a name="closurep"><dl class="docutils" id="closurep">
<span id="atomp"></span><dt><tt class="docutils literal"><span class="pre">atomp</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">closurep</span> <span class="pre">x</span></tt></dt>
<dd>Convenience functions to check for atoms (named function or variable) and
closures (named function or lambda).</dd>
</dl>
</div>
<div class="section" id="inspection">
<h3><a class="toc-backref" href="#id90">1.7.4&nbsp;&nbsp;&nbsp;Inspection</a></h3>
<p>The following operations let you peek at various internal information that
the interpreter provides to Pure programs either for convenience or for
metaprogramming purposes. They are complemented by the evaluation
primitives discussed below, see <a class="reference internal" href="#eval-and-friends">Eval and Friends</a>.</p>
<a name="ans"><dl class="docutils" id="ans">
<dt><tt class="docutils literal"><span class="pre">ans</span></tt></dt>
<dd><p class="first">Retrieve the most recently printed result of a toplevel expression
evaluated in the read-eval-print loop. This is just a convenience for
interactive usage. Note that the <tt class="docutils literal"><span class="pre">ans</span></tt> value will stick around until a
new expression is computed. (It is possible to clear the <tt class="docutils literal"><span class="pre">ans</span></tt> value
with the interactive command <tt class="docutils literal"><span class="pre">clear</span> <span class="pre">ans</span></tt>, however.) Example:</p>
<pre class="last literal-block">
&gt; 1/3;
0.333333333333333
&gt; ans/2;
0.166666666666667
</pre>
</dd>
</dl>
<a name="\__locals__"><dl class="docutils" id="locals">
<dt><tt class="docutils literal"><span class="pre">__locals__</span></tt></dt>
<dd><p class="first">Return a list with the local function bindings (<tt class="docutils literal"><span class="pre">with</span></tt> clauses) visible
at this point in the program. This is actually implemented as a
built-in. The return value is a list of &quot;hash&quot; pairs <tt class="docutils literal"><span class="pre">x=&gt;f</span></tt> where <tt class="docutils literal"><span class="pre">x</span></tt>
is the (quoted) symbol denoting the function and <tt class="docutils literal"><span class="pre">f</span></tt> is the function
itself (or its value, if <tt class="docutils literal"><span class="pre">f</span></tt> is a parameterless function). The
<tt class="docutils literal"><span class="pre">__locals__</span></tt> function is useful for debugging purposes, as well as to
implement dynamic environments. It is also used internally to implement
the <a class="reference internal" href="#reduce"><tt class="docutils literal"><span class="pre">reduce</span></tt></a> macro, see <a class="reference internal" href="#eval-and-friends">Eval and Friends</a>. Example:</p>
<pre class="last literal-block">
&gt; __locals__ with foo x = x+1; x = a+b end;
[x=&gt;a+b,foo=&gt;foo]
&gt; f 99 when _=&gt;f = ans!1 end;
100
</pre>
</dd>
</dl>
<p>The prelude also provides some functions to retrieve various attributes of
a function symbol which determine how the operation is applied to its
operands or arguments. These functions all take a single argument, the
symbol or function object to be inspected, and return an integer value.</p>
<a name="nargs"><dl class="docutils" id="nargs">
<dt><tt class="docutils literal"><span class="pre">nargs</span> <span class="pre">x</span></tt></dt>
<dd>Get the argument count of a function object, i.e., the number of
arguments it expects. Returns 0 for thunks and saturated applications, -1
for over-saturated applications and non-functions.</dd>
</dl>
<a name="arity"><dl class="docutils" id="arity">
<dt><tt class="docutils literal"><span class="pre">arity</span> <span class="pre">x</span></tt></dt>
<dd>Determine the arity of an operator symbol. The returned value is 0, 1 or
2 for nullary, unary and binary symbols, respectively, -1 for symbols
without a fixity declaration or other kinds of objects.</dd>
</dl>
<a name="fixity"><dl class="docutils" id="fixity">
<dt><tt class="docutils literal"><span class="pre">fixity</span> <span class="pre">f</span></tt></dt>
<dd>Determine the fixity of an operator symbol. The fixity is encoded as an
integer <tt class="docutils literal"><span class="pre">10*n+m</span></tt> where <tt class="docutils literal"><span class="pre">n</span></tt> is the precedence level (ranging
from <tt class="docutils literal"><span class="pre">0</span></tt> to <tt class="docutils literal"><span class="pre">PREC_MAX</span></tt>, where <tt class="docutils literal"><span class="pre">PREC_MAX</span></tt> denotes the precedence of
primary expressions, 16777216 in the current implementation) and <tt class="docutils literal"><span class="pre">m</span></tt>
indicates the actual fixity at each level, in the order of increasing
precedence (0 = infix, 1 = infixl, 2 = infixr, 3 = prefix, 4 =
postfix). The fixity value of nonfix and outfix symbols, as well as
symbols without a fixity declaration, is always given as <tt class="docutils literal"><span class="pre">10*PREC_MAX</span></tt>,
and the same value is also reported for non-symbol objects. Infix, prefix
and postfix symbols always have a <tt class="docutils literal"><span class="pre">fixity</span></tt> value less than
<tt class="docutils literal"><span class="pre">10*PREC_MAX</span></tt>. (<tt class="docutils literal"><span class="pre">PREC_MAX</span></tt> isn't actually defined as a constant
anywhere, but you can easily do that yourself by setting <tt class="docutils literal"><span class="pre">PREC_MAX</span></tt> to
the fixity value of any nonfix symbol or non-symbol value, e.g.: <tt class="docutils literal"><span class="pre">const</span>
<span class="pre">PREC_MAX</span> <span class="pre">=</span> <span class="pre">fixity</span> <span class="pre">[];</span></tt>)</dd>
</dl>
<p>Note that only closures (i.e., named and anonymous functions and thunks)
have a defined argument count in Pure, otherwise <tt class="docutils literal"><span class="pre">nargs</span></tt> returns -1
indicating an unknown argument count. Partial applications of closures
return the number of remaining arguments, which may be zero to indicate a
<strong class="dfn">saturated</strong> (but unevaluated) application, or -1 for <strong class="dfn">over-saturated</strong> and
constructor applications. (Note that in Pure a saturated application may
also remain unevaluated because there is no definition for the given
combination of arguments and thus the expression is in normal form, or
because the application was quoted. If such a normal form application is
then applied to some &quot;extra&quot; arguments it becomes over-saturated.)</p>
<p>The value returned by <tt class="docutils literal"><span class="pre">nargs</span></tt> always denotes the actual argument count of
the given function, regardless of the declared arity if the function also
happens to be an operator symbol. Often these will coincide (as, e.g., in
the case of <tt class="docutils literal"><span class="pre">+</span></tt> which is a binary operator and also expects two
arguments). But this is not necessarily the case, as shown in the following
example of a binary operator which actually takes <em>three</em> arguments:</p>
<pre class="literal-block">
&gt; infix 0 oops;
&gt; (oops) x y z = x*z+y;
&gt; arity (oops);
2
&gt; nargs (oops);
3
&gt; nargs (5 oops 8);
1
&gt; map (5 oops 8) (1..5);
[13,18,23,28,33]
</pre>
</div>
<div class="section" id="eval-and-friends">
<h3><a class="toc-backref" href="#id91">1.7.5&nbsp;&nbsp;&nbsp;Eval and Friends</a></h3>
<p>Pure provides some rather powerful operations to convert between Pure
expressions and their string representation, and to evaluate quoted
expressions (<tt class="docutils literal"><span class="pre">'x</span></tt>). The string conversions <tt class="docutils literal"><span class="pre">str</span></tt>, <tt class="docutils literal"><span class="pre">val</span></tt> and <tt class="docutils literal"><span class="pre">eval</span></tt>
also provide a convenient means to serialize Pure expressions, e.g., when
terms are to be transferred to/from persistent storage. (Note, however,
that this has its limitations. Specifically, some objects like pointers and
anonymous functions do not have a parsable string representation. Also see
the <a class="reference internal" href="#expression-serialization">Expression Serialization</a> section for some dedicated serialization
operations which provide a more compact binary serialization format.)</p>
<a name="str"><dl class="docutils" id="str">
<dt><tt class="docutils literal"><span class="pre">str</span> <span class="pre">x</span></tt></dt>
<dd>Yields the print representation of an expression in Pure syntax, as a
string.</dd>
</dl>
<a name="val (string)"><dl class="docutils" id="val-string">
<dt><tt class="docutils literal"><span class="pre">val</span> <span class="pre">s</span></tt></dt>
<dd>Parses a single simple expression, specified as a string in Pure syntax,
and returns the result as is, without evaluating it. Note that this is
much more limited than the <tt class="docutils literal"><span class="pre">eval</span></tt> operation below, as the expression
must not contain any of the special constructs (conditional expressions,
<tt class="docutils literal"><span class="pre">when</span></tt>, <tt class="docutils literal"><span class="pre">with</span></tt>, etc.).</dd>
</dl>
<a name="eval"><dl class="docutils" id="eval">
<dt><tt class="docutils literal"><span class="pre">eval</span> <span class="pre">x</span></tt></dt>
<dd>Parses any expression, specified as a string in Pure syntax, and returns
its value. In fact, <tt class="docutils literal"><span class="pre">eval</span></tt> can also parse and execute arbitrary Pure
code. In that case it will return the last computed expression, if any.
Alternatively, <tt class="docutils literal"><span class="pre">eval</span></tt> can also be invoked on a (quoted) Pure
expression, which is recompiled and then evaluated. Exceptions during
evaluation are reported back to the caller.</dd>
</dl>
<a name="evalcmd"><dl class="docutils" id="evalcmd">
<dt><tt class="docutils literal"><span class="pre">evalcmd</span> <span class="pre">x</span></tt></dt>
<dd>Like <tt class="docutils literal"><span class="pre">eval</span></tt>, but allows execution of interactive commands and returns
their captured output as a string. No other results are returned, so this
operation is most useful for executing Pure definitions and interactive
commands for their side-effects. (At this time, only the regular output
of a few commands can be captured, most notably <tt class="docutils literal"><span class="pre">bt</span></tt>, <tt class="docutils literal"><span class="pre">clear</span></tt>,
<tt class="docutils literal"><span class="pre">mem</span></tt>, <tt class="docutils literal"><span class="pre">save</span></tt> and <tt class="docutils literal"><span class="pre">show</span></tt>; otherwise the result string will be
empty.)</dd>
</dl>
<a name="lasterr"><dl class="docutils" id="lasterr">
<dt><tt class="docutils literal"><span class="pre">lasterr</span></tt></dt>
<dd>Reports errors in <tt class="docutils literal"><span class="pre">eval</span></tt> and <tt class="docutils literal"><span class="pre">evalcmd</span></tt>. This string value will be
nonempty iff a compilation or execution error was encountered during the
most recent invokation of <tt class="docutils literal"><span class="pre">eval</span></tt> and <tt class="docutils literal"><span class="pre">evalcmd</span></tt>. In that case each
reported error message is terminated with a newline character.</dd>
</dl>
<a name="reduce"><dl class="docutils" id="reduce">
<dt><tt class="docutils literal"><span class="pre">reduce</span> <span class="pre">x</span></tt></dt>
<dd>Reevaluates an expression in a local environment. This dynamically
rebinds function symbols in the given expression to whatever local
definitions are in effect at the point of the <tt class="docutils literal"><span class="pre">reduce</span></tt> call. Note that
<tt class="docutils literal"><span class="pre">reduce</span></tt> is actually implemented as a macro which expands to the
<tt class="docutils literal"><span class="pre">reduce_with</span></tt> primitive (see below), using the <a class="reference internal" href="#locals"><tt class="docutils literal"><span class="pre">__locals__</span></tt></a> builtin to
enumerate the bindings which are in effect at the call site.</dd>
</dl>
<a name="reduce_with"><dl class="docutils" id="reduce-with">
<dt><tt class="docutils literal"><span class="pre">reduce_with</span> <span class="pre">env</span> <span class="pre">x</span></tt></dt>
<dd>Like <tt class="docutils literal"><span class="pre">reduce</span></tt> above, but takes a list of replacements (given as hash
pairs <tt class="docutils literal"><span class="pre">u=&gt;v</span></tt>) as the first argument. The <tt class="docutils literal"><span class="pre">reduce</span></tt> macro expands to
<tt class="docutils literal"><span class="pre">reduce_with</span> <span class="pre">__locals__</span></tt>.</dd>
</dl>
<p>Examples:</p>
<pre class="literal-block">
&gt; str (1/3);
&quot;0.333333333333333&quot;
&gt; val &quot;1/3&quot;;
1/3
&gt; eval &quot;1/3&quot;;
0.333333333333333
&gt; eval ('(1/3));
0.333333333333333
&gt; evalcmd &quot;show evalcmd&quot;;
&quot;extern expr* evalcmd(expr*);\n&quot;

&gt; eval &quot;1/3)&quot;;
eval &quot;1/3)&quot;
&gt; lasterr;
&quot;&lt;stdin&gt;, line 1: syntax error, unexpected ')', expecting '=' or '|'\n&quot;
</pre>
<p>The <tt class="docutils literal"><span class="pre">reduce</span></tt> macro provides a restricted form of dynamic binding which is
useful to implement local rewriting rules. It is invoked without parameters
and expands to the curried call <tt class="docutils literal"><span class="pre">reduce_with</span> <span class="pre">__locals__</span></tt> of the
<tt class="docutils literal"><span class="pre">reduce_with</span></tt> primitive, which takes one additional argument, the
expression to be rewritten. The following example shows how to expand or
factorize an expression using local rules for the corresponding laws of
distributivity:</p>
<pre class="literal-block">
expand = reduce with
  (a+b)*c = a*c+b*c;
  a*(b+c) = a*b+a*c;
end;

factor = reduce with
  a*c+b*c = (a+b)*c;
  a*b+a*c = a*(b+c);
end;

expand ((a+b)*2); // yields a*2+b*2
factor (a*2+b*2); // yields (a+b)*2
</pre>
<p>Note that instances of locally bound functions are substituted back in the
computed result, thus the instances of <tt class="docutils literal"><span class="pre">*</span></tt> and <tt class="docutils literal"><span class="pre">+</span></tt> in the results
<tt class="docutils literal"><span class="pre">a*2+b*2</span></tt> and <tt class="docutils literal"><span class="pre">(a+b)*2</span></tt> shown above denote the corresponding globals,
not the local incarnations of <tt class="docutils literal"><span class="pre">*</span></tt> and <tt class="docutils literal"><span class="pre">+</span></tt> defined in <tt class="docutils literal"><span class="pre">expand</span></tt> and
<tt class="docutils literal"><span class="pre">factor</span></tt>, respectively.</p>
<p><tt class="docutils literal"><span class="pre">reduce</span></tt> also adjusts to quoted arguments. In this case, the local rules
are applied as usual, but back-substituted globals are <em>not</em> evaluated in
the result:</p>
<pre class="literal-block">
&gt; expand ((a+1)*2);
a*2+2
&gt; expand ('((a+1)*2));
a*2+1*2
</pre>
<p>Note that <tt class="docutils literal"><span class="pre">reduce</span></tt> only takes into account local <em>function</em> bindings from
<tt class="docutils literal"><span class="pre">with</span></tt> clauses, local <em>variable</em> bindings do not affect its operation in
any way:</p>
<pre class="literal-block">
&gt; let y = [x,x^2,x^3];
&gt; reduce y when x = u+v end;
[x,x^2,x^3]
</pre>
<p>However, in such cases you can perform the desired substitution by turning
the <tt class="docutils literal"><span class="pre">when</span></tt> into a <tt class="docutils literal"><span class="pre">with</span></tt> clause:</p>
<pre class="literal-block">
&gt; reduce y with x = u+v end;
[u+v,(u+v)^2,(u+v)^3]
</pre>
<p>Or you can just invoke the underlying <tt class="docutils literal"><span class="pre">reduce_with</span></tt> builtin directly,
with the desired substitutions given as hash pairs in the first argument:</p>
<pre class="literal-block">
&gt; reduce_with [x=&gt;u+v] y;
[u+v,(u+v)^2,(u+v)^3]
</pre>
</div>
<div class="section" id="expression-serialization">
<h3><a class="toc-backref" href="#id92">1.7.6&nbsp;&nbsp;&nbsp;Expression Serialization</a></h3>
<p>Like <tt class="docutils literal"><span class="pre">str</span></tt> and <tt class="docutils literal"><span class="pre">eval</span></tt>, the following <tt class="docutils literal"><span class="pre">blob</span></tt> and <tt class="docutils literal"><span class="pre">val</span></tt> operations
can be used to safely transfer expression data to/from persistent storage
and between different processes (using, e.g., POSIX shared memory, pipes or
sockets). However, <tt class="docutils literal"><span class="pre">blob</span></tt> and <tt class="docutils literal"><span class="pre">val</span></tt> use a binary format which is
usually much more compact and gets processed much faster than the string
representations used by <tt class="docutils literal"><span class="pre">str</span></tt> and <tt class="docutils literal"><span class="pre">eval</span></tt>. Also, <tt class="docutils literal"><span class="pre">val</span></tt> offers some
additional protection against transmission errors through a crc check. (The
advantage of the string representation, however, is that it's readable
plain text in Pure syntax.)</p>
<a name="blob"><dl class="docutils" id="blob">
<dt><tt class="docutils literal"><span class="pre">blob</span> <span class="pre">x</span></tt></dt>
<dd>Stores the contents of the given expression as a binary object. The
return value is a cooked pointer which frees itself when
garbage-collected.</dd>
</dl>
<a name="val (blob)"><dl class="docutils" id="val-blob">
<dt><tt class="docutils literal"><span class="pre">val</span> <span class="pre">p</span></tt></dt>
<dd>Reconstructs a serialized expression from the result of a previous
invocation of the <tt class="docutils literal"><span class="pre">blob</span></tt> function.</dd>
</dl>
<a name="blobp"><dl class="docutils" id="blobp">
<dt><tt class="docutils literal"><span class="pre">blobp</span> <span class="pre">p</span></tt></dt>
<dd>Checks for a valid <tt class="docutils literal"><span class="pre">blob</span></tt> object. (Note that <tt class="docutils literal"><span class="pre">val</span></tt> may fail even if
<tt class="docutils literal"><span class="pre">blobp</span></tt> returns <tt class="docutils literal"><span class="pre">true</span></tt>, because for performance reasons <tt class="docutils literal"><span class="pre">blobp</span></tt>
only does a quick plausibility check on the header information of the
blob, whereas <tt class="docutils literal"><span class="pre">val</span></tt> also performs a crc check and verifies data
integrity.)</dd>
</dl>
<a name="blob_size"><a name="blob_crc"><dl class="docutils" id="blob-crc">
<span id="blob-size"></span><dt><tt class="docutils literal"><span class="pre">blob_size</span> <span class="pre">p</span></tt>, <tt class="docutils literal"><span class="pre">blob_crc</span> <span class="pre">p</span></tt></dt>
<dd>Determines the size (in bytes) and crc checksum of a blob, respectively.
<tt class="docutils literal"><span class="pre">blob_size</span></tt> always returns a bigint, <tt class="docutils literal"><span class="pre">blob_crc</span></tt> a machine int (use
<tt class="docutils literal"><span class="pre">uint</span></tt> on the latter to get a proper unsigned 32 bit value). For
convenience, <tt class="docutils literal"><span class="pre">#p</span></tt> is defined as an alias for <tt class="docutils literal"><span class="pre">blob_size</span> <span class="pre">p</span></tt> on
<tt class="docutils literal"><span class="pre">blob</span></tt> pointers.</dd>
</dl>
<p>Example:</p>
<pre class="literal-block">
&gt; let b = blob {&quot;Hello, world!&quot;, 1/3, 4711, NULL};
&gt; b; #b; uint $ blob_crc b;
#&lt;pointer 0x141dca0&gt;
148L
3249898239L
&gt; val b;
{&quot;Hello, world!&quot;,0.333333333333333,4711,#&lt;pointer 0&gt;}
</pre>
<p>Please note that the current implementation has some limitations:</p>
<ul class="simple">
<li>Just as with <tt class="docutils literal"><span class="pre">str</span></tt> and <tt class="docutils literal"><span class="pre">eval</span></tt>, runtime data (local closures and
pointers other than the <tt class="docutils literal"><span class="pre">NULL</span></tt> pointer) can't be serialized, causing
<tt class="docutils literal"><span class="pre">blob</span></tt> to fail. However, it <em>is</em> possible to transfer a global
function, provided that the function exists (and is the same) in both the
sending and the receiving process. (This condition can't be verified
by <tt class="docutils literal"><span class="pre">val</span></tt> and thus is at the programmer's responsibilty.)</li>
<li>Sharing of subexpressions will in general be preserved, but sharing of
list and tuple <em>tails</em> will be lost (unless the entire list or tuple is
shared).</li>
<li>The <tt class="docutils literal"><span class="pre">val</span></tt> function may fail to reconstruct the serialized expression
even for valid blobs, if there is a conflict in symbol fixities between
the symbol tables of the sending and the receiving process. To avoid
this, make sure that symbol declarations in the sending and the receiving
script match up.</li>
</ul>
</div>
<div class="section" id="other-special-primitives">
<h3><a class="toc-backref" href="#id93">1.7.7&nbsp;&nbsp;&nbsp;Other Special Primitives</a></h3>
<a name="exit"><dl class="docutils" id="exit">
<dt><tt class="docutils literal"><span class="pre">exit</span> <span class="pre">status</span></tt></dt>
<dd>Terminate the program with the given status code.</dd>
</dl>
<a name="throw"><dl class="docutils" id="throw">
<dt><tt class="docutils literal"><span class="pre">throw</span> <span class="pre">x</span></tt></dt>
<dd>Throw an exception, cf. <a class="reference external" href="pure.html#exception-handling">Exception Handling</a>.</dd>
</dl>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">force</span> <span class="pre">x</span></tt></dt>
<dd>Force a thunk (<tt class="docutils literal"><span class="pre">x&amp;</span></tt>), cf. <a class="reference external" href="pure.html#special-forms">Special Forms</a>. This usually happens
automagically when the value of a thunk is needed.</dd>
</dl>
<!--  -->
</div>
<div class="section" id="pointer-operations">
<h3><a class="toc-backref" href="#id94">1.7.8&nbsp;&nbsp;&nbsp;Pointer Operations</a></h3>
<p>These are lowlevel operations dealing with pointer values. The usual
caveats apply, so <em>only</em> use these directly if you know what you're doing!</p>
<a name="addr"><dl class="docutils" id="addr">
<dt><tt class="docutils literal"><span class="pre">addr</span> <span class="pre">symbol</span></tt></dt>
<dd>Get the address of a C symbol (given as a string) at runtime. The library
containing the symbol must already be loaded. Note that this can in fact
be any kind of externally visible C symbol, so it's also possible to get
the addresses of global variables. The result is returned as a
pointer. The function fails if the symbol was not found.</dd>
</dl>
<a name="calloc"><a name="malloc"><a name="realloc"><a name="free"><dl class="docutils" id="free">
<span id="realloc"></span><span id="malloc"></span><span id="calloc"></span><dt><tt class="docutils literal"><span class="pre">calloc</span> <span class="pre">nmembers</span> <span class="pre">size</span></tt>, <tt class="docutils literal"><span class="pre">malloc</span> <span class="pre">size</span></tt>, <tt class="docutils literal"><span class="pre">realloc</span> <span class="pre">ptr</span> <span class="pre">size</span></tt>, <tt class="docutils literal"><span class="pre">free</span> <span class="pre">ptr</span></tt></dt>
<dd>Interface to <tt class="docutils literal"><span class="pre">malloc</span></tt>, <tt class="docutils literal"><span class="pre">free</span></tt> and friends. These let you allocate
dynamic buffers (represented as Pure pointer values) for various nasty
purposes.</dd>
</dl>
<a name="get_byte"><a name="get_short"><a name="get_int"><a name="get_int64"><a name="get_long"><a name="get_float"><a name="get_double"><a name="get_string"><a name="get_pointer"><a name="put_byte"><a name="put_short"><a name="put_int"><a name="put_int64"><a name="put_long"><a name="put_float"><a name="put_double"><a name="put_string"><a name="put_pointer"><p id="put-pointer"><span id="put-string"></span><span id="put-double"></span><span id="put-float"></span><span id="put-long"></span><span id="put-int64"></span><span id="put-int"></span><span id="put-short"></span><span id="put-byte"></span><span id="get-pointer"></span><span id="get-string"></span><span id="get-double"></span><span id="get-float"></span><span id="get-long"></span><span id="get-int64"></span><span id="get-int"></span><span id="get-short"></span><span id="get-byte"></span>The following operations perform direct memory accesses. Use with care
... or else!</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">get_byte</span> <span class="pre">ptr</span></tt>, <tt class="docutils literal"><span class="pre">get_short</span> <span class="pre">ptr</span></tt>, <tt class="docutils literal"><span class="pre">get_int</span> <span class="pre">ptr</span></tt>, <tt class="docutils literal"><span class="pre">get_int64</span> <span class="pre">ptr</span></tt>,
<tt class="docutils literal"><span class="pre">get_long</span> <span class="pre">ptr</span></tt>, <tt class="docutils literal"><span class="pre">get_float</span> <span class="pre">ptr</span></tt>, <tt class="docutils literal"><span class="pre">get_double</span> <span class="pre">ptr</span></tt>,
<tt class="docutils literal"><span class="pre">get_string</span> <span class="pre">ptr</span></tt>, <tt class="docutils literal"><span class="pre">get_pointer</span> <span class="pre">ptr</span></tt></li>
<li><tt class="docutils literal"><span class="pre">put_byte</span> <span class="pre">ptr</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">put_short</span> <span class="pre">ptr</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">put_int</span> <span class="pre">ptr</span> <span class="pre">x</span></tt>,
<tt class="docutils literal"><span class="pre">put_int64</span> <span class="pre">ptr</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">put_long</span> <span class="pre">ptr</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">put_float</span> <span class="pre">ptr</span> <span class="pre">x</span></tt>,
<tt class="docutils literal"><span class="pre">put_double</span> <span class="pre">ptr</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">put_string</span> <span class="pre">ptr</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">put_pointer</span> <span class="pre">ptr</span> <span class="pre">x</span></tt></li>
</ul>
<!--  -->
</div>
<div class="section" id="sentries">
<h3><a class="toc-backref" href="#id95">1.7.9&nbsp;&nbsp;&nbsp;Sentries</a></h3>
<p>Sentries are Pure's flavour of object <strong class="dfn">finalizers</strong>. A sentry is simply an
object (usually a function) which gets applied to the target expression
when it is garbage-collected. This is useful to perform automatic cleanup
actions on objects with internal state, such as files. Pure's sentries are
<em>much</em> more useful than finalizers in other garbage-collected languages,
since it is guaranteed that they are called as soon as an object &quot;goes out
of scope&quot;, i.e., becomes inaccessible.</p>
<a name="sentry"><dl class="docutils" id="sentry">
<dt><tt class="docutils literal"><span class="pre">sentry</span> <span class="pre">f</span> <span class="pre">x</span></tt></dt>
<dd>Places a sentry <tt class="docutils literal"><span class="pre">f</span></tt> at an expression <tt class="docutils literal"><span class="pre">x</span></tt> and returns the modified
expression.</dd>
</dl>
<a name="clear_sentry"><dl class="docutils" id="clear-sentry">
<dt><tt class="docutils literal"><span class="pre">clear_sentry</span> <span class="pre">x</span></tt></dt>
<dd>Removes the sentry from an expression <tt class="docutils literal"><span class="pre">x</span></tt>.</dd>
</dl>
<a name="get_sentry"><dl class="docutils" id="get-sentry">
<dt><tt class="docutils literal"><span class="pre">get_sentry</span> <span class="pre">x</span></tt></dt>
<dd>Returns the sentry of an expression <tt class="docutils literal"><span class="pre">x</span></tt> (if any, fails otherwise).</dd>
</dl>
<p>Note that in the current implementation sentries can only be placed at
symbols, applications, as well as function and pointer objects, but the
department of fake statistics has assured us that this covers 99.7% of all
practical uses. The sentry itself can be any type of object (but usually
it's a function). There can be only one sentry per expression but, building
on the operations provided here, it's easy to design a scheme where
sentries are chained.</p>
<p>Example:</p>
<pre class="literal-block">
&gt; using system;
&gt; sentry (\_-&gt;puts &quot;Hello, world!&quot;) (1..3);
[1,2,3]
&gt; clear ans
Hello, world!
</pre>
<p>Note that setting a finalizer on a global symbol won't usually be of much
use since such values are cached by the interpreter. (However, the sentry
<em>will</em> be invoked if the symbol gets recompiled because its definition
has changed. This may be useful for some purposes.)</p>
<p>One common case where sentries are particularly useful are pointers. The
library provides some special support for these by means of the following
operations:</p>
<a name="cooked"><dl class="docutils" id="cooked">
<dt><tt class="docutils literal"><span class="pre">cooked</span> <span class="pre">ptr</span></tt></dt>
<dd>Create a <strong class="dfn">cooked</strong> pointer which disposes itself after use. This is just a
shorthand for <tt class="docutils literal"><span class="pre">sentry</span> <span class="pre">free</span></tt>. The given pointer <tt class="docutils literal"><span class="pre">ptr</span></tt> must be
<a class="reference internal" href="#malloc"><tt class="docutils literal"><span class="pre">malloc</span></tt></a>ed to make this work.</dd>
</dl>
<a name="cookedp"><dl class="docutils" id="cookedp">
<dt><tt class="docutils literal"><span class="pre">cookedp</span> <span class="pre">ptr</span></tt></dt>
<dd>Check whether a given pointer is cooked (this predicate actually assumes
any pointer to be cooked which has a sentry set on it).</dd>
</dl>
<p>Example:</p>
<pre class="literal-block">
&gt; using system;
&gt; let p = sentry (\p-&gt;puts &quot;I'm done for!&quot; $$ free p) (malloc 1024);
&gt; cookedp p;
1
&gt; clear p
I'm done for!
</pre>
<p>Besides their use as finalizers, sentries can also be handy in other
circumstances, when you need to associate an expression with another,
&quot;invisible&quot; value. In this case the sentry is usually some kind of data
structure instead of a function to be executed at finalization time. For
instance, here's how we can employ sentries to implement hashing of
function values:</p>
<pre class="literal-block">
using dict;
hashed f x = case get_sentry f of
               h::Hdict = h!x if member h x;
               _ = y when y = f x; sentry (update h x y) f
                       when h = case get_sentry f of
                                  h::Hdict = h; _ = emptyhdict
                                end;
                       end;
                     end;
             end;
</pre>
<p>E.g., consider the naive recursive definition of the Fibonacci function:</p>
<pre class="literal-block">
fib n::int = if n&lt;=1 then 1 else fib (n-1)+fib (n-2);
</pre>
<p>A hashed version of the Fibonacci function can be defined as follows:</p>
<pre class="literal-block">
let hfib = hashed f with
  f n::int = if n&lt;=1 then 1 else hfib (n-1)+hfib (n-2)
end;
</pre>
<p>This turns the naive definition of the Fibonacci function (which has
exponential time complexity) into a linear time operation:</p>
<pre class="literal-block">
&gt; stats
&gt; fib 35;
14930352
4.53s
&gt; hfib 35;
14930352
0.25s
</pre>
<!--  -->
</div>
<div class="section" id="expression-references">
<h3><a class="toc-backref" href="#id96">1.7.10&nbsp;&nbsp;&nbsp;Expression References</a></h3>
<p>Expression references provide a kind of mutable data cells which can hold
any Pure expression. If you need these, then you're doomed. ;-) However,
they can be useful as a last resort when you need to keep track of some
local state or interface to the messy imperative world. Pure's references
are actually implemented as expression pointers so that you can readily
pass them as pointers to a C function which expects a <tt class="docutils literal"><span class="pre">pure_expr**</span></tt>
parameter. This may even be useful at times.</p>
<a name="ref"><dl class="docutils" id="ref">
<dt><tt class="docutils literal"><span class="pre">ref</span> <span class="pre">x</span></tt></dt>
<dd>Create a reference pointing to <tt class="docutils literal"><span class="pre">x</span></tt> initially.</dd>
</dl>
<a name="put"><dl class="docutils" id="put">
<dt><tt class="docutils literal"><span class="pre">put</span> <span class="pre">r</span> <span class="pre">x</span></tt></dt>
<dd>Set a new value <tt class="docutils literal"><span class="pre">x</span></tt>, and return that value.</dd>
</dl>
<a name="get"><dl class="docutils" id="get">
<dt><tt class="docutils literal"><span class="pre">get</span> <span class="pre">r</span></tt></dt>
<dd>Retrieve the current value <tt class="docutils literal"><span class="pre">r</span></tt> points to.</dd>
</dl>
<a name="unref"><dl class="docutils" id="unref">
<dt><tt class="docutils literal"><span class="pre">unref</span> <span class="pre">r</span></tt></dt>
<dd>Purge the referenced object and turn the reference into a dangling
pointer. (This is used as a sentry on reference objects and shouldn't
normally be called directly.)</dd>
</dl>
<a name="refp"><dl class="docutils" id="refp">
<dt><tt class="docutils literal"><span class="pre">refp</span> <span class="pre">x</span></tt></dt>
<dd>Predicate to check for reference values.</dd>
</dl>
<p>Note that manually removing the <tt class="docutils literal"><span class="pre">unref</span></tt> sentry of a reference turns the
reference into just a normal pointer object and renders it unusable as a
reference. Doing this will also leak memory, so don't!</p>
<!--  -->
</div>
</div>
</div>
<div class="section" id="mathematical-functions">
<h1><a class="toc-backref" href="#id97">2&nbsp;&nbsp;&nbsp;Mathematical Functions</a></h1>
<p>The math.pure module provides Pure's basic math routines. It also defines
complex and rational numbers.</p>
<div class="section" id="imports">
<h2><a class="toc-backref" href="#id98">2.1&nbsp;&nbsp;&nbsp;Imports</a></h2>
<p>To use the operations of this module, add the following import declaration
to your program:</p>
<pre class="literal-block">
using math;
</pre>
</div>
<div class="section" id="basic-math-functions">
<h2><a class="toc-backref" href="#id99">2.2&nbsp;&nbsp;&nbsp;Basic Math Functions</a></h2>
<p>The module defines Euler's number <tt class="docutils literal"><span class="pre">e</span> <span class="pre">=</span> <span class="pre">2.71828...</span></tt> and Ludolph's number
<tt class="docutils literal"><span class="pre">pi</span> <span class="pre">=</span> <span class="pre">3.1415...</span></tt> as constants. It also provides a reasonably
comprehensive (pseudo) random number generator which uses the <a class="reference external" href="http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/emt.html">Mersenne
twister</a> to avoid bad generators present in some C libraries.</p>
<p>Please note that as of Pure 0.41, the runtime library includes a newer
release of the Mersenne twister which fixes issues with some kinds of seed
values, and will yield different values for given seeds. Also, the
<tt class="docutils literal"><span class="pre">random31</span></tt> and <tt class="docutils literal"><span class="pre">random53</span></tt> functions have been added as a convenience to
compute unsigned 31 bit integers and 53 bit double values, and the
<tt class="docutils literal"><span class="pre">srandom</span></tt> function now also accepts an <tt class="docutils literal"><span class="pre">int</span></tt> matrix as seed value.</p>
<a name="random"><dl class="docutils" id="random">
<dt><tt class="docutils literal"><span class="pre">random</span></tt></dt>
<dd>Return 32 bit pseudo random ints in the range <tt class="docutils literal"><span class="pre">-0x80000000..0x7fffffff</span></tt>.</dd>
</dl>
<a name="random31"><dl class="docutils" id="random31">
<dt><tt class="docutils literal"><span class="pre">random31</span></tt></dt>
<dd>Return 31 bit pseudo random ints in the range <tt class="docutils literal"><span class="pre">0..0x7fffffff</span></tt>.</dd>
</dl>
<a name="random53"><dl class="docutils" id="random53">
<dt><tt class="docutils literal"><span class="pre">random53</span></tt></dt>
<dd>Return pseudo random doubles in the range <tt class="docutils literal"><span class="pre">[0,1)</span></tt> with 53 bits
resolution.</dd>
</dl>
<a name="srandom"><dl class="docutils" id="srandom">
<dt><tt class="docutils literal"><span class="pre">srandom</span> <span class="pre">seed</span></tt></dt>
<dd>Sets the seed of the generator to the given 32 bit integer. You can also
specify longer seeds using a nonempty row vector, e.g.: <tt class="docutils literal"><span class="pre">srandom</span> <span class="pre">{0x123,</span>
<span class="pre">0x234,</span> <span class="pre">0x345,</span> <span class="pre">0x456}</span></tt>.</dd>
</dl>
<!--  -->
<p>The following functions work with both double and int/bigint arguments. The
result is always a double. For further explanations please see the
descriptions of the corresponding functions from the C math library.</p>
<a name="sqrt"><dl class="docutils" id="sqrt">
<dt><tt class="docutils literal"><span class="pre">sqrt</span> <span class="pre">x</span></tt></dt>
<dd>The square root function.</dd>
</dl>
<a name="exp"><a name="ln"><a name="log"><dl class="docutils" id="log">
<span id="ln"></span><span id="exp"></span><dt><tt class="docutils literal"><span class="pre">exp</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">ln</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">log</span> <span class="pre">x</span></tt></dt>
<dd>Exponential function, natural and decadic logarithms.</dd>
</dl>
<a name="sin"><a name="cos"><a name="tan"><dl class="docutils" id="tan">
<span id="cos"></span><span id="sin"></span><dt><tt class="docutils literal"><span class="pre">sin</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">cos</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">tan</span> <span class="pre">x</span></tt></dt>
<dd>Trigonometric functions.</dd>
</dl>
<a name="asin"><a name="acos"><a name="atan"><dl class="docutils" id="atan">
<span id="acos"></span><span id="asin"></span><dt><tt class="docutils literal"><span class="pre">asin</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">acos</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">atan</span> <span class="pre">x</span></tt></dt>
<dd>Inverse trigonometric functions.</dd>
</dl>
<a name="atan2"><dl class="docutils" id="atan2">
<dt><tt class="docutils literal"><span class="pre">atan2</span> <span class="pre">y</span> <span class="pre">x</span></tt></dt>
<dd>Computes the arcus tangent of <tt class="docutils literal"><span class="pre">y/x</span></tt>, using the signs of the two
arguments to determine the quadrant of the result.</dd>
</dl>
<a name="sinh"><a name="cosh"><a name="tanh"><dl class="docutils" id="tanh">
<span id="cosh"></span><span id="sinh"></span><dt><tt class="docutils literal"><span class="pre">sinh</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">cosh</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">tanh</span> <span class="pre">x</span></tt></dt>
<dd>Hyperbolic trigonometric functions.</dd>
</dl>
<a name="asinh"><a name="acosh"><a name="atanh"><dl class="docutils" id="atanh">
<span id="acosh"></span><span id="asinh"></span><dt><tt class="docutils literal"><span class="pre">asinh</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">acosh</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">atanh</span> <span class="pre">x</span></tt></dt>
<dd>Inverse hyperbolic trigonometric functions.</dd>
</dl>
<!--  -->
</div>
<div class="section" id="complex-numbers">
<h2><a class="toc-backref" href="#id100">2.3&nbsp;&nbsp;&nbsp;Complex Numbers</a></h2>
<a name="+:"><a name="<:"><p id="id38"><span id="id37"></span>We provide both rectangular (<tt class="docutils literal"><span class="pre">x+:y</span></tt>) and polar (<tt class="docutils literal"><span class="pre">r&lt;:a</span></tt>)
representations, where <tt class="docutils literal"><span class="pre">(x,y)</span></tt> are the Cartesian coordinates and
<tt class="docutils literal"><span class="pre">(r,t)</span></tt> the radius (absolute value) and angle (in radians) of a complex
number, respectively. The <tt class="docutils literal"><span class="pre">+:</span></tt> and <tt class="docutils literal"><span class="pre">&lt;:</span></tt> constructors (declared in the
prelude) bind weaker than all other arithmetic operators and are
non-associative.</p>
<p>The polar representation <tt class="docutils literal"><span class="pre">r&lt;:t</span></tt> is normalized so that <tt class="docutils literal"><span class="pre">r</span></tt> is always
nonnegative and <tt class="docutils literal"><span class="pre">t</span></tt> falls in the range <tt class="docutils literal"><span class="pre">-pi&lt;t&lt;=pi</span></tt>.</p>
<p>The constant <tt class="docutils literal"><span class="pre">i</span></tt> is provided to denote the imaginary unit <tt class="docutils literal"><span class="pre">0+:1</span></tt>.</p>
<p>The arithmetic operations <tt class="docutils literal"><span class="pre">+</span></tt>, <tt class="docutils literal"><span class="pre">*</span></tt> etc. and the equality relations
<tt class="docutils literal"><span class="pre">==</span></tt> and <tt class="docutils literal"><span class="pre">~=</span></tt> work as expected, and the square root, exponential,
logarithms, trigonometric and hyperbolic trigonometric functions (see
<a class="reference internal" href="#basic-math-functions">Basic Math Functions</a>) are extended to complex numbers accordingly. These
do <em>not</em> rely on complex number support in the C library, but should still
conform to IEEE 754 and POSIX, provided that the C library provides a
standards-compliant implementation of the basic math functions.</p>
<!--  -->
<p>The following operations all work with both the rectangular and the polar
representation, promoting real (double, int/bigint) inputs to complex where
appropriate. When the result of an operation is again a complex number, it
generally uses the same representation as the input (except for explicit
conversions). Mixed rect/polar and polar/rect arithmetic always returns a
rect result, and mixed complex/real and real/complex arithmetic yields a
rect or polar result, depending on what the complex input was.</p>
<a name="complex"><dl class="docutils" id="complex">
<dt><tt class="docutils literal"><span class="pre">complex</span> <span class="pre">x</span></tt></dt>
<dd>Convert any kind of number to a complex value.</dd>
</dl>
<a name="polar"><a name="rect"><dl class="docutils" id="rect">
<span id="polar"></span><dt><tt class="docutils literal"><span class="pre">polar</span> <span class="pre">z</span></tt>, <tt class="docutils literal"><span class="pre">rect</span> <span class="pre">z</span></tt></dt>
<dd>Convert between polar and rectangular representations.</dd>
</dl>
<a name="cis"><dl class="docutils" id="cis">
<dt><tt class="docutils literal"><span class="pre">cis</span> <span class="pre">t</span></tt></dt>
<dd>Create complex values on the unit circle. Note: To quickly compute
<tt class="docutils literal"><span class="pre">exp</span> <span class="pre">(x+:y)</span></tt> in polar form, use <tt class="docutils literal"><span class="pre">exp</span> <span class="pre">x</span> <span class="pre">&lt;:</span> <span class="pre">y</span></tt>.</dd>
</dl>
<a name="abs (complex)"><a name="arg"><dl class="docutils" id="arg">
<span id="abs-complex"></span><dt><tt class="docutils literal"><span class="pre">abs</span> <span class="pre">z</span></tt>, <tt class="docutils literal"><span class="pre">arg</span> <span class="pre">z</span></tt></dt>
<dd>Modulus (absolute value) and argument (angle, a.k.a. phase). Note that
you can also find both of these in one go by converting to polar form.</dd>
</dl>
<a name="re"><a name="im"><dl class="docutils" id="im">
<span id="re"></span><dt><tt class="docutils literal"><span class="pre">re</span> <span class="pre">z</span></tt>, <tt class="docutils literal"><span class="pre">im</span> <span class="pre">z</span></tt></dt>
<dd>Real and imaginary part.</dd>
</dl>
<a name="conj"><dl class="docutils" id="conj">
<dt><tt class="docutils literal"><span class="pre">conj</span> <span class="pre">z</span></tt></dt>
<dd>Complex conjugate.</dd>
</dl>
<!--  -->
<p>Examples:</p>
<pre class="literal-block">
&gt; using math;
&gt; let z = 2^(1/i); z;
0.769238901363972+:-0.638961276313635
&gt; let z = ln z/ln 2; z;
0.0+:-1.0
&gt; abs z, arg z;
1.0,-1.5707963267949
&gt; polar z;
1.0&lt;:-1.5707963267949
</pre>
<p>Please note that, as the <tt class="docutils literal"><span class="pre">+:</span></tt> and <tt class="docutils literal"><span class="pre">&lt;:</span></tt> constructors bind weaker than
the other arithmetic operators, complex numbers <em>must</em> be parenthesized
accordingly, e.g.:</p>
<pre class="literal-block">
&gt; (1+:2)*(3+:4);
-5+:10
</pre>
<!--  -->
</div>
<div class="section" id="rational-numbers">
<h2><a class="toc-backref" href="#id101">2.4&nbsp;&nbsp;&nbsp;Rational Numbers</a></h2>
<a name="%"><p id="id39">Pure's rational numbers are constructed with the <strong class="dfn">exact division</strong> operator
<tt class="docutils literal"><span class="pre">%</span></tt> (declared in the prelude) which has the same precedence and fixity as
the other division operators.</p>
<p>The <tt class="docutils literal"><span class="pre">%</span></tt> operator returns a rational or complex rational for any
combination of integer, rational and complex integer/rational arguments,
provided that the denominator is nonzero (otherwise it behaves like <tt class="docutils literal"><span class="pre">x</span> <span class="pre">div</span>
<span class="pre">0</span></tt>, which will raise an exception). Machine int operands are always
promoted to bigints, thus normalized rationals always take the form <tt class="docutils literal"><span class="pre">x%y</span></tt>
where both the numerator <tt class="docutils literal"><span class="pre">x</span></tt> and the denominator <tt class="docutils literal"><span class="pre">y</span></tt> are bigints. For
other numeric operands <tt class="docutils literal"><span class="pre">%</span></tt> works just like <tt class="docutils literal"><span class="pre">/</span></tt>. Rational results are
normalized so that the sign is always in the numerator and numerator and
denominator are relatively prime. In particular, a rational zero is always
represented as <tt class="docutils literal"><span class="pre">0L%1L</span></tt>.</p>
<p>The usual arithmetic operations and equality/order relations are extended
accordingly, as well as the <a class="reference internal" href="#basic-math-functions">basic math functions</a> and the <a class="reference internal" href="#rounding-functions">rounding
functions</a>, and will return exact (rational or complex rational) results
where appropriate. Rational operations are implemented using the GMP
bigint functions where possible, and thus are reasonably fast.</p>
<p>In addition, the module also provides following operations:</p>
<a name="rational"><dl class="docutils" id="rational">
<dt><tt class="docutils literal"><span class="pre">rational</span> <span class="pre">x</span></tt></dt>
<dd><p class="first">Converts a real or complex value <tt class="docutils literal"><span class="pre">x</span></tt> to a rational or complex
rational. Note that the conversion from double values doesn't do any
rounding, so it is guaranteed that converting the resulting rational back
to a double reconstructs the original value.</p>
<p class="last">Conversely, the <a class="reference internal" href="#int"><tt class="docutils literal"><span class="pre">int</span></tt></a>, <a class="reference internal" href="#bigint"><tt class="docutils literal"><span class="pre">bigint</span></tt></a>, <a class="reference internal" href="#double"><tt class="docutils literal"><span class="pre">double</span></tt></a>, <a class="reference internal" href="#complex"><tt class="docutils literal"><span class="pre">complex</span></tt></a>, <a class="reference internal" href="#rect"><tt class="docutils literal"><span class="pre">rect</span></tt></a>,
<a class="reference internal" href="#polar"><tt class="docutils literal"><span class="pre">polar</span></tt></a> and <a class="reference internal" href="#cis"><tt class="docutils literal"><span class="pre">cis</span></tt></a> conversion functions are overloaded so that they
convert a rational to one of the other number types.</p>
</dd>
</dl>
<a name="num"><a name="den"><dl class="docutils" id="den">
<span id="num"></span><dt><tt class="docutils literal"><span class="pre">num</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">den</span> <span class="pre">x</span></tt></dt>
<dd>Numerator and denominator of a rational <tt class="docutils literal"><span class="pre">x</span></tt>.</dd>
</dl>
<!--  -->
<p>Examples:</p>
<pre class="literal-block">
&gt; using math;
&gt; 5%7 + 2%3;
29L%21L
&gt; 3%8 - 1%3;
1L%24L
&gt; pow (11%10) 3;
1331L%1000L
&gt; let x = pow 3 (-3); x;
1L%27L
&gt; num x, den x;
1L,27L
&gt; rational (3/4);
3L%4L
</pre>
<p>Note that doubles can't represent most rationals exactly, so conversion
from double to rational <em>will</em> yield funny results in many cases (which are
still accurate up to rounding errors). For instance:</p>
<pre class="literal-block">
&gt; let x = rational (1/17); x;
4238682002231055L%72057594037927936L
&gt; num x/den x;
0.0588235294117647
&gt; double (1%17);
0.0588235294117647
</pre>
<!--  -->
</div>
<div class="section" id="semantic-number-predicates">
<h2><a class="toc-backref" href="#id102">2.5&nbsp;&nbsp;&nbsp;Semantic Number Predicates</a></h2>
<p>In difference to the syntactic predicates in <a class="reference internal" href="#primitives">Primitives</a>, these check
whether the given value can be represented as an object of the given target
type (up to rounding errors). Note that if <tt class="docutils literal"><span class="pre">x</span></tt> is of syntactic type
<tt class="docutils literal"><span class="pre">X</span></tt>, then it is also of semantic type <tt class="docutils literal"><span class="pre">X</span></tt>. Moreover, <tt class="docutils literal"><span class="pre">intvalp</span> <span class="pre">x</span> <span class="pre">=&gt;</span>
<span class="pre">bigintvalp</span> <span class="pre">x</span> <span class="pre">=&gt;</span> <span class="pre">ratvalp</span> <span class="pre">x</span> <span class="pre">=&gt;</span> <span class="pre">realvalp</span> <span class="pre">x</span> <span class="pre">=&gt;</span> <span class="pre">compvalp</span> <span class="pre">x</span> <span class="pre">&lt;=&gt;</span> <span class="pre">numberp</span> <span class="pre">x</span></tt>.</p>
<a name="compvalp"><dl class="docutils" id="compvalp">
<dt><tt class="docutils literal"><span class="pre">compvalp</span> <span class="pre">x</span></tt></dt>
<dd>Check for complex values (this is the same as <a class="reference internal" href="#numberp"><tt class="docutils literal"><span class="pre">numberp</span></tt></a>).</dd>
</dl>
<a name="realvalp"><dl class="docutils" id="realvalp">
<dt><tt class="docutils literal"><span class="pre">realvalp</span> <span class="pre">x</span></tt></dt>
<dd>Check for real values (<tt class="docutils literal"><span class="pre">im</span> <span class="pre">x==0</span></tt>).</dd>
</dl>
<a name="ratvalp"><dl class="docutils" id="ratvalp">
<dt><tt class="docutils literal"><span class="pre">ratvalp</span> <span class="pre">x</span></tt></dt>
<dd>Check for rational values (same as <tt class="docutils literal"><span class="pre">realvalp</span></tt>, except that IEEE 754
infinities and NaNs are excluded).</dd>
</dl>
<a name="bigintvalp"><dl class="docutils" id="bigintvalp">
<dt><tt class="docutils literal"><span class="pre">bigintvalp</span> <span class="pre">x</span></tt></dt>
<dd>Check for &quot;big&quot; integer values which can be represented as a bigint.</dd>
</dl>
<a name="intvalp"><dl class="docutils" id="intvalp">
<dt><tt class="docutils literal"><span class="pre">intvalp</span> <span class="pre">x</span></tt></dt>
<dd>Check for &quot;small&quot; integer values which can be represented as a machine
int.</dd>
</dl>
<!--  -->
</div>
</div>
<div class="section" id="container-types">
<h1><a class="toc-backref" href="#id103">3&nbsp;&nbsp;&nbsp;Container Types</a></h1>
<p>The standard library provides a variety of efficient container data
structures for different purposes. Note that these are all purely
functional, i.e., immutable data structures implemented using different
flavours of binary trees. Nevertheless operations are performed
efficiently, in logarithmic time where possible.</p>
<p>The container types are all implemented as abstract data structures, so
client modules shouldn't rely on the internal representation. Each type
provides a corresponding type tag (cf. <a class="reference external" href="pure.html#type-tags">Type Tags</a> in the Pure Manual), as
given in the &quot;Data Structure&quot; section of each type, which can be used to
match values of the type, e.g.:</p>
<pre class="literal-block">
shift a::Array = rmfirst a;
</pre>
<p>All container types implement the equality predicates <tt class="docutils literal"><span class="pre">==</span></tt> and <tt class="docutils literal"><span class="pre">~=</span></tt> by
recursively comparing their members. In addition, the set and bag data
structures also implement the other comparison predicates (<tt class="docutils literal"><span class="pre">&lt;</span></tt>, <tt class="docutils literal"><span class="pre">&lt;=</span></tt>
etc.) by checking whether one set/bag is a subset/subbag of another.</p>
<div class="section" id="arrays">
<h2><a class="toc-backref" href="#id104">3.1&nbsp;&nbsp;&nbsp;Arrays</a></h2>
<p>The array.pure module implements an efficient functional array data
structure which allows to access and update individual array members, as
well as to add and remove elements at the beginning and end of an
array. All these operations are carried out in logarithmic time.</p>
<div class="section" id="id40">
<h3><a class="toc-backref" href="#id105">3.1.1&nbsp;&nbsp;&nbsp;Imports</a></h3>
<p>To use the operations of this module, add the following import declaration
to your program:</p>
<pre class="literal-block">
using array;
</pre>
</div>
<div class="section" id="data-structure">
<h3><a class="toc-backref" href="#id106">3.1.2&nbsp;&nbsp;&nbsp;Data Structure</a></h3>
<p>Arrays are represented as balanced tree structures of the form <tt class="docutils literal"><span class="pre">Array</span> <span class="pre">T</span></tt>,
thus <tt class="docutils literal"><span class="pre">Array</span></tt> may be used as a type tag to restrict variables in pattern
matching.</p>
<p>The internal data structure <tt class="docutils literal"><span class="pre">T</span></tt> is a binary tree built with the following
constructors:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">nil</span></tt></dt>
<dd>the empty tree.</dd>
<dt><tt class="docutils literal"><span class="pre">tip</span> <span class="pre">value</span></tt></dt>
<dd>a leaf of the tree, holding the given value.</dd>
<dt><tt class="docutils literal"><span class="pre">bin</span> <span class="pre">balance</span> <span class="pre">left</span> <span class="pre">right</span></tt></dt>
<dd>a nonempty tree with the given balance flag (0 or 1) and left and right
subtrees.</dd>
</dl>
<p>(This is for informational purposes only. The tree constructors are
private, and client modules must not rely on the internal representation.)</p>
</div>
<div class="section" id="operations">
<h3><a class="toc-backref" href="#id107">3.1.3&nbsp;&nbsp;&nbsp;Operations</a></h3>
<a name="emptyarray"><dl class="docutils" id="emptyarray">
<dt><tt class="docutils literal"><span class="pre">emptyarray</span></tt></dt>
<dd>return the empty array</dd>
</dl>
<a name="array"><dl class="docutils" id="array">
<dt><tt class="docutils literal"><span class="pre">array</span> <span class="pre">xs</span></tt></dt>
<dd>create an array from a list <tt class="docutils literal"><span class="pre">xs</span></tt></dd>
</dl>
<a name="array2"><dl class="docutils" id="array2">
<dt><tt class="docutils literal"><span class="pre">array2</span> <span class="pre">xs</span></tt></dt>
<dd>create a two-dimensional array from a list of lists</dd>
</dl>
<a name="mkarray"><dl class="docutils" id="mkarray">
<dt><tt class="docutils literal"><span class="pre">mkarray</span> <span class="pre">x</span> <span class="pre">n</span></tt></dt>
<dd>create an array consisting of <tt class="docutils literal"><span class="pre">n</span></tt> <tt class="docutils literal"><span class="pre">x</span></tt>'s</dd>
</dl>
<a name="mkarray2"><dl class="docutils" id="mkarray2">
<dt><tt class="docutils literal"><span class="pre">mkarray2</span> <span class="pre">x</span> <span class="pre">(n,m)</span></tt></dt>
<dd>create a two-dimensional array of <tt class="docutils literal"><span class="pre">n*m</span></tt> <tt class="docutils literal"><span class="pre">x</span></tt>'s</dd>
</dl>
<a name="arrayp"><dl class="docutils" id="arrayp">
<dt><tt class="docutils literal"><span class="pre">arrayp</span> <span class="pre">x</span></tt></dt>
<dd>check whether <tt class="docutils literal"><span class="pre">x</span></tt> is an array</dd>
</dl>
<a name="# (array)"><dl class="docutils" id="id41">
<dt><tt class="docutils literal"><span class="pre">#a</span></tt></dt>
<dd>size of <tt class="docutils literal"><span class="pre">a</span></tt></dd>
</dl>
<a name="! (array)"><dl class="docutils" id="id42">
<dt><tt class="docutils literal"><span class="pre">a!i</span></tt></dt>
<dd>return the <tt class="docutils literal"><span class="pre">i</span></tt>th member of <tt class="docutils literal"><span class="pre">a</span></tt></dd>
<dt><tt class="docutils literal"><span class="pre">a!(i,j)</span></tt></dt>
<dd>two-dimensional subscript</dd>
</dl>
<a name="null (array)"><dl class="docutils" id="null-array">
<dt><tt class="docutils literal"><span class="pre">null</span> <span class="pre">a</span></tt></dt>
<dd>test whether <tt class="docutils literal"><span class="pre">a</span></tt> is the empty array</dd>
</dl>
<a name="members (array)"><a name="list (array)"><dl class="docutils" id="list-array">
<span id="members-array"></span><dt><tt class="docutils literal"><span class="pre">members</span> <span class="pre">a</span></tt>, <tt class="docutils literal"><span class="pre">list</span> <span class="pre">a</span></tt></dt>
<dd>list of values stored in <tt class="docutils literal"><span class="pre">a</span></tt></dd>
</dl>
<a name="members2 (array)"><a name="list2 (array)"><dl class="docutils" id="list2-array">
<span id="members2-array"></span><dt><tt class="docutils literal"><span class="pre">members2</span> <span class="pre">a</span></tt>, <tt class="docutils literal"><span class="pre">list2</span> <span class="pre">a</span></tt></dt>
<dd>list of members in a two-dimensional array</dd>
</dl>
<a name="first (array)"><a name="last (array)"><dl class="docutils" id="last-array">
<span id="first-array"></span><dt><tt class="docutils literal"><span class="pre">first</span> <span class="pre">a</span></tt>, <tt class="docutils literal"><span class="pre">last</span> <span class="pre">a</span></tt></dt>
<dd>first and last member of <tt class="docutils literal"><span class="pre">a</span></tt></dd>
</dl>
<a name="rmfirst (array)"><a name="rmlast (array)"><dl class="docutils" id="rmlast-array">
<span id="rmfirst-array"></span><dt><tt class="docutils literal"><span class="pre">rmfirst</span> <span class="pre">a</span></tt>, <tt class="docutils literal"><span class="pre">rmlast</span> <span class="pre">a</span></tt></dt>
<dd>remove first and last member from <tt class="docutils literal"><span class="pre">a</span></tt></dd>
</dl>
<a name="insert (array)"><dl class="docutils" id="insert-array">
<dt><tt class="docutils literal"><span class="pre">insert</span> <span class="pre">a</span> <span class="pre">x</span></tt></dt>
<dd>insert <tt class="docutils literal"><span class="pre">x</span></tt> at the beginning of <tt class="docutils literal"><span class="pre">a</span></tt></dd>
</dl>
<a name="append (array)"><dl class="docutils" id="append-array">
<dt><tt class="docutils literal"><span class="pre">append</span> <span class="pre">a</span> <span class="pre">x</span></tt></dt>
<dd>append <tt class="docutils literal"><span class="pre">x</span></tt> to the end of <tt class="docutils literal"><span class="pre">a</span></tt></dd>
</dl>
<a name="update (array)"><dl class="docutils" id="update-array">
<dt><tt class="docutils literal"><span class="pre">update</span> <span class="pre">a</span> <span class="pre">i</span> <span class="pre">x</span></tt></dt>
<dd>replace the <tt class="docutils literal"><span class="pre">i</span></tt>th member of <tt class="docutils literal"><span class="pre">a</span></tt> by <tt class="docutils literal"><span class="pre">x</span></tt></dd>
</dl>
<a name="update2"><dl class="docutils" id="update2">
<dt><tt class="docutils literal"><span class="pre">update2</span> <span class="pre">a</span> <span class="pre">(i,j)</span> <span class="pre">x</span></tt></dt>
<dd>update two-dimensional array</dd>
</dl>
</div>
<div class="section" id="examples">
<h3><a class="toc-backref" href="#id108">3.1.4&nbsp;&nbsp;&nbsp;Examples</a></h3>
<p>Import the module:</p>
<pre class="literal-block">
&gt; using array;
</pre>
<p>A one-dimensional array:</p>
<pre class="literal-block">
&gt; let a::Array = array (0.0:0.1..1.0);
&gt; #a; members a;
11
[0.0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.0]
</pre>
<p>Indexing an array works in the usual way, using Pure's <tt class="docutils literal"><span class="pre">!</span></tt> operator. By
virtue of the prelude, slicing an array with <tt class="docutils literal"><span class="pre">!!</span></tt> also works as
expected:</p>
<pre class="literal-block">
&gt; a!5;
0.5
&gt; a!!(3..7);
[0.3,0.4,0.5,0.6,0.7]
</pre>
<p>Updating a member of an array produces a new array:</p>
<pre class="literal-block">
&gt; let b::Array = update a 1 2.0;
&gt; members b;
[0.0,2.0,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.0]
</pre>
<p>Two-dimensional arrays can be created with <tt class="docutils literal"><span class="pre">array2</span></tt> from a list of
lists:</p>
<pre class="literal-block">
&gt; let a2::Array = array2 [[i,x | x = [u,v,w]] | i = 1..2];
&gt; members2 a2;
[[(1,u),(1,v),(1,w)],[(2,u),(2,v),(2,w)]]
&gt; a2!(1,2);
2,w
&gt; a2!![(0,1),(1,2)];
[(1,v),(2,w)]
&gt; a2!!(0..1,1..2);
[[(1,v),(1,w)],[(2,v),(2,w)]]
</pre>
<p>Here's how to convert an array to a Pure matrix:</p>
<pre class="literal-block">
&gt; matrix $ members a;
{0.0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.0}
&gt; matrix $ members2 a2;
{(1,u),(1,v),(1,w);(2,u),(2,v),(2,w)}
</pre>
<p>Converting back from a matrix to an array:</p>
<pre class="literal-block">
&gt; let b2::Array = array2 $ list2 {(1,u),(1,v),(1,w);(2,u),(2,v),(2,w)};
&gt; members2 b2;
[[(1,u),(1,v),(1,w)],[(2,u),(2,v),(2,w)]]
</pre>
<!--  -->
</div>
</div>
<div class="section" id="heaps">
<h2><a class="toc-backref" href="#id109">3.2&nbsp;&nbsp;&nbsp;Heaps</a></h2>
<p>Heaps allow quick (constant time) access to the smallest member, and to
remove the smallest nember and insert new elements in logarithmic time.
This implementation does not allow quick update of heap members; if
such functionality is required, bags should be used instead
(see <a class="reference internal" href="#sets-and-bags">Sets and Bags</a>).</p>
<p>Heap members <em>must</em> be ordered by the <tt class="docutils literal"><span class="pre">&lt;=</span></tt> predicate. Multiple instances
of the same element may be stored in a heap; however, the order in which
equal elements are retrieved is not specified.</p>
<div class="section" id="id43">
<h3><a class="toc-backref" href="#id110">3.2.1&nbsp;&nbsp;&nbsp;Imports</a></h3>
<p>To use the operations of this module, add the following import declaration
to your program:</p>
<pre class="literal-block">
using heap;
</pre>
</div>
<div class="section" id="id44">
<h3><a class="toc-backref" href="#id111">3.2.2&nbsp;&nbsp;&nbsp;Data Structure</a></h3>
<p>Heaps are represented as balanced tree structures of the form <tt class="docutils literal"><span class="pre">Heap</span> <span class="pre">T</span></tt>,
thus <tt class="docutils literal"><span class="pre">Heap</span></tt> may be used as a type tag to restrict variables in pattern
matching.</p>
<p>The internal data structure <tt class="docutils literal"><span class="pre">T</span></tt> is a binary tree built with the following
constructors:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">nil</span></tt></dt>
<dd>the empty tree.</dd>
<dt><tt class="docutils literal"><span class="pre">bin</span> <span class="pre">balance</span> <span class="pre">value</span> <span class="pre">left</span> <span class="pre">right</span></tt></dt>
<dd>a nonempty tree holding the given value at its root node, with the given
balance flag (0 or 1) and left and right subtrees.</dd>
</dl>
<p>(This is for informational purposes only. The tree constructors are
private, and client modules must not rely on the internal representation.)</p>
</div>
<div class="section" id="id45">
<h3><a class="toc-backref" href="#id112">3.2.3&nbsp;&nbsp;&nbsp;Operations</a></h3>
<a name="emptyheap"><dl class="docutils" id="emptyheap">
<dt><tt class="docutils literal"><span class="pre">emptyheap</span></tt></dt>
<dd>return the empty heap</dd>
</dl>
<a name="heap"><dl class="docutils" id="heap">
<dt><tt class="docutils literal"><span class="pre">heap</span> <span class="pre">xs</span></tt></dt>
<dd>create a heap from a list <tt class="docutils literal"><span class="pre">xs</span></tt></dd>
</dl>
<a name="heapp"><dl class="docutils" id="heapp">
<dt><tt class="docutils literal"><span class="pre">heapp</span> <span class="pre">x</span></tt></dt>
<dd>check whether <tt class="docutils literal"><span class="pre">x</span></tt> is a heap</dd>
</dl>
<a name="# (heap)"><dl class="docutils" id="id46">
<dt><tt class="docutils literal"><span class="pre">#h</span></tt></dt>
<dd>size of a heap</dd>
</dl>
<a name="null (heap)"><dl class="docutils" id="null-heap">
<dt><tt class="docutils literal"><span class="pre">null</span> <span class="pre">h</span></tt></dt>
<dd>test whether <tt class="docutils literal"><span class="pre">h</span></tt> is the empty heap</dd>
</dl>
<a name="members (heap)"><a name="list (heap)"><dl class="docutils" id="list-heap">
<span id="members-heap"></span><dt><tt class="docutils literal"><span class="pre">members</span> <span class="pre">h</span></tt>, <tt class="docutils literal"><span class="pre">list</span> <span class="pre">h</span></tt></dt>
<dd>list the members of <tt class="docutils literal"><span class="pre">h</span></tt> in ascending order</dd>
</dl>
<a name="first (heap)"><dl class="docutils" id="first-heap">
<dt><tt class="docutils literal"><span class="pre">first</span> <span class="pre">h</span></tt></dt>
<dd>the first (i.e., smallest) member of <tt class="docutils literal"><span class="pre">h</span></tt></dd>
</dl>
<a name="rmfirst (heap)"><dl class="docutils" id="rmfirst-heap">
<dt><tt class="docutils literal"><span class="pre">rmfirst</span> <span class="pre">h</span></tt></dt>
<dd>remove the first (i.e., smallest) member from <tt class="docutils literal"><span class="pre">h</span></tt></dd>
</dl>
<a name="insert (heap)"><dl class="docutils" id="insert-heap">
<dt><tt class="docutils literal"><span class="pre">insert</span> <span class="pre">h</span> <span class="pre">x</span></tt></dt>
<dd>insert <tt class="docutils literal"><span class="pre">x</span></tt> into <tt class="docutils literal"><span class="pre">h</span></tt></dd>
</dl>
</div>
<div class="section" id="id47">
<h3><a class="toc-backref" href="#id113">3.2.4&nbsp;&nbsp;&nbsp;Examples</a></h3>
<pre class="literal-block">
&gt; let h::Heap = heap [5,1,3,11,3];
&gt; members h;
[1,3,3,5,11]
&gt; first h;
1
&gt; members $ rmfirst h;
[3,3,5,11]
</pre>
<!--  -->
</div>
</div>
<div class="section" id="dictionaries">
<h2><a class="toc-backref" href="#id114">3.3&nbsp;&nbsp;&nbsp;Dictionaries</a></h2>
<p>The dict.pure module provides Pure's <tt class="docutils literal"><span class="pre">Dict</span></tt> and <tt class="docutils literal"><span class="pre">Hdict</span></tt> data types
based on AVL trees. <tt class="docutils literal"><span class="pre">Dict</span></tt> is an ordered dictionary (assuming an ordered
key type), <tt class="docutils literal"><span class="pre">Hdict</span></tt> a hashed dictionary which works with any (mixture of)
key types but stores members in an apparently random order.</p>
<p>The used AVL tree algorithm has its origin in the SWI-Prolog implementation
of association lists. The original implementation was created by
R. A. O'Keefe and updated for SWI-Prolog by Jan Wielemaker. For the
original source see <a class="reference external" href="http://www.swi-prolog.org">http://www.swi-prolog.org</a>.</p>
<p>The port from SWI-Prolog and the deletion stuff (<tt class="docutils literal"><span class="pre">rmfirst</span></tt>, <tt class="docutils literal"><span class="pre">rmlast</span></tt>,
<tt class="docutils literal"><span class="pre">delete</span></tt>) missing in the Prolog implementation was provided by Jiri
Spitz.</p>
<div class="section" id="id48">
<h3><a class="toc-backref" href="#id115">3.3.1&nbsp;&nbsp;&nbsp;Imports</a></h3>
<p>To use the operations of this module, add the following import declaration
to your program:</p>
<pre class="literal-block">
using dict;
</pre>
</div>
<div class="section" id="id49">
<h3><a class="toc-backref" href="#id116">3.3.2&nbsp;&nbsp;&nbsp;Data Structure</a></h3>
<p>Dictionaries are represented as balanced tree structures of the form <tt class="docutils literal"><span class="pre">Dict</span>
<span class="pre">T</span></tt> or <tt class="docutils literal"><span class="pre">Hdict</span> <span class="pre">T</span></tt>, respectively, thus <tt class="docutils literal"><span class="pre">Dict</span></tt> and <tt class="docutils literal"><span class="pre">Hdict</span></tt> may be used
as type tags to restrict variables in pattern matching.</p>
<p>The internal data structure <tt class="docutils literal"><span class="pre">T</span></tt> is an AVL tree built with the following
constructors:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">nil</span></tt></dt>
<dd>the empty tree.</dd>
<dt><tt class="docutils literal"><span class="pre">bin</span> <span class="pre">key</span> <span class="pre">value</span> <span class="pre">balance</span> <span class="pre">left</span> <span class="pre">right</span></tt></dt>
<dd>a nonempty tree with given <tt class="docutils literal"><span class="pre">key</span></tt> and <tt class="docutils literal"><span class="pre">value</span></tt> in the root node, where
<tt class="docutils literal"><span class="pre">left</span></tt> and <tt class="docutils literal"><span class="pre">right</span></tt> are the left and right subtree, and <tt class="docutils literal"><span class="pre">balance</span></tt>
is either 1, 0 or -1, denoting <tt class="docutils literal"><span class="pre">|left|-|right|</span></tt> = 1, 0, or -1,
respectively.</dd>
</dl>
<p>(This is for informational purposes only. The tree constructors are
private, and client modules must not rely on the internal representation.)</p>
</div>
<div class="section" id="id50">
<h3><a class="toc-backref" href="#id117">3.3.3&nbsp;&nbsp;&nbsp;Operations</a></h3>
<a name="emptydict"><a name="emptyhdict"><dl class="docutils" id="emptyhdict">
<span id="emptydict"></span><dt><tt class="docutils literal"><span class="pre">emptydict</span></tt>, <tt class="docutils literal"><span class="pre">emptyhdict</span></tt></dt>
<dd>return the empty dict or hdict</dd>
</dl>
<a name="dict"><a name="hdict"><dl class="docutils" id="hdict">
<span id="dict"></span><dt><tt class="docutils literal"><span class="pre">dict</span> <span class="pre">xs</span></tt>, <tt class="docutils literal"><span class="pre">hdict</span> <span class="pre">xs</span></tt></dt>
<dd>create a dict or hdict from list <tt class="docutils literal"><span class="pre">xs</span></tt> of key-value pairs in the form
<tt class="docutils literal"><span class="pre">key=&gt;value</span></tt></dd>
</dl>
<a name="dictp"><a name="hdictp"><dl class="docutils" id="hdictp">
<span id="dictp"></span><dt><tt class="docutils literal"><span class="pre">dictp</span> <span class="pre">d</span></tt>, <tt class="docutils literal"><span class="pre">hdictp</span> <span class="pre">d</span></tt></dt>
<dd>check whether <tt class="docutils literal"><span class="pre">x</span></tt> is a dict or hdict</dd>
</dl>
<a name="mkdict"><a name="mkhdict"><dl class="docutils" id="mkhdict">
<span id="mkdict"></span><dt><tt class="docutils literal"><span class="pre">mkdict</span> <span class="pre">y</span> <span class="pre">xs</span></tt>, <tt class="docutils literal"><span class="pre">mkhdict</span> <span class="pre">y</span> <span class="pre">xs</span></tt></dt>
<dd>create dict or hdict from a list of keys and a constant value</dd>
</dl>
<a name="# (dict)"><a name="# (hdict)"><dl class="docutils" id="id52">
<span id="id51"></span><dt><tt class="docutils literal"><span class="pre">#d</span></tt></dt>
<dd>size of dict or hdict <tt class="docutils literal"><span class="pre">d</span></tt></dd>
</dl>
<a name="! (dict)"><a name="! (hdict)"><dl class="docutils" id="id54">
<span id="id53"></span><dt><tt class="docutils literal"><span class="pre">d!x</span></tt></dt>
<dd>get value from <tt class="docutils literal"><span class="pre">d</span></tt> by key <tt class="docutils literal"><span class="pre">x</span></tt></dd>
</dl>
<a name="null (dict)"><a name="null (hdict)"><dl class="docutils" id="null-hdict">
<span id="null-dict"></span><dt><tt class="docutils literal"><span class="pre">null</span> <span class="pre">d</span></tt></dt>
<dd>test whether <tt class="docutils literal"><span class="pre">d</span></tt> is the empty dict or hdict</dd>
</dl>
<a name="member (dict)"><a name="member (hdict)"><dl class="docutils" id="member-hdict">
<span id="member-dict"></span><dt><tt class="docutils literal"><span class="pre">member</span> <span class="pre">d</span> <span class="pre">x</span></tt></dt>
<dd>test whether <tt class="docutils literal"><span class="pre">d</span></tt> contains a member with key <tt class="docutils literal"><span class="pre">x</span></tt></dd>
</dl>
<a name="members (dict)"><a name="members (hdict)"><a name="list (dict)"><a name="list (hdict)"><dl class="docutils" id="list-hdict">
<span id="list-dict"></span><span id="members-hdict"></span><span id="members-dict"></span><dt><tt class="docutils literal"><span class="pre">members</span> <span class="pre">d</span></tt>, <tt class="docutils literal"><span class="pre">list</span> <span class="pre">d</span></tt></dt>
<dd>list members of <tt class="docutils literal"><span class="pre">d</span></tt> (in ascending order for dict)</dd>
</dl>
<a name="keys"><dl class="docutils" id="keys">
<dt><tt class="docutils literal"><span class="pre">keys</span> <span class="pre">d</span></tt></dt>
<dd>list keys of <tt class="docutils literal"><span class="pre">d</span></tt> (in ascending order for dict)</dd>
</dl>
<a name="vals"><dl class="docutils" id="vals">
<dt><tt class="docutils literal"><span class="pre">vals</span> <span class="pre">d</span></tt></dt>
<dd>list values of <tt class="docutils literal"><span class="pre">d</span></tt></dd>
</dl>
<a name="first (dict)"><a name="first (hdict)"><a name="last (dict)"><a name="last (hdict)"><dl class="docutils" id="last-hdict">
<span id="last-dict"></span><span id="first-hdict"></span><span id="first-dict"></span><dt><tt class="docutils literal"><span class="pre">first</span> <span class="pre">d</span></tt>, <tt class="docutils literal"><span class="pre">last</span> <span class="pre">d</span></tt></dt>
<dd>return first and last member of <tt class="docutils literal"><span class="pre">d</span></tt></dd>
</dl>
<a name="rmfirst (dict)"><a name="rmfirst (hdict)"><a name="rmlast (dict)"><a name="rmlast (hdict)"><dl class="docutils" id="rmlast-hdict">
<span id="rmlast-dict"></span><span id="rmfirst-hdict"></span><span id="rmfirst-dict"></span><dt><tt class="docutils literal"><span class="pre">rmfirst</span> <span class="pre">d</span></tt>, <tt class="docutils literal"><span class="pre">rmlast</span> <span class="pre">d</span></tt></dt>
<dd>remove first and last member from <tt class="docutils literal"><span class="pre">d</span></tt></dd>
</dl>
<a name="insert (dict)"><a name="insert (hdict)"><a name="update (dict)"><a name="update (hdict)"><dl class="docutils" id="update-hdict">
<span id="update-dict"></span><span id="insert-hdict"></span><span id="insert-dict"></span><dt><tt class="docutils literal"><span class="pre">insert</span> <span class="pre">d</span> <span class="pre">(x=&gt;y)</span></tt>, <tt class="docutils literal"><span class="pre">update</span> <span class="pre">d</span> <span class="pre">x</span> <span class="pre">y</span></tt></dt>
<dd>insert <tt class="docutils literal"><span class="pre">x=&gt;y</span></tt> into <tt class="docutils literal"><span class="pre">d</span></tt> (replace any existing element); <tt class="docutils literal"><span class="pre">update</span></tt> is
a fully curried version of <tt class="docutils literal"><span class="pre">insert</span></tt></dd>
</dl>
<a name="delete (dict)"><a name="delete (hdict)"><dl class="docutils" id="delete-hdict">
<span id="delete-dict"></span><dt><tt class="docutils literal"><span class="pre">delete</span> <span class="pre">d</span> <span class="pre">x</span></tt></dt>
<dd>remove <tt class="docutils literal"><span class="pre">x</span></tt> from <tt class="docutils literal"><span class="pre">d</span></tt></dd>
</dl>
</div>
<div class="section" id="id55">
<h3><a class="toc-backref" href="#id118">3.3.4&nbsp;&nbsp;&nbsp;Examples</a></h3>
<p>A normal (ordered) dictionary:</p>
<pre class="literal-block">
&gt; using dict;
&gt; let d::Dict = dict [&quot;foo&quot;=&gt;77,&quot;bar&quot;=&gt;99.1];
&gt; keys d; vals d; members d;
[&quot;bar&quot;,&quot;foo&quot;]
[99.1,77]
[&quot;bar&quot;=&gt;99.1,&quot;foo&quot;=&gt;77]
</pre>
<p>Indexing a dictionary works in the usual way, using Pure's <tt class="docutils literal"><span class="pre">!</span></tt> operator.
By virtue of the prelude, slicing a dictionary with <tt class="docutils literal"><span class="pre">!!</span></tt> also works as
expected:</p>
<pre class="literal-block">
&gt; d!&quot;foo&quot;;
77
&gt; d!![&quot;foo&quot;,&quot;bar&quot;];
[77,99.1]
</pre>
<p>A hashed dictionary can be used with any key values, which are stored in a
seemingly random order:</p>
<pre class="literal-block">
&gt; let h::Hdict = hdict [foo=&gt;77,42=&gt;99.1];
&gt; keys h; vals h; members h;
[42,foo]
[99.1,77]
[42=&gt;99.1,foo=&gt;77]
&gt; h!foo;
77
&gt; h!!keys h;
[99.1,77]
</pre>
<!--  -->
</div>
</div>
<div class="section" id="sets-and-bags">
<h2><a class="toc-backref" href="#id119">3.4&nbsp;&nbsp;&nbsp;Sets and Bags</a></h2>
<p>The set.pure module implements Pure's <tt class="docutils literal"><span class="pre">Set</span></tt> and <tt class="docutils literal"><span class="pre">Bag</span></tt> (multiset) data
types based on AVL trees. Set and bag elements must be ordered, i.e., the
predicates <tt class="docutils literal"><span class="pre">==</span></tt>, <tt class="docutils literal"><span class="pre">&lt;</span></tt> and <tt class="docutils literal"><span class="pre">&gt;</span></tt> must be defined on them. The used AVL
tree algorithm has its origin in the SWI-Prolog implementation of
association lists and was ported to Pure by Jiri Spitz, see <a class="reference internal" href="#dictionaries">Dictionaries</a>
for details.</p>
<div class="section" id="id56">
<h3><a class="toc-backref" href="#id120">3.4.1&nbsp;&nbsp;&nbsp;Imports</a></h3>
<p>To use the operations of this module, add the following import declaration
to your program:</p>
<pre class="literal-block">
using set;
</pre>
</div>
<div class="section" id="id57">
<h3><a class="toc-backref" href="#id121">3.4.2&nbsp;&nbsp;&nbsp;Data Structure</a></h3>
<p>Sets and bags are represented as balanced tree structures of the form <tt class="docutils literal"><span class="pre">Set</span>
<span class="pre">T</span></tt> or <tt class="docutils literal"><span class="pre">Bag</span> <span class="pre">T</span></tt>, respectively, thus <tt class="docutils literal"><span class="pre">Set</span></tt> and <tt class="docutils literal"><span class="pre">Bag</span></tt> may be used as
type tags to restrict variables in pattern matching.</p>
<p>The internal data structure <tt class="docutils literal"><span class="pre">T</span></tt> is an AVL tree built with the following
constructors:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">nil</span></tt></dt>
<dd>the empty tree.</dd>
<dt><tt class="docutils literal"><span class="pre">bin</span> <span class="pre">key</span> <span class="pre">balance</span> <span class="pre">left</span> <span class="pre">right</span></tt></dt>
<dd>a nonempty tree with given <tt class="docutils literal"><span class="pre">key</span></tt> (set element) in the root node, where
<tt class="docutils literal"><span class="pre">left</span></tt> and <tt class="docutils literal"><span class="pre">right</span></tt> are the left and right subtree, and <tt class="docutils literal"><span class="pre">balance</span></tt> is
either 1, 0 or -1, denoting <tt class="docutils literal"><span class="pre">|left|-|right|</span></tt> = 1, 0, or -1,
respectively.</dd>
</dl>
<p>(This is for informational purposes only. The tree constructors are
private, and client modules must not rely on the internal representation.)</p>
</div>
<div class="section" id="id58">
<h3><a class="toc-backref" href="#id122">3.4.3&nbsp;&nbsp;&nbsp;Operations</a></h3>
<a name="emptyset"><a name="emptybag"><dl class="docutils" id="emptybag">
<span id="emptyset"></span><dt><tt class="docutils literal"><span class="pre">emptyset</span></tt>, <tt class="docutils literal"><span class="pre">emptybag</span></tt></dt>
<dd>return the empty set or bag</dd>
</dl>
<a name="set"><a name="bag"><dl class="docutils" id="bag">
<span id="set"></span><dt><tt class="docutils literal"><span class="pre">set</span> <span class="pre">xs</span></tt>, <tt class="docutils literal"><span class="pre">bag</span> <span class="pre">xs</span></tt></dt>
<dd>create a set or bag from a list <tt class="docutils literal"><span class="pre">xs</span></tt></dd>
</dl>
<a name="setp"><a name="bagp"><dl class="docutils" id="bagp">
<span id="setp"></span><dt><tt class="docutils literal"><span class="pre">setp</span> <span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">bagp</span> <span class="pre">x</span></tt></dt>
<dd>check whether <tt class="docutils literal"><span class="pre">x</span></tt> is a set or bag</dd>
</dl>
<a name="# (set)"><a name="# (bag)"><dl class="docutils" id="id60">
<span id="id59"></span><dt><tt class="docutils literal"><span class="pre">#m</span></tt></dt>
<dd>size of set or bag <tt class="docutils literal"><span class="pre">m</span></tt></dd>
</dl>
<a name="+ (set)"><a name="+ (bag)"><dl class="docutils" id="id62">
<span id="id61"></span><dt><tt class="docutils literal"><span class="pre">m1+m2</span></tt></dt>
<dd>set and bag union: <tt class="docutils literal"><span class="pre">m1+m2</span></tt> adds the members of <tt class="docutils literal"><span class="pre">m2</span></tt> to <tt class="docutils literal"><span class="pre">m1</span></tt></dd>
</dl>
<a name="- (set)"><a name="- (bag)"><dl class="docutils" id="id64">
<span id="id63"></span><dt><tt class="docutils literal"><span class="pre">m1-m2</span></tt></dt>
<dd>set and bag difference: <tt class="docutils literal"><span class="pre">m1-m2</span></tt> removes the members of <tt class="docutils literal"><span class="pre">m2</span></tt> from
<tt class="docutils literal"><span class="pre">m1</span></tt></dd>
</dl>
<a name="* (set)"><a name="* (bag)"><dl class="docutils" id="id66">
<span id="id65"></span><dt><tt class="docutils literal"><span class="pre">m1*m2</span></tt></dt>
<dd>set and bag intersection: <tt class="docutils literal"><span class="pre">m1*m2</span></tt> removes the members <em>not</em> in <tt class="docutils literal"><span class="pre">m2</span></tt>
from <tt class="docutils literal"><span class="pre">m1</span></tt></dd>
</dl>
<a name="null (set)"><a name="null (bag)"><dl class="docutils" id="null-bag">
<span id="null-set"></span><dt><tt class="docutils literal"><span class="pre">null</span> <span class="pre">m</span></tt></dt>
<dd>test whether <tt class="docutils literal"><span class="pre">m</span></tt> is the empty set or bag</dd>
</dl>
<a name="member (set)"><a name="member (bag)"><dl class="docutils" id="member-bag">
<span id="member-set"></span><dt><tt class="docutils literal"><span class="pre">member</span> <span class="pre">m</span> <span class="pre">x</span></tt></dt>
<dd>test whether <tt class="docutils literal"><span class="pre">m</span></tt> contains <tt class="docutils literal"><span class="pre">x</span></tt></dd>
</dl>
<a name="members (set)"><a name="members (bag)"><a name="list (set)"><a name="list (bag)"><dl class="docutils" id="list-bag">
<span id="list-set"></span><span id="members-bag"></span><span id="members-set"></span><dt><tt class="docutils literal"><span class="pre">members</span> <span class="pre">m</span></tt>, <tt class="docutils literal"><span class="pre">list</span> <span class="pre">m</span></tt></dt>
<dd>list members of <tt class="docutils literal"><span class="pre">m</span></tt> in ascending order</dd>
</dl>
<a name="first (set)"><a name="first (bag)"><a name="last (set)"><a name="last (bag)"><dl class="docutils" id="last-bag">
<span id="last-set"></span><span id="first-bag"></span><span id="first-set"></span><dt><tt class="docutils literal"><span class="pre">first</span> <span class="pre">m</span></tt>, <tt class="docutils literal"><span class="pre">last</span> <span class="pre">m</span></tt></dt>
<dd>return first and last member of <tt class="docutils literal"><span class="pre">m</span></tt></dd>
</dl>
<a name="rmfirst (set)"><a name="rmfirst (bag)"><a name="rmlast (set)"><a name="rmlast (bag)"><dl class="docutils" id="rmlast-bag">
<span id="rmlast-set"></span><span id="rmfirst-bag"></span><span id="rmfirst-set"></span><dt><tt class="docutils literal"><span class="pre">rmfirst</span> <span class="pre">m</span></tt>, <tt class="docutils literal"><span class="pre">rmlast</span> <span class="pre">m</span></tt></dt>
<dd>remove first and last member from <tt class="docutils literal"><span class="pre">m</span></tt></dd>
</dl>
<a name="insert (set)"><a name="insert (bag)"><dl class="docutils" id="insert-bag">
<span id="insert-set"></span><dt><tt class="docutils literal"><span class="pre">insert</span> <span class="pre">m</span> <span class="pre">x</span></tt></dt>
<dd>insert <tt class="docutils literal"><span class="pre">x</span></tt> into <tt class="docutils literal"><span class="pre">m</span></tt> (replaces an existing element in the <tt class="docutils literal"><span class="pre">set</span></tt> case)</dd>
</dl>
<a name="delete (set)"><a name="delete (bag)"><dl class="docutils" id="delete-bag">
<span id="delete-set"></span><dt><tt class="docutils literal"><span class="pre">delete</span> <span class="pre">m</span> <span class="pre">x</span></tt></dt>
<dd>remove <tt class="docutils literal"><span class="pre">x</span></tt> from <tt class="docutils literal"><span class="pre">m</span></tt> (in the <tt class="docutils literal"><span class="pre">bag</span></tt> case, only a single instance of
<tt class="docutils literal"><span class="pre">x</span></tt> is removed)</dd>
</dl>
</div>
<div class="section" id="id67">
<h3><a class="toc-backref" href="#id123">3.4.4&nbsp;&nbsp;&nbsp;Examples</a></h3>
<p>Some basic set operations:</p>
<pre class="literal-block">
&gt; let m::Set = set [5,1,3,11,3];
&gt; members m;
[1,3,5,11]
&gt; map (member m) (1..5);
[1,0,1,0,1]
&gt; members $ m+set (3..6);
[1,3,4,5,6,11]
&gt; members $ m-set (3..6);
[1,11]
&gt; members $ m*set (3..6);
[3,5]
</pre>
<p>The bag operations work in a similar fashion, but note that multiple
instances are permitted in this case, and each instance counts as a
separate member:</p>
<pre class="literal-block">
&gt; let m::Bag = bag [5,1,3,11,3];
&gt; members m;
[1,3,3,5,11]
&gt; members $ delete m 3;
[1,3,5,11]
&gt; members $ insert m 1;
[1,1,3,3,5,11]
&gt; members $ m+bag (3..6);
[1,3,3,3,4,5,5,6,11]
&gt; members $ m-bag (3..6);
[1,3,11]
&gt; members $ m*bag (3..6);
[3,5]
</pre>
<!--  -->
</div>
</div>
</div>
<div class="section" id="system-interface">
<h1><a class="toc-backref" href="#id124">4&nbsp;&nbsp;&nbsp;System Interface</a></h1>
<p>This module offers some useful system routines, straight from the C
library, as well as some convenience functions for wrapping these up in
Pure. Even the &quot;purest&quot; program needs to do some basic I/O every once in a
while, and this module provides the necessary stuff to do just that. The
operations provided in this module should work (if necessary by a suitable
emulation) on all supported systems. Most of the following functions are
extensively documented in the C library manual pages, so we concentrate on
the Pure-specific aspects here.</p>
<div class="section" id="id68">
<h2><a class="toc-backref" href="#id125">4.1&nbsp;&nbsp;&nbsp;Imports</a></h2>
<p>To use the operations of this module, add the following import declaration
to your program:</p>
<pre class="literal-block">
using system;
</pre>
<p>Some functions of the system interface are provided in separate modules;
see <a class="reference internal" href="#additional-posix-functions">Additional POSIX Functions</a> and <a class="reference internal" href="#option-parsing">Option Parsing</a>.</p>
<!--  -->
</div>
<div class="section" id="errno-and-friends">
<h2><a class="toc-backref" href="#id126">4.2&nbsp;&nbsp;&nbsp;Errno and Friends</a></h2>
<a name="errno"><a name="set_errno"><a name="perror"><a name="strerror"><dl class="docutils" id="strerror">
<span id="perror"></span><span id="set-errno"></span><span id="errno"></span><dt><tt class="docutils literal"><span class="pre">errno</span></tt>, <tt class="docutils literal"><span class="pre">set_errno</span> <span class="pre">n</span></tt>, <tt class="docutils literal"><span class="pre">perror</span> <span class="pre">msg</span></tt>, <tt class="docutils literal"><span class="pre">strerror</span> <span class="pre">n</span></tt></dt>
<dd>This value and the related routines are indispensable to give proper
diagnostics when system calls fail for some reason. Note that, by its
very nature, <tt class="docutils literal"><span class="pre">errno</span></tt> is a fairly volatile value, don't expect it to
survive a return to the command line in interactive sessions.</dd>
</dl>
<p>Example:</p>
<pre class="literal-block">
&gt; using system;
&gt; fopen &quot;junk&quot; &quot;r&quot;, perror &quot;junk&quot;;
junk: No such file or directory
fopen &quot;junk&quot; &quot;r&quot;
</pre>
<!--  -->
</div>
<div class="section" id="posix-locale">
<h2><a class="toc-backref" href="#id127">4.3&nbsp;&nbsp;&nbsp;POSIX Locale</a></h2>
<a name="setlocale"><dl class="docutils" id="setlocale">
<dt><tt class="docutils literal"><span class="pre">setlocale</span> <span class="pre">category</span> <span class="pre">locale</span></tt></dt>
<dd>Set or retrieve the current locale.</dd>
</dl>
<p>Details are platform-specific, but you can expect that at least the
categories <tt class="docutils literal"><span class="pre">LC_ALL</span></tt>, <tt class="docutils literal"><span class="pre">LC_COLLATE</span></tt>, <tt class="docutils literal"><span class="pre">LC_CTYPE</span></tt>, <tt class="docutils literal"><span class="pre">LC_MONETARY</span></tt>,
<tt class="docutils literal"><span class="pre">LC_NUMERIC</span></tt> and <tt class="docutils literal"><span class="pre">LC_TIME</span></tt> are defined, as well as the following values
for the locale parameter: <tt class="docutils literal"><span class="pre">&quot;C&quot;</span></tt> or <tt class="docutils literal"><span class="pre">&quot;POSIX&quot;</span></tt> (the default POSIX
locale), <tt class="docutils literal"><span class="pre">&quot;&quot;</span></tt> (the system default locale), and <tt class="docutils literal"><span class="pre">NULL</span></tt>, to just query
the current locale.</p>
<p>Other string values which can be passed as the locale argument depend on
the implementation, please check your local setlocale(3) documentation for
details. If locale is not <tt class="docutils literal"><span class="pre">NULL</span></tt>, the current locale is changed
accordingly. The return value is the new locale, or the current locale when
passing <tt class="docutils literal"><span class="pre">NULL</span></tt> for the locale parameter. In either case, the string
returned by <tt class="docutils literal"><span class="pre">setlocale</span></tt> is such that it can be passed to <tt class="docutils literal"><span class="pre">setlocale</span></tt> to
restore the same locale again. In case of an error, <tt class="docutils literal"><span class="pre">setlocale</span></tt> fails
(rather than returning a null pointer).</p>
<p>Please note that calling this function alters the Pure interpreter's idea
of what the current locale is. When the interpreter starts up, it always
sets the default system locale. Unless your scripts rely on a specific
encoding, setting the locale to either <tt class="docutils literal"><span class="pre">&quot;C&quot;</span></tt> or <tt class="docutils literal"><span class="pre">&quot;&quot;</span></tt> should always be
safe.</p>
<p>Example:</p>
<pre class="literal-block">
&gt; setlocale LC_ALL NULL;
&quot;en_US.UTF-8&quot;
</pre>
<!--  -->
</div>
<div class="section" id="signal-handling">
<h2><a class="toc-backref" href="#id128">4.4&nbsp;&nbsp;&nbsp;Signal Handling</a></h2>
<a name="trap"><dl class="docutils" id="trap">
<dt><tt class="docutils literal"><span class="pre">trap</span> <span class="pre">action</span> <span class="pre">sig</span></tt></dt>
<dd>Establish or remove Pure signal handlers.</dd>
</dl>
<p>The action parameter of <tt class="docutils literal"><span class="pre">trap</span></tt> can be one of the predefined integer
values <tt class="docutils literal"><span class="pre">SIG_TRAP</span></tt>, <tt class="docutils literal"><span class="pre">SIG_IGN</span></tt> and <tt class="docutils literal"><span class="pre">SIG_DFL</span></tt>. <tt class="docutils literal"><span class="pre">SIG_TRAP</span></tt> causes the
given signal to be handled by mapping it to a Pure exception of the form
<tt class="docutils literal"><span class="pre">signal</span> <span class="pre">sig</span></tt>. <tt class="docutils literal"><span class="pre">SIG_IGN</span></tt> ignores the signal, <tt class="docutils literal"><span class="pre">SIG_DFL</span></tt> reverts to the
system's default handling. See <tt class="docutils literal"><span class="pre">show</span> <span class="pre">-g</span> <span class="pre">SIG*</span></tt> for a list of known signal
values on your system.</p>
<p>Note: When the interpreter runs interactively, most standard termination
signals (<tt class="docutils literal"><span class="pre">SIGINT</span></tt>, <tt class="docutils literal"><span class="pre">SIGTERM</span></tt>, etc.) are already set up to report
corresponding Pure exceptions; if this is not desired, you can use <tt class="docutils literal"><span class="pre">trap</span></tt>
to either ignore these or revert to the default handlers instead.</p>
<p>See <a class="reference external" href="pure.html#exception-handling">Exception Handling</a> in the Pure Manual for details and examples.</p>
<!--  -->
</div>
<div class="section" id="time-functions">
<h2><a class="toc-backref" href="#id129">4.5&nbsp;&nbsp;&nbsp;Time Functions</a></h2>
<a name="time"><dl class="docutils" id="time">
<dt><tt class="docutils literal"><span class="pre">time</span></tt></dt>
<dd>Reports the current time in seconds since the <strong class="dfn">epoch</strong>, 00:00:00 UTC, Jan
1 1970. The result is always a bigint (in fact, the <tt class="docutils literal"><span class="pre">time</span></tt> value is
already 64 bit on many OSes nowadays).</dd>
</dl>
<!--  -->
<p>The following functions are provided to convert a time value to
&quot;broken-down&quot; time or a string. See the ctime(3), gmtime(3), localtime(3),
asctime(3) and strftime(3) manual pages for details.</p>
<a name="ctime"><dl class="docutils" id="ctime">
<dt><tt class="docutils literal"><span class="pre">ctime</span> <span class="pre">t</span></tt></dt>
<dd>Convert a time value as returned by the <tt class="docutils literal"><span class="pre">time</span></tt> function to a string in
local time.</dd>
</dl>
<a name="gmtime"><a name="localtime"><dl class="docutils" id="localtime">
<span id="gmtime"></span><dt><tt class="docutils literal"><span class="pre">gmtime</span> <span class="pre">t</span></tt>, <tt class="docutils literal"><span class="pre">localtime</span> <span class="pre">t</span></tt></dt>
<dd>Convert a time value to UTC or local time in &quot;broken-down&quot; form (a static
pointer to a <tt class="docutils literal"><span class="pre">tm</span></tt> struct containing a bunch of <tt class="docutils literal"><span class="pre">int</span></tt> fields) which
can then be passed to the <tt class="docutils literal"><span class="pre">asctime</span></tt> and <tt class="docutils literal"><span class="pre">strftime</span></tt> functions, or to
<a class="reference internal" href="#int-matrix"><tt class="docutils literal"><span class="pre">int_matrix</span></tt></a> if you want to convert the data to a matrix; see the
example below.</dd>
</dl>
<a name="asctime"><a name="strftime"><dl class="docutils" id="strftime">
<span id="asctime"></span><dt><tt class="docutils literal"><span class="pre">asctime</span> <span class="pre">tm</span></tt>, <tt class="docutils literal"><span class="pre">strftime</span> <span class="pre">format</span> <span class="pre">tm</span></tt></dt>
<dd>Format broken-down time as a string. <tt class="docutils literal"><span class="pre">strftime</span></tt> also uses a format
string supplied by the user.</dd>
</dl>
<p>For instance:</p>
<pre class="literal-block">
&gt; let tm = localtime time; tm;
#&lt;pointer 0x7f1292131de0&gt;
&gt; asctime tm;
&quot;Sat Mar 14 01:07:18 2009\n&quot;
&gt; int_matrix 9 tm;
{18,7,1,14,2,109,6,72,0}
</pre>
<!--  -->
<p>We also provide some functions to retrieve wallclock and cpu time which
usually offer much better resolution than <tt class="docutils literal"><span class="pre">time</span></tt>.</p>
<a name="gettimeofday"><dl class="docutils" id="gettimeofday">
<dt><tt class="docutils literal"><span class="pre">gettimeofday</span></tt></dt>
<dd>Returns wallclock time as seconds since the epoch, like <tt class="docutils literal"><span class="pre">time</span></tt>, but
theoretically offers resolutions in the microsec range (actual
resolutions vary, but are usually in the msec range for contemporary
systems). The result is returned as a double value (which also limits
precision). This function may actually be implemented through different
system calls, depending on what's available on the host OS.</dd>
</dl>
<a name="clock"><dl class="docutils" id="clock">
<dt><tt class="docutils literal"><span class="pre">clock</span></tt></dt>
<dd>Returns the current CPU (not wallclock) time since an arbitrary point in
the past, as a machine int. The number of &quot;ticks&quot; per second is given by
the <tt class="docutils literal"><span class="pre">CLOCKS_PER_SEC</span></tt> constant. Note that this value will wrap around
approximately every 72 minutes.</dd>
</dl>
<a name="sleep"><a name="nanosleep"><dl class="docutils" id="nanosleep">
<span id="sleep"></span><dt><tt class="docutils literal"><span class="pre">sleep</span> <span class="pre">t</span></tt>, <tt class="docutils literal"><span class="pre">nanosleep</span> <span class="pre">t</span></tt></dt>
<dd>Suspend execution for a given time interval in seconds. <tt class="docutils literal"><span class="pre">sleep</span></tt> takes
integer (int/bigint) arguments only and uses the <tt class="docutils literal"><span class="pre">sleep()</span></tt> system
function. <tt class="docutils literal"><span class="pre">nanosleep</span></tt> also accepts double arguments and theoretically
supports resolutions down to 1 nanosecond (again, actual resolutions
vary). This function may actually be implemented through different system
calls, depending on what's available on the host OS. Both functions
usually return zero, unless the sleep was interrupted by a signal, in
which case the time remaining to be slept is returned.</dd>
</dl>
<!--  -->
</div>
<div class="section" id="process-functions">
<h2><a class="toc-backref" href="#id130">4.6&nbsp;&nbsp;&nbsp;Process Functions</a></h2>
<p>The following process functions are available on all systems. (Some
additional process-related functions such as <tt class="docutils literal"><span class="pre">fork</span></tt>, <tt class="docutils literal"><span class="pre">kill</span></tt>, <tt class="docutils literal"><span class="pre">wait</span></tt>
and <tt class="docutils literal"><span class="pre">waitpid</span></tt> are available in the posix module, see <a class="reference internal" href="#additional-posix-functions">Additional POSIX
Functions</a>.)</p>
<a name="system"><dl class="docutils" id="system">
<dt><tt class="docutils literal"><span class="pre">system</span> <span class="pre">cmd</span></tt></dt>
<dd>Execute a shell command.</dd>
</dl>
<a name="execv"><a name="execvp"><a name="execve"><dl class="docutils" id="execve">
<span id="execvp"></span><span id="execv"></span><dt><tt class="docutils literal"><span class="pre">execv</span> <span class="pre">prog</span> <span class="pre">argv</span></tt>, <tt class="docutils literal"><span class="pre">execvp</span> <span class="pre">prog</span> <span class="pre">argv</span></tt>, <tt class="docutils literal"><span class="pre">execve</span> <span class="pre">prog</span> <span class="pre">argv</span> <span class="pre">envp</span></tt></dt>
<dd>Execute a new process. <tt class="docutils literal"><span class="pre">prog</span></tt> denotes the name of the executable to be
run, <tt class="docutils literal"><span class="pre">argv</span></tt> the argument vector (which repeats the program name in the
first component), and <tt class="docutils literal"><span class="pre">envp</span></tt> a vector of environment strings of the
form <tt class="docutils literal"><span class="pre">&quot;var=value&quot;</span></tt>. The <tt class="docutils literal"><span class="pre">execv</span></tt> function executes the program
<tt class="docutils literal"><span class="pre">prog</span></tt> exactly as given, while <tt class="docutils literal"><span class="pre">execvp</span></tt> also performs a path
search. The <tt class="docutils literal"><span class="pre">execve</span></tt> function is like <tt class="docutils literal"><span class="pre">execv</span></tt>, but also specifies an
environment to be passed to the process. In either case, the new process
replaces the current process. For convenience, both <tt class="docutils literal"><span class="pre">argv</span></tt> and <tt class="docutils literal"><span class="pre">envp</span></tt>
can be specified as Pure string lists, which are automatically translated
to the raw, <tt class="docutils literal"><span class="pre">NULL</span></tt>-terminated C string vectors (i.e., <tt class="docutils literal"><span class="pre">char**</span></tt>)
required by the underlying C functions, using the
<tt class="docutils literal"><span class="pre">byte_cstring_pointer</span></tt> function (see <a class="reference internal" href="#low-level-operations">Low-Level Operations</a> in the
<a class="reference internal" href="#string-functions">String Functions</a> section).</dd>
</dl>
<a name="spawnv"><a name="spawnvp"><a name="spawnve"><dl class="docutils" id="spawnve">
<span id="spawnvp"></span><span id="spawnv"></span><dt><tt class="docutils literal"><span class="pre">spawnv</span> <span class="pre">mode</span> <span class="pre">prog</span> <span class="pre">argv</span></tt>, <tt class="docutils literal"><span class="pre">spawnvp</span> <span class="pre">mode</span> <span class="pre">prog</span> <span class="pre">argv</span></tt>, <tt class="docutils literal"><span class="pre">spawnve</span> <span class="pre">mode</span> <span class="pre">prog</span> <span class="pre">argv</span> <span class="pre">envp</span></tt></dt>
<dd>Spawn a new child process. These work like the corresponding MS Windows
functions; on Un*x systems this functionality is implemented using a
combination of <tt class="docutils literal"><span class="pre">fork</span></tt> and <tt class="docutils literal"><span class="pre">execv</span></tt>. The arguments are the same as for
the <tt class="docutils literal"><span class="pre">execv</span></tt> functions, except that there's an additional <tt class="docutils literal"><span class="pre">mode</span></tt>
argument which specifies how the process is to be executed: <tt class="docutils literal"><span class="pre">P_WAIT</span></tt>
waits for the process to finish, after which <tt class="docutils literal"><span class="pre">spawnv</span></tt> returns with the
exit status of the terminated child process; <tt class="docutils literal"><span class="pre">P_NOWAIT</span></tt> makes
<tt class="docutils literal"><span class="pre">spawnv</span></tt> return immediately, returning the process id; and
<tt class="docutils literal"><span class="pre">P_OVERLAY</span></tt> causes the child process to replace its parent, just like
with <tt class="docutils literal"><span class="pre">execv</span></tt>. (On Windows, there's an additional <tt class="docutils literal"><span class="pre">P_DETACH</span></tt> flag
which works like <tt class="docutils literal"><span class="pre">P_NOWAIT</span></tt> but also turns the child process into a
background task.)</dd>
</dl>
<p>Note that, in addition, the prelude provides the <tt class="docutils literal"><span class="pre">exit</span></tt> function which
terminates the program with a given exit code, cf. <a class="reference internal" href="#other-special-primitives">Other Special
Primitives</a>.</p>
<p>Examples:</p>
<pre class="literal-block">
&gt; system &quot;pwd&quot;;
/home/ag/svn/pure-lang/trunk/pure/lib
0

&gt; spawnvp P_WAIT &quot;pwd&quot; [&quot;pwd&quot;];
/home/ag/svn/pure-lang/trunk/pure/lib
0
&gt; spawnv P_WAIT &quot;/bin/sh&quot; [&quot;/bin/sh&quot;,&quot;-c&quot;,&quot;pwd&quot;];
/home/ag/svn/pure-lang/trunk/pure/lib
0
</pre>
<!--  -->
</div>
<div class="section" id="basic-i-o-interface">
<h2><a class="toc-backref" href="#id131">4.7&nbsp;&nbsp;&nbsp;Basic I/O Interface</a></h2>
<p>Note that this module also defines the standard I/O streams <tt class="docutils literal"><span class="pre">stdin</span></tt>,
<tt class="docutils literal"><span class="pre">stderr</span></tt> and <tt class="docutils literal"><span class="pre">stdout</span></tt> as variables on startup. These are ready to be
used with the operations described below. Also note that for convenience
some of the following routines are actually Pure wrappers, rather than just
providing the raw C library routines.</p>
<a name="fopen"><a name="popen"><dl class="docutils" id="popen">
<span id="fopen"></span><dt><tt class="docutils literal"><span class="pre">fopen</span> <span class="pre">name</span> <span class="pre">mode</span></tt>, <tt class="docutils literal"><span class="pre">popen</span> <span class="pre">cmd</span> <span class="pre">mode</span></tt></dt>
<dd>Open a file or a pipe. These take care of closing a file object
automagically when it's garbage-collected, and fail (instead of returning
a null pointer) in case of error, so that you can provide any desired
error handling simply by adding suitable equations.</dd>
</dl>
<a name="fdopen"><dl class="docutils" id="fdopen">
<dt><tt class="docutils literal"><span class="pre">fdopen</span> <span class="pre">fd</span> <span class="pre">mode</span></tt></dt>
<dd>Associates a file object with a given existing file descriptor. Otherwise
works like <tt class="docutils literal"><span class="pre">fopen</span></tt>, so the resulting file is closed automatically when
it's garbage-collected.</dd>
</dl>
<a name="freopen"><dl class="docutils" id="freopen">
<dt><tt class="docutils literal"><span class="pre">freopen</span> <span class="pre">path</span> <span class="pre">mode</span> <span class="pre">fp</span></tt></dt>
<dd>Reopens a file object. The existing file object is closed. Otherwise
works like <tt class="docutils literal"><span class="pre">fopen</span></tt>, so the resulting file is closed automatically when
it's garbage-collected.</dd>
</dl>
<a name="fclose"><a name="pclose"><dl class="docutils" id="pclose">
<span id="fclose"></span><dt><tt class="docutils literal"><span class="pre">fclose</span> <span class="pre">fp</span></tt>, <tt class="docutils literal"><span class="pre">pclose</span> <span class="pre">fp</span></tt></dt>
<dd>Close a file or a pipe.</dd>
</dl>
<a name="tmpfile"><dl class="docutils" id="tmpfile">
<dt><tt class="docutils literal"><span class="pre">tmpfile</span></tt></dt>
<dd>Creates a unique temporary file (opened in <tt class="docutils literal"><span class="pre">&quot;w+b&quot;</span></tt> mode) which gets
deleted automatically when it is closed or the file object gets
garbage-collected.</dd>
</dl>
<a name="feof"><a name="ferror"><a name="clearerr"><dl class="docutils" id="clearerr">
<span id="ferror"></span><span id="feof"></span><dt><tt class="docutils literal"><span class="pre">feof</span> <span class="pre">fp</span></tt>, <tt class="docutils literal"><span class="pre">ferror</span> <span class="pre">fp</span></tt>, <tt class="docutils literal"><span class="pre">clearerr</span> <span class="pre">fp</span></tt></dt>
<dd>Check the end-of-file and error bits. <tt class="docutils literal"><span class="pre">clearerr</span></tt> clears the error bit.</dd>
</dl>
<a name="fileno"><dl class="docutils" id="fileno">
<dt><tt class="docutils literal"><span class="pre">fileno</span> <span class="pre">fp</span></tt></dt>
<dd>Returns the file descriptor associated with the given file.</dd>
</dl>
<a name="fflush"><dl class="docutils" id="fflush">
<dt><tt class="docutils literal"><span class="pre">fflush</span> <span class="pre">fp</span></tt></dt>
<dd>Flushes the given file (or all open files if <tt class="docutils literal"><span class="pre">fp</span></tt> is <tt class="docutils literal"><span class="pre">NULL</span></tt>).</dd>
</dl>
<a name="fgets"><a name="gets"><dl class="docutils" id="gets">
<span id="fgets"></span><dt><tt class="docutils literal"><span class="pre">fgets</span> <span class="pre">fp</span></tt>, <tt class="docutils literal"><span class="pre">gets</span></tt></dt>
<dd>Pure wrappers for the C <tt class="docutils literal"><span class="pre">fgets</span></tt> and <tt class="docutils literal"><span class="pre">gets</span></tt> functions which handle the
necessary buffering automatically.</dd>
</dl>
<a name="fget"><dl class="docutils" id="fget">
<dt><tt class="docutils literal"><span class="pre">fget</span> <span class="pre">fp</span></tt></dt>
<dd>A variation of <tt class="docutils literal"><span class="pre">fgets</span></tt> which slurps in an entire text file at once.</dd>
</dl>
<a name="fputs"><a name="puts"><dl class="docutils" id="puts">
<span id="fputs"></span><dt><tt class="docutils literal"><span class="pre">fputs</span> <span class="pre">s</span> <span class="pre">fp</span></tt>, <tt class="docutils literal"><span class="pre">puts</span> <span class="pre">s</span></tt></dt>
<dd>Output a string to the given file or <tt class="docutils literal"><span class="pre">stdout</span></tt>, respectively. These
are just the plain C functions. Note that <tt class="docutils literal"><span class="pre">puts</span></tt> automatically adds
a newline, while <tt class="docutils literal"><span class="pre">fputs</span></tt> doesn't. Hmm.</dd>
</dl>
<a name="fread"><a name="fwrite"><dl class="docutils" id="fwrite">
<span id="fread"></span><dt><tt class="docutils literal"><span class="pre">fread</span> <span class="pre">ptr</span> <span class="pre">size</span> <span class="pre">nmemb</span> <span class="pre">fp</span></tt>, <tt class="docutils literal"><span class="pre">fwrite</span> <span class="pre">ptr</span> <span class="pre">size</span> <span class="pre">nmemb</span> <span class="pre">fp</span></tt></dt>
<dd>Binary read/writes. Here you'll have to manage the buffers yourself.
See the corresponding manual pages for details.</dd>
</dl>
<a name="fseek"><a name="ftell"><a name="rewind"><dl class="docutils" id="rewind">
<span id="ftell"></span><span id="fseek"></span><dt><tt class="docutils literal"><span class="pre">fseek</span> <span class="pre">fp</span> <span class="pre">offset</span> <span class="pre">whence</span></tt>, <tt class="docutils literal"><span class="pre">ftell</span> <span class="pre">fp</span></tt>, <tt class="docutils literal"><span class="pre">rewind</span> <span class="pre">fp</span></tt></dt>
<dd>Reposition the file pointer and retrieve its current value. The constants
<tt class="docutils literal"><span class="pre">SEEK_SET</span></tt>, <tt class="docutils literal"><span class="pre">SEEK_CUR</span></tt> and <tt class="docutils literal"><span class="pre">SEEK_END</span></tt> can be used for the
<tt class="docutils literal"><span class="pre">whence</span></tt> argument of <tt class="docutils literal"><span class="pre">fseek</span></tt>. The call <tt class="docutils literal"><span class="pre">rewind</span> <span class="pre">fp</span></tt> is equivalent to
<tt class="docutils literal"><span class="pre">fseek</span> <span class="pre">fp</span> <span class="pre">0</span> <span class="pre">SEEK_SET</span></tt> (except that the latter also returns a result
code). See the corresponding manual pages for details.</dd>
</dl>
<a name="setbuf"><a name="setvbuf"><dl class="docutils" id="setvbuf">
<span id="setbuf"></span><dt><tt class="docutils literal"><span class="pre">setbuf</span> <span class="pre">fp</span> <span class="pre">buf</span></tt>, <tt class="docutils literal"><span class="pre">setvbuf</span> <span class="pre">fp</span> <span class="pre">buf</span> <span class="pre">mode</span> <span class="pre">size</span></tt></dt>
<dd><p class="first">Set the buffering of a file object, given as the first argument. The
second argument specifies the buffer, which must be a pointer to suitably
allocated memory or <tt class="docutils literal"><span class="pre">NULL</span></tt>. The <tt class="docutils literal"><span class="pre">mode</span></tt> argument of <tt class="docutils literal"><span class="pre">setvbuf</span></tt>
specifies the buffering mode, which may be one of the predefined
constants <tt class="docutils literal"><span class="pre">_IONBF</span></tt>, <tt class="docutils literal"><span class="pre">_IOLBF</span></tt> and <tt class="docutils literal"><span class="pre">_IOFBF</span></tt> denoting no buffering,
line buffering and full (a.k.a. block) buffering, respectively; the
<tt class="docutils literal"><span class="pre">size</span></tt> argument denotes the buffer size.</p>
<p>For <tt class="docutils literal"><span class="pre">setbuf</span></tt>, the given buffer must be able to hold <tt class="docutils literal"><span class="pre">BUFSIZ</span></tt>
characters, where <tt class="docutils literal"><span class="pre">BUFSIZ</span></tt> is a constant defined by this module.
<tt class="docutils literal"><span class="pre">setbuf</span> <span class="pre">fp</span> <span class="pre">buf</span></tt> is actually equivalent to the following call (except
that <tt class="docutils literal"><span class="pre">setvbuf</span></tt> also returns an integer return value):</p>
<pre class="literal-block">
setvbuf fp buf (if null buf then _IONBF else _IOFBF) BUFSIZ
</pre>
<p class="last">Please see the setbuf(3) manual page for details.</p>
</dd>
</dl>
<p>Examples:</p>
<pre class="literal-block">
&gt; puts &quot;Hello, world!&quot;;
Hello, world!
14

&gt; map fileno [stdin,stdout,stderr];
[0,1,2]

&gt; let fp = fopen &quot;/etc/passwd&quot; &quot;r&quot;;
&gt; fgets fp;
&quot;at:x:25:25:Batch jobs daemon:/var/spool/atjobs:/bin/bash\n&quot;
&gt; fgets fp;
&quot;avahi:x:103:104:User for Avahi:/var/run/avahi-daemon:/bin/false\n&quot;
&gt; ftell fp;
121L
&gt; rewind fp;
()
&gt; fgets fp;
&quot;at:x:25:25:Batch jobs daemon:/var/spool/atjobs:/bin/bash\n&quot;

&gt; split &quot;\n&quot; $ fget $ popen &quot;ls *.pure&quot; &quot;r&quot;;
[&quot;array.pure&quot;,&quot;dict.pure&quot;,&quot;getopt.pure&quot;,&quot;heap.pure&quot;,&quot;math.pure&quot;,
&quot;matrices.pure&quot;,&quot;prelude.pure&quot;,&quot;primitives.pure&quot;,&quot;quasiquote2.pure&quot;,
&quot;quasiquote.pure&quot;,&quot;set.pure&quot;,&quot;strings.pure&quot;,&quot;system.pure&quot;,&quot;&quot;]
</pre>
<!--  -->
<p>C-style formatted I/O is provided through the following wrappers for the C
<tt class="docutils literal"><span class="pre">printf</span></tt> and <tt class="docutils literal"><span class="pre">scanf</span></tt> functions. Our wrapper functions take or return a
tuple of values, and check these against the format specifiers, so they
shouldn't segfault. However, only simple formats derived from <tt class="docutils literal"><span class="pre">%cdioux</span></tt>,
<tt class="docutils literal"><span class="pre">%efg</span></tt>, <tt class="docutils literal"><span class="pre">%s</span></tt> and <tt class="docutils literal"><span class="pre">%p</span></tt> are supported right now.</p>
<a name="printf"><a name="fprintf"><dl class="docutils" id="fprintf">
<span id="printf"></span><dt><tt class="docutils literal"><span class="pre">printf</span> <span class="pre">format</span> <span class="pre">args</span></tt>, <tt class="docutils literal"><span class="pre">fprintf</span> <span class="pre">fp</span> <span class="pre">format</span> <span class="pre">args</span></tt></dt>
<dd>Print a formatted string to <tt class="docutils literal"><span class="pre">stdout</span></tt> or the given file, respectively.
Normally, these functions return the result of the underlying C routines
(number of characters written, or negative on error). However, in case of
an abnormal condition in the wrapper function (error in format string,
argument mismatch), they will throw an exception.</dd>
</dl>
<a name="sprintf"><dl class="docutils" id="sprintf">
<dt><tt class="docutils literal"><span class="pre">sprintf</span> <span class="pre">format</span> <span class="pre">args</span></tt></dt>
<dd>Print a formatted string to a buffer and return the result as a string.
Unlike the C routine, this wrapper just returns the string result, or a
null pointer in case of an error; otherwise, the error handling is the
same as with <tt class="docutils literal"><span class="pre">printf</span></tt> and <tt class="docutils literal"><span class="pre">fprintf</span></tt>. The implementation actually uses
the C routine <tt class="docutils literal"><span class="pre">snprintf</span></tt> for safety, and a suitable output buffer is
provided automatically.</dd>
</dl>
<a name="scanf"><a name="fscanf"><dl class="docutils" id="fscanf">
<span id="scanf"></span><dt><tt class="docutils literal"><span class="pre">scanf</span> <span class="pre">format</span></tt>, <tt class="docutils literal"><span class="pre">fscanf</span> <span class="pre">fp</span> <span class="pre">format</span></tt></dt>
<dd>Read formatted input from <tt class="docutils literal"><span class="pre">stdin</span></tt> or the given file, respectively.
These normally return a tuple (or singleton) with the converted
values. An exception of the form <tt class="docutils literal"><span class="pre">scanf_error</span> <span class="pre">ret</span></tt>, where <tt class="docutils literal"><span class="pre">ret</span></tt> is
the tuple of successfully converted values (which may be less than the
number of requested input items), is thrown if end-of-file was met or
another error occurred while still reading. The handling of other
abnormal conditions (e.g., error in format string) is analogous to
<tt class="docutils literal"><span class="pre">printf</span></tt> et al. Also note that our implementation here doesn't accept
any of the length modifiers used by the C routines. Floating point values
will <em>always</em> be read in double precision, so you just specify <tt class="docutils literal"><span class="pre">&quot;e&quot;</span></tt>,
<tt class="docutils literal"><span class="pre">&quot;g&quot;</span></tt> etc. for these. However, the &quot;assignment suppression&quot; flag
<tt class="docutils literal"><span class="pre">&quot;*&quot;</span></tt> <em>is</em> understood; the corresponding items will not be returned.</dd>
</dl>
<a name="sscanf"><dl class="docutils" id="sscanf">
<dt><tt class="docutils literal"><span class="pre">sscanf</span> <span class="pre">s</span> <span class="pre">format</span></tt></dt>
<dd>This works exactly like <tt class="docutils literal"><span class="pre">fscanf</span></tt>, but input comes from a string (first
argument) rather than a file.</dd>
</dl>
<p>Examples:</p>
<pre class="literal-block">
&gt; do (printf &quot;%s%d\n&quot;) [(&quot;foo&quot;,5),(&quot;catch&quot;,22)];
foo5
catch22
()
&gt; sscanf &quot;foo 5 22&quot; &quot;%s %d %g&quot;;
&quot;foo&quot;,5,22.0
</pre>
<!--  -->
</div>
<div class="section" id="stat-and-friends">
<h2><a class="toc-backref" href="#id132">4.8&nbsp;&nbsp;&nbsp;Stat and Friends</a></h2>
<a name="stat"><dl class="docutils" id="stat">
<dt><tt class="docutils literal"><span class="pre">stat</span> <span class="pre">path</span></tt></dt>
<dd>Return information about the given file. This is a simple wrapper around
the corresponding system call, see the stat(2) manual page for
details. The function returns a tuple with the most important fields from
the <tt class="docutils literal"><span class="pre">stat</span></tt> structure, in this order: <tt class="docutils literal"><span class="pre">st_dev</span></tt>, <tt class="docutils literal"><span class="pre">st_ino</span></tt>,
<tt class="docutils literal"><span class="pre">st_mode</span></tt>, <tt class="docutils literal"><span class="pre">st_nlink</span></tt>, <tt class="docutils literal"><span class="pre">st_uid</span></tt>, <tt class="docutils literal"><span class="pre">st_gid</span></tt>, <tt class="docutils literal"><span class="pre">st_rdev</span></tt>,
<tt class="docutils literal"><span class="pre">st_size</span></tt>, <tt class="docutils literal"><span class="pre">st_atime</span></tt>, <tt class="docutils literal"><span class="pre">st_mtime</span></tt>, <tt class="docutils literal"><span class="pre">st_ctime</span></tt>. Among these,
<tt class="docutils literal"><span class="pre">st_mode</span></tt>, <tt class="docutils literal"><span class="pre">st_nlink</span></tt>, <tt class="docutils literal"><span class="pre">st_uid</span></tt> and <tt class="docutils literal"><span class="pre">st_gid</span></tt> are simple machine
integers, the rest is encoded as bigints (even on 32 bit platforms).</dd>
</dl>
<a name="lstat"><dl class="docutils" id="lstat">
<dt><tt class="docutils literal"><span class="pre">lstat</span> <span class="pre">path</span></tt></dt>
<dd>Return information about the given symbolic link (rather than the file
it points to). On systems where this function isn't supported (e.g.,
Windows), <tt class="docutils literal"><span class="pre">lstat</span></tt> is identical to <tt class="docutils literal"><span class="pre">stat</span></tt>.</dd>
</dl>
<a name="fstat"><dl class="docutils" id="fstat">
<dt><tt class="docutils literal"><span class="pre">fstat</span> <span class="pre">fp</span></tt></dt>
<dd>Return information about the given file object. Same as <tt class="docutils literal"><span class="pre">stat</span></tt>, but
here the file is given as a file pointer created with <tt class="docutils literal"><span class="pre">fopen</span></tt> (see
<a class="reference internal" href="#basic-i-o-interface">Basic I/O Interface</a> above). Note that the corresponding system
function actually takes a file descriptor, so the Pure implementation is
equivalent to the C call <tt class="docutils literal"><span class="pre">fstat(fileno(fp))</span></tt>. This function might not
be supported on all platforms.</dd>
</dl>
<p>For average applications, the most interesting fields are <tt class="docutils literal"><span class="pre">st_mode</span></tt> and
<tt class="docutils literal"><span class="pre">st_size</span></tt>, which can be retrieved with <tt class="docutils literal"><span class="pre">stat</span> <span class="pre">filename!![2,7]</span></tt>. Note
that to facilitate access to the <tt class="docutils literal"><span class="pre">st_mode</span></tt> field, the usual masks and
bits for file types (<tt class="docutils literal"><span class="pre">S_IFMT</span></tt>, <tt class="docutils literal"><span class="pre">S_IFREG</span></tt>, etc.) and permissions
(<tt class="docutils literal"><span class="pre">S_ISUID</span></tt>, <tt class="docutils literal"><span class="pre">S_ISGID</span></tt>, <tt class="docutils literal"><span class="pre">S_IRWXU</span></tt>, etc.) are defined as constants by
this module.  Use the command <tt class="docutils literal"><span class="pre">show</span> <span class="pre">-g</span> <span class="pre">S_*</span></tt> in the interpreter to get a
full list of these. Other interesting fields are <tt class="docutils literal"><span class="pre">st_atime</span></tt>, <tt class="docutils literal"><span class="pre">st_mtime</span></tt>
and <tt class="docutils literal"><span class="pre">st_ctime</span></tt>, which can be accessed using <tt class="docutils literal"><span class="pre">stat</span> <span class="pre">filename!!(8..10)</span></tt>.
The values of these fields are the times of last access, last modification
and creation, respectively, which can be decoded using the appropriate time
functions like <tt class="docutils literal"><span class="pre">ctime</span></tt> or <tt class="docutils literal"><span class="pre">strftime</span></tt>, see <a class="reference internal" href="#time-functions">Time Functions</a>.</p>
<p>Examples:</p>
<pre class="literal-block">
&gt; stat &quot;/etc/passwd&quot;;
64773L,9726294L,33188,1,0,0,0L,1623L,1250373163L,1242692339L,1242692339L
&gt; stat &quot;/etc/passwd&quot;!7;                                // file size
1623L
&gt; strftime &quot;%c&quot; $ localtime $ stat &quot;/etc/passwd&quot;!10;   // creation time
&quot;Tue 19 May 2009 02:18:59 AM CEST&quot;
&gt; sprintf &quot;0%o&quot; $ stat &quot;/etc/passwd&quot;!2 and not S_IFMT; // permissions
&quot;0644&quot;
&gt; stat &quot;/etc/passwd&quot;!2 and S_IFMT == S_IFREG; // this is a regular file
1
&gt; stat &quot;/etc&quot;!2 and S_IFMT == S_IFDIR;        // this is a directory
1
</pre>
<!--  -->
</div>
<div class="section" id="readdir">
<h2><a class="toc-backref" href="#id133">4.9&nbsp;&nbsp;&nbsp;Readdir</a></h2>
<a name="readdir"><dl class="docutils" id="id69">
<dt><tt class="docutils literal"><span class="pre">readdir</span> <span class="pre">name</span></tt></dt>
<dd>Read the contents of the given directory and return the names of all
its entries as a list.</dd>
</dl>
<p>Example:</p>
<pre class="literal-block">
&gt; readdir &quot;/home&quot;;
[&quot;ag&quot;,&quot;.&quot;,&quot;..&quot;]
</pre>
<!--  -->
</div>
<div class="section" id="shell-globbing">
<h2><a class="toc-backref" href="#id134">4.10&nbsp;&nbsp;&nbsp;Shell Globbing</a></h2>
<a name="fnmatch"><dl class="docutils" id="fnmatch">
<dt><tt class="docutils literal"><span class="pre">fnmatch</span> <span class="pre">pat</span> <span class="pre">s</span> <span class="pre">flags</span></tt></dt>
<dd>Returns a simple truth value (1 if <tt class="docutils literal"><span class="pre">pat</span></tt> matches <tt class="docutils literal"><span class="pre">s</span></tt>, 0 if it
doesn't), instead of an error code like the C function.</dd>
</dl>
<a name="glob"><dl class="docutils" id="glob">
<dt><tt class="docutils literal"><span class="pre">glob</span> <span class="pre">pat</span> <span class="pre">flags</span></tt></dt>
<dd>Returns a Pure list with the matches (unless there is an error in which
case the integer result code of the underlying C routine is returned).</dd>
</dl>
<p>The available flag values and glob error codes are available as symbolic
<tt class="docutils literal"><span class="pre">FNM_*</span></tt> and <tt class="docutils literal"><span class="pre">GLOB_*</span></tt> constants defined as variables in the global
environment. See the fnmatch(3) and glob(3) manpages for the meaning of
these. (In extension to POSIX, Pure also provides the constant
<tt class="docutils literal"><span class="pre">GLOB_SIZE</span></tt> which indicates the buffer size required for C <tt class="docutils literal"><span class="pre">glob</span></tt>'s
<tt class="docutils literal"><span class="pre">globptr</span></tt> argument, but this is only used internally.)</p>
<p>Example:</p>
<pre class="literal-block">
&gt; glob &quot;*.pure&quot; 0;
[&quot;array.pure&quot;,&quot;dict.pure&quot;,&quot;getopt.pure&quot;,&quot;heap.pure&quot;,&quot;math.pure&quot;,
&quot;matrices.pure&quot;,&quot;prelude.pure&quot;,&quot;primitives.pure&quot;,&quot;set.pure&quot;,
&quot;strings.pure&quot;,&quot;system.pure&quot;]
</pre>
<!--  -->
</div>
<div class="section" id="regex-matching">
<h2><a class="toc-backref" href="#id135">4.11&nbsp;&nbsp;&nbsp;Regex Matching</a></h2>
<p>The POSIX regex functions (<tt class="docutils literal"><span class="pre">regcomp</span></tt> and <tt class="docutils literal"><span class="pre">regexec</span></tt>) have a somewhat
difficult calling sequence, hence we provide a couple of rather elaborate
high-level wrapper functions for use in Pure programs. These are
implemented in terms of a low-level interface provided in the runtime. (The
low-level interface isn't documented here, but these functions are also
callable if you want to create your own regular expression engines in Pure.
You might wish to take a look at the implementation of the high-level
functions in system.pure to see how this can be done.)</p>
<a name="regex"><dl class="docutils" id="regex">
<dt><tt class="docutils literal"><span class="pre">regex</span> <span class="pre">pat</span> <span class="pre">cflags</span> <span class="pre">s</span> <span class="pre">eflags</span></tt></dt>
<dd>Compiles and matches a regex in one go, and returns the list of
submatches (if any).</dd>
</dl>
<p>The arguments are:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">pat::string</span></tt>, the regular expression pattern;</li>
<li><tt class="docutils literal"><span class="pre">cflags::int</span></tt>, the compilation flags (bitwise or of any of the flags
accepted by regcomp(3));</li>
<li><tt class="docutils literal"><span class="pre">s::string</span></tt>, the subject string to be matched;</li>
<li><tt class="docutils literal"><span class="pre">eflags::int</span></tt>, the matching execution flags (bitwise or of any of the
flags accepted by regexec(3)).</li>
</ul>
<p>Symbolic <tt class="docutils literal"><span class="pre">REG_*</span></tt> constants are provided for the different flag values,
see the regcomp(3) manpage for an explanation of these. Two particularly
important compilation flags (to be included in the <tt class="docutils literal"><span class="pre">cflags</span></tt> argument) are
<tt class="docutils literal"><span class="pre">REG_NOSUB</span></tt>, which prevents submatches to be computed, and
<tt class="docutils literal"><span class="pre">REG_EXTENDED</span></tt>, which switches <tt class="docutils literal"><span class="pre">regex</span></tt> from &quot;basic&quot; to &quot;extended&quot;
regular expressions so that it understands all the regular expression
elements of egrep(1) in the pattern argument.</p>
<p>Depending on the flags and the outcome of the operation, the result of this
function can take one of the following forms:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">regerr</span> <span class="pre">code</span> <span class="pre">msg</span></tt>: This indicates an error during compilation of the
pattern (e.g., if there was a syntax error in the pattern). <tt class="docutils literal"><span class="pre">code</span></tt> is
the nonzero integer code returned by <tt class="docutils literal"><span class="pre">regcomp</span></tt>, and <tt class="docutils literal"><span class="pre">msg</span></tt> is the
corresponding error message string, as returned by <tt class="docutils literal"><span class="pre">regerror</span></tt>. You can
redefine the <tt class="docutils literal"><span class="pre">regerr</span></tt> function as appropriate for your application
(e.g., if you'd like to print an error message or throw an exception).</li>
<li><tt class="docutils literal"><span class="pre">0</span></tt> or <tt class="docutils literal"><span class="pre">1</span></tt>: Just a truth value indicates whether the pattern matched
or not. This will be the form of the result if the <tt class="docutils literal"><span class="pre">REG_NOSUB</span></tt> flag was
specified for compilation, indicating that no submatch information is to
be computed.</li>
<li><tt class="docutils literal"><span class="pre">0</span></tt> (indicating no match), or <tt class="docutils literal"><span class="pre">1</span></tt> (indicating a successful match),
where the latter value is followed by a tuple of <tt class="docutils literal"><span class="pre">(pos,substr)</span></tt> pairs
for each submatch. This will be the form of the result only if the
<tt class="docutils literal"><span class="pre">REG_NOSUB</span></tt> flag was <em>not</em> specified for compilation, so that submatch
information is available.</li>
</ul>
<p>Note that, according to POSIX semantics, a return value of 1 does <em>not</em>
generally mean that the entire subject string was matched, unless you
explicitly tie the pattern to the beginning (<tt class="docutils literal"><span class="pre">^</span></tt>) and end (<tt class="docutils literal"><span class="pre">$</span></tt>) of the
string.</p>
<p>If the result takes the latter form, each <tt class="docutils literal"><span class="pre">(pos,substr)</span></tt> pair indicates a
portion of the subject string which was matched; <tt class="docutils literal"><span class="pre">pos</span></tt> is the position at
which the match starts, and <tt class="docutils literal"><span class="pre">substr</span></tt> is the substring (starting at
position <tt class="docutils literal"><span class="pre">pos</span></tt>) which was matched. The first <tt class="docutils literal"><span class="pre">(pos,substr)</span></tt> pair always
indicates which portion of the string was matched by the entire pattern,
the remaining pairs represent submatches for the parenthesized subpatterns
of the pattern, as described on the regcomp(3) manual page. Note that some
submatches may be empty (if they matched the empty string), in which case a
pair <tt class="docutils literal"><span class="pre">(pos,&quot;&quot;)</span></tt> indicates the (nonnegative) position <tt class="docutils literal"><span class="pre">pos</span></tt> where the
subpattern matched the empty string. Other submatches may not participate
in the match at all, in which case the pair <tt class="docutils literal"><span class="pre">(-1,&quot;&quot;)</span></tt> is returned.</p>
<!--  -->
<p>The following helper functions are provided to analyze the result returned
by <tt class="docutils literal"><span class="pre">regex</span></tt>.</p>
<a name="reg_result"><dl class="docutils" id="reg-result">
<dt><tt class="docutils literal"><span class="pre">reg_result</span> <span class="pre">res</span></tt></dt>
<dd>Returns the result of a <tt class="docutils literal"><span class="pre">regex</span></tt> call, i.e., a <tt class="docutils literal"><span class="pre">regerr</span></tt> term if
compilation failed, and a flag indicating whether the match was
successful otherwise.</dd>
</dl>
<a name="reg_info"><dl class="docutils" id="reg-info">
<dt><tt class="docutils literal"><span class="pre">reg_info</span> <span class="pre">res</span></tt></dt>
<dd>Returns the submatch info if any, otherwise it returns <tt class="docutils literal"><span class="pre">()</span></tt>.</dd>
</dl>
<a name="reg"><dl class="docutils" id="reg">
<dt><tt class="docutils literal"><span class="pre">reg</span> <span class="pre">n</span> <span class="pre">info</span></tt></dt>
<dd>Returns the <tt class="docutils literal"><span class="pre">n</span></tt>th submatch of the given submatch info, where <tt class="docutils literal"><span class="pre">info</span></tt>
is the result of a <tt class="docutils literal"><span class="pre">reg_info</span></tt> call.</dd>
</dl>
<a name="regs"><dl class="docutils" id="regs">
<dt><tt class="docutils literal"><span class="pre">regs</span> <span class="pre">info</span></tt></dt>
<dd>Returns all valid submatches, i.e., the list of all triples <tt class="docutils literal"><span class="pre">(n,p,s)</span></tt>
for which <tt class="docutils literal"><span class="pre">reg</span> <span class="pre">n</span> <span class="pre">==</span> <span class="pre">(p,s)</span></tt> with <tt class="docutils literal"><span class="pre">p&gt;=0</span></tt>.</dd>
</dl>
<!--  -->
<p>In addition, the following convenience functions are provided to perform
global regex searches, to perform substitutions, and to tokenize a string
according to a given delimiter regex.</p>
<a name="regexg"><dl class="docutils" id="regexg">
<dt><tt class="docutils literal"><span class="pre">regexg</span> <span class="pre">f</span> <span class="pre">pat</span> <span class="pre">cflags</span> <span class="pre">s</span> <span class="pre">eflags</span></tt></dt>
<dd>Perform a global regular expression search. This routine will scan the
entire string for (non-overlapping) instances of the pattern, applies the
given function <tt class="docutils literal"><span class="pre">f</span></tt> to the <tt class="docutils literal"><span class="pre">reg_info</span></tt> for each match, and collects all
results in a list. Note: Never specify the <tt class="docutils literal"><span class="pre">REG_NOSUB</span></tt> flag with this
function, it needs the submatch info.</dd>
</dl>
<a name="regexgg"><dl class="docutils" id="regexgg">
<dt><tt class="docutils literal"><span class="pre">regexgg</span> <span class="pre">f</span> <span class="pre">pat</span> <span class="pre">cflags</span> <span class="pre">s</span> <span class="pre">eflags</span></tt></dt>
<dd>This works like <tt class="docutils literal"><span class="pre">regexg</span></tt>, but allows overlapping matches.</dd>
</dl>
<a name="regsub"><dl class="docutils" id="regsub">
<dt><tt class="docutils literal"><span class="pre">regsub</span> <span class="pre">f</span> <span class="pre">pat</span> <span class="pre">cflags</span> <span class="pre">s</span> <span class="pre">eflags</span></tt></dt>
<dd>Replaces all non-overlapping instances of a pattern with a computed
substitution string. To these ends, the given function <tt class="docutils literal"><span class="pre">f</span></tt> is applied
to the <tt class="docutils literal"><span class="pre">reg_info</span></tt> for each match. The result string is then obtained by
concatenating <tt class="docutils literal"><span class="pre">f</span> <span class="pre">info</span></tt> for all matches, with the unmatched portions of
the string in between. To make this work, <tt class="docutils literal"><span class="pre">f</span></tt> must always return a
string value; otherwise, <tt class="docutils literal"><span class="pre">regsub</span></tt> throws a <tt class="docutils literal"><span class="pre">bad_string_value</span></tt>
exception.</dd>
</dl>
<a name="regsplit"><dl class="docutils" id="regsplit">
<dt><tt class="docutils literal"><span class="pre">regsplit</span> <span class="pre">pat</span> <span class="pre">cflags</span> <span class="pre">s</span> <span class="pre">eflags</span></tt></dt>
<dd>Splits a string into constituents delimited by substrings matching the
given pattern.</dd>
</dl>
<!--  -->
<p>Please note that these operations all operate in an eager fashion, i.e.,
they process the entire input string in one go. This may be unwieldy or at
least inefficient for huge amounts of text. As a remedy, the following lazy
alternatives are available:</p>
<a name="regexgs"><a name="regexggs"><a name="regsplits"><p id="regsplits"><span id="regexggs"></span><span id="regexgs"></span><tt class="docutils literal"><span class="pre">regexgs</span> <span class="pre">f</span> <span class="pre">pat</span> <span class="pre">cflags</span> <span class="pre">s</span> <span class="pre">eflags</span></tt></p>
<p><tt class="docutils literal"><span class="pre">regexggs</span> <span class="pre">f</span> <span class="pre">pat</span> <span class="pre">cflags</span> <span class="pre">s</span> <span class="pre">eflags</span></tt></p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">regsplits</span> <span class="pre">pat</span> <span class="pre">cflags</span> <span class="pre">s</span> <span class="pre">eflags</span></tt></dt>
<dd>These work like <tt class="docutils literal"><span class="pre">regexg</span></tt>, <tt class="docutils literal"><span class="pre">regexgg</span></tt> and <tt class="docutils literal"><span class="pre">regsplit</span></tt> above, but
return a stream result which enables you to process the matches one by
one, using &quot;call by need&quot; evaluation.</dd>
</dl>
<!--  -->
<div class="section" id="basic-examples">
<h3><a class="toc-backref" href="#id136">4.11.1&nbsp;&nbsp;&nbsp;Basic Examples</a></h3>
<p>Let's have a look at some simple examples:</p>
<pre class="literal-block">
&gt; let pat = &quot;[[:alpha:]][[:alnum:]]*&quot;;
&gt; let s = &quot;1var foo 99 BAR $%&amp;&quot;;
</pre>
<p>Simple match:</p>
<pre class="literal-block">
&gt; regex pat 0 s 0;
1,1,&quot;var&quot;
</pre>
<p>Same without match info:</p>
<pre class="literal-block">
&gt; regex pat REG_NOSUB s 0;
1
</pre>
<p>Global match, return the list of all matches:</p>
<pre class="literal-block">
&gt; regexg id pat 0 s 0;
[(1,&quot;var&quot;),(5,&quot;foo&quot;),(12,&quot;BAR&quot;)]
</pre>
<p>Same with overlapping matches:</p>
<pre class="literal-block">
&gt; regexgg id pat 0 s 0;
[(1,&quot;var&quot;),(2,&quot;ar&quot;),(3,&quot;r&quot;),(5,&quot;foo&quot;),(6,&quot;oo&quot;),(7,&quot;o&quot;),(12,&quot;BAR&quot;),
(13,&quot;AR&quot;),(14,&quot;R&quot;)]
</pre>
<p>Note that <tt class="docutils literal"><span class="pre">id</span></tt> (the identity function) in the examples above can be
replaced with an arbitrary function which processes the matches. For
instance, if we only want the matched strings instead of the full match
info:</p>
<pre class="literal-block">
&gt; regexg (!1) pat 0 s 0;
[&quot;var&quot;,&quot;foo&quot;,&quot;BAR&quot;]
</pre>
<p>Lazy versions of both <tt class="docutils literal"><span class="pre">regexg</span></tt> and <tt class="docutils literal"><span class="pre">regexgg</span></tt> are provided which return
the result as a stream instead. These can be processed in a &quot;call by need&quot;
fashion:</p>
<pre class="literal-block">
&gt; regexgs id pat 0 s 0;
(1,&quot;var&quot;):#&lt;thunk 0x7fb1b7976750&gt;
&gt; last ans;
12,&quot;BAR&quot;
</pre>
<p>Let's verify that the processing is really done lazily:</p>
<pre class="literal-block">
&gt; test x = printf &quot;got: %s\n&quot; (str x) $$ x;
&gt; let xs = regexgs test pat 0 s 0;
got: 1,&quot;var&quot;
&gt; xs!1;
got: 5,&quot;foo&quot;
5,&quot;foo&quot;
&gt; last xs;
got: 12,&quot;BAR&quot;
12,&quot;BAR&quot;
</pre>
<p>As you can see, the first match is produced immediately, while the
remaining matches are processed as the result stream is traversed. This is
most useful if you have to deal with bigger amounts of text. By processing
the result stream in a piecemeal fashion, you can avoid keeping the entire
result list in memory. For instance, compare the following:</p>
<pre class="literal-block">
&gt; let s2 = fget $ fopen &quot;system.pure&quot; &quot;r&quot;;
&gt; stats -m
&gt; #regexg id pat 0 s2 0;
7977
0.18s, 55847 cells
&gt; #regexgs id pat 0 s2 0;
7977
0.12s, 20 cells
</pre>
</div>
<div class="section" id="regex-substitutions-and-splitting">
<h3><a class="toc-backref" href="#id137">4.11.2&nbsp;&nbsp;&nbsp;Regex Substitutions and Splitting</a></h3>
<p>We can also perform substitutions on matches:</p>
<pre class="literal-block">
&gt; regsub (sprintf &quot;&lt;%d:%s&gt;&quot;) pat 0 s 0;
&quot;1&lt;1:var&gt; &lt;5:foo&gt; 99 &lt;12:BAR&gt; $%&amp;&quot;
</pre>
<p>Or split a string using a delimiter pattern (this uses an egrep pattern):</p>
<pre class="literal-block">
&gt; let delim = &quot;[[:space:]]+&quot;;
&gt; regsplit delim REG_EXTENDED s 0;
[&quot;1var&quot;,&quot;foo&quot;,&quot;99&quot;,&quot;BAR&quot;,&quot;$%&amp;&quot;]
&gt; regsplit delim REG_EXTENDED &quot;The   quick brown    fox&quot; 0;
[&quot;The&quot;,&quot;quick&quot;,&quot;brown&quot;,&quot;fox&quot;]
</pre>
<p>The <tt class="docutils literal"><span class="pre">regsplit</span></tt> operation also has a lazy variation:</p>
<pre class="literal-block">
&gt; regsplits &quot;[[:space:]]+&quot; REG_EXTENDED &quot;The   quick brown    fox&quot; 0;
&quot;The&quot;:#&lt;thunk 0x7fb1b79775b0&gt;
&gt; last ans;
&quot;fox&quot;
</pre>
</div>
<div class="section" id="empty-matches">
<h3><a class="toc-backref" href="#id138">4.11.3&nbsp;&nbsp;&nbsp;Empty Matches</a></h3>
<p>Empty matches are permitted, too, subject to the constraint that at most
one match is reported for each position (which also prevents looping). And
of course an empty match will only be reported if nothing else matches. For
instance:</p>
<pre class="literal-block">
&gt; regexg id &quot;&quot; REG_EXTENDED &quot;foo&quot; 0;
[(0,&quot;&quot;),(1,&quot;&quot;),(2,&quot;&quot;),(3,&quot;&quot;)]
&gt; regexg id &quot;o*&quot; REG_EXTENDED &quot;foo&quot; 0;
[(0,&quot;&quot;),(1,&quot;oo&quot;),(3,&quot;&quot;)]
&gt; regexgg id &quot;o*&quot; REG_EXTENDED &quot;foo&quot; 0;
[(0,&quot;&quot;),(1,&quot;oo&quot;),(2,&quot;o&quot;),(3,&quot;&quot;)]
</pre>
<p>This also works when substituting or splitting:</p>
<pre class="literal-block">
&gt; regsub (cst &quot; &quot;) &quot;&quot; REG_EXTENDED &quot;some text&quot; 0;
&quot; s o m e   t e x t &quot;
&gt; regsub (cst &quot; &quot;) &quot; ?&quot; REG_EXTENDED &quot;some text&quot; 0;
&quot; s o m e  t e x t &quot;
&gt; regsplit &quot;&quot; REG_EXTENDED &quot;some text&quot; 0;
[&quot;&quot;,&quot;s&quot;,&quot;o&quot;,&quot;m&quot;,&quot;e&quot;,&quot; &quot;,&quot;t&quot;,&quot;e&quot;,&quot;x&quot;,&quot;t&quot;,&quot;&quot;]
&gt; regsplit &quot; ?&quot; REG_EXTENDED &quot;some text&quot; 0;
[&quot;&quot;,&quot;s&quot;,&quot;o&quot;,&quot;m&quot;,&quot;e&quot;,&quot;&quot;,&quot;t&quot;,&quot;e&quot;,&quot;x&quot;,&quot;t&quot;,&quot;&quot;]
</pre>
</div>
<div class="section" id="submatches">
<h3><a class="toc-backref" href="#id139">4.11.4&nbsp;&nbsp;&nbsp;Submatches</a></h3>
<p>Parenthesized subexpressions in a pattern yield corresponding submatch
information, which is useful if we need to retrieve the text matched by a
given subexpression. For instance, suppose we want to parse environment
lines, such as those returned by the shell's <tt class="docutils literal"><span class="pre">set</span></tt> command. These can be
dissected using the following regex:</p>
<pre class="literal-block">
&gt; const env_pat = &quot;^([^=]+)=(.*)$&quot;;
&gt; const env_flags = REG_EXTENDED or REG_NEWLINE;
&gt; regex env_pat env_flags &quot;SHELL=/bin/sh&quot; 0;
1,0,&quot;SHELL=/bin/sh&quot;,0,&quot;SHELL&quot;,6,&quot;/bin/sh&quot;
</pre>
<p>Note that we again used an extended regex here, and we also added the
<tt class="docutils literal"><span class="pre">REG_NEWLINE</span></tt> flag so that we properly deal with multiline input. The
desired information is in the 4th and 6th element of the submatch info,
we can retrieve that as follows:</p>
<pre class="literal-block">
&gt; parse_env s = regexg (\info -&gt; info!3 =&gt; info!5) env_pat env_flags s 0;
&gt; parse_env &quot;SHELL=/bin/sh\nHOME=/home/bar\n&quot;;
[&quot;SHELL&quot;=&gt;&quot;/bin/sh&quot;,&quot;HOME&quot;=&gt;&quot;/home/bar&quot;]
</pre>
<p>We can get hold of the real process environment as follows:</p>
<pre class="literal-block">
&gt; let env = parse_env $ fget $ popen &quot;set&quot; &quot;r&quot;;
&gt; #env;
109
&gt; head env;
&quot;BASH&quot;=&gt;&quot;/usr/bin/sh&quot;
</pre>
<p>Just for the fun of it, let's convert this to a record, providing easy
random access to the environment variables:</p>
<pre class="literal-block">
&gt; let env = record env;
&gt; env!![&quot;SHELL&quot;,&quot;HOME&quot;];
{&quot;/bin/bash&quot;,&quot;/home/ag&quot;}
</pre>
<!--  -->
</div>
</div>
<div class="section" id="additional-posix-functions">
<h2><a class="toc-backref" href="#id140">4.12&nbsp;&nbsp;&nbsp;Additional POSIX Functions</a></h2>
<p>The posix module provides some additional POSIX functions not available on
all supported systems. (In particular, none of these functions are provided
on MS Windows.) You can load this module in addition to the system module
if you need the additional functionality. To use the operations of this
module, add the following import declaration to your program:</p>
<pre class="literal-block">
using posix;
</pre>
<p>The following operations are provided. Please see the appropriate POSIX
manual pages for a closer description of these functions.</p>
<a name="fork"><dl class="docutils" id="fork">
<dt><tt class="docutils literal"><span class="pre">fork</span></tt></dt>
<dd>Fork a new process.</dd>
</dl>
<a name="getpid"><a name="getppid"><dl class="docutils" id="getppid">
<span id="getpid"></span><dt><tt class="docutils literal"><span class="pre">getpid</span></tt>, <tt class="docutils literal"><span class="pre">getppid</span></tt></dt>
<dd>Get the process id of the current process and its parent process,
respectively.</dd>
</dl>
<a name="wait"><a name="waitpid"><dl class="docutils" id="waitpid">
<span id="wait"></span><dt><tt class="docutils literal"><span class="pre">wait</span> <span class="pre">status</span></tt>, <tt class="docutils literal"><span class="pre">waitpid</span> <span class="pre">pid</span> <span class="pre">status</span> <span class="pre">options</span></tt></dt>
<dd>Wait for any child process, or the given one. The <tt class="docutils literal"><span class="pre">status</span></tt> argument
must be a pointer to an <tt class="docutils literal"><span class="pre">int</span></tt> value, which is used to return the status
of the child process.</dd>
</dl>
<a name="kill"><dl class="docutils" id="kill">
<dt><tt class="docutils literal"><span class="pre">kill</span> <span class="pre">pid</span> <span class="pre">sig</span></tt></dt>
<dd>Send the given signal to the given process.</dd>
</dl>
<a name="raise"><dl class="docutils" id="raise">
<dt><tt class="docutils literal"><span class="pre">raise</span> <span class="pre">sig</span></tt></dt>
<dd>Raise the given signal in the current process.</dd>
</dl>
<a name="pause"><!--  -->
</div>
<div class="section" id="option-parsing">
<h2><a class="toc-backref" href="#id141">4.13&nbsp;&nbsp;&nbsp;Option Parsing</a></h2>
<p>This is a quick-and-dirty replacement for the GNU getopt functions, ported
from the Q library. To use the operations of this module, add the following
import declaration to your program:</p>
<pre class="literal-block">
using getopt;
</pre>
<p>The following operation is provided:</p>
<a name="getopt"><dl class="docutils" id="getopt">
<dt><tt class="docutils literal"><span class="pre">getopt</span> <span class="pre">opts</span> <span class="pre">args</span></tt></dt>
<dd>Parse options as given by <tt class="docutils literal"><span class="pre">opts</span></tt> in the command line arguments
<tt class="docutils literal"><span class="pre">args</span></tt>, return the parsed options along with a list of the remaining
(non-option) command line arguments.</dd>
</dl>
<p>The <tt class="docutils literal"><span class="pre">getopt</span></tt> function takes two arguments: <tt class="docutils literal"><span class="pre">opts</span></tt>, a list of option
descriptions in the format described below, and <tt class="docutils literal"><span class="pre">args</span></tt>, a list of strings
containing the command line parameters to be parsed for options. The result
is a pair <tt class="docutils literal"><span class="pre">(opts_return,args_return)</span></tt> where <tt class="docutils literal"><span class="pre">opts_return</span></tt> is a list of
options and their values, and <tt class="docutils literal"><span class="pre">args_return</span></tt> is the list of remaining
(non-option) arguments. Options are parsed using the rules of GNU
getopt(1). If an invalid option is encountered (unrecognized option,
missing or extra argument, etc.), <tt class="docutils literal"><span class="pre">getopt</span></tt> throws the offending option
string as an exception.</p>
<p>The <tt class="docutils literal"><span class="pre">opts_return</span></tt> value is a list of &quot;hash pairs&quot; <tt class="docutils literal"><span class="pre">opt=&gt;val</span></tt> where
<tt class="docutils literal"><span class="pre">opt</span></tt> is the (long) option name (as given by the <tt class="docutils literal"><span class="pre">long_opt</span></tt> field given
in the <tt class="docutils literal"><span class="pre">opts</span></tt> argument, see below) and <tt class="docutils literal"><span class="pre">val</span></tt> is the corresponding value
(<tt class="docutils literal"><span class="pre">()</span></tt> if none). Note that this format is ready to be passed to the
<a class="reference internal" href="#dict"><tt class="docutils literal"><span class="pre">dict</span></tt></a> or <a class="reference internal" href="#hdict"><tt class="docutils literal"><span class="pre">hdict</span></tt></a> function, cf. <a class="reference internal" href="#dictionaries">Dictionaries</a>, which makes it easy to
retrieve option values or check for the presence of options. (As of Pure
0.41, you can also convert the list into a vector using the <a class="reference internal" href="#id16"><tt class="docutils literal"><span class="pre">matrix</span></tt></a>
function, and employ the record functions to access the option data,
cf. <a class="reference internal" href="#record-functions">Record Functions</a>.)</p>
<p>The <tt class="docutils literal"><span class="pre">opts</span></tt> argument of <tt class="docutils literal"><span class="pre">getopt</span></tt> must be a list of triples <tt class="docutils literal"><span class="pre">(long_opt,</span>
<span class="pre">short_opt,</span> <span class="pre">flag)</span></tt>, where <tt class="docutils literal"><span class="pre">long_opt</span></tt> denotes the long option,
<tt class="docutils literal"><span class="pre">short_opt</span></tt> the equivalent short option, and <tt class="docutils literal"><span class="pre">flag</span></tt> is one of the
symbolic integer values <tt class="docutils literal"><span class="pre">NOARG</span></tt>, <tt class="docutils literal"><span class="pre">OPTARG</span></tt> and <tt class="docutils literal"><span class="pre">REQARG</span></tt> which
specifies whether the option has no argument, an optional argument or a
required argument, respectively. Either <tt class="docutils literal"><span class="pre">long_opt</span></tt> or <tt class="docutils literal"><span class="pre">short_opt</span></tt>
should be a string value of the form <tt class="docutils literal"><span class="pre">&quot;--abc&quot;</span></tt> or <tt class="docutils literal"><span class="pre">&quot;-x&quot;</span></tt>,
respectively. Note that since the <tt class="docutils literal"><span class="pre">long_opt</span></tt> value is always used to
denote the corresponding option in the <tt class="docutils literal"><span class="pre">opts_return</span></tt> list, you always
have to specify a sensible value for that field. If no separate long option
name is needed, you can specify the same value as in the <tt class="docutils literal"><span class="pre">short_opt</span></tt>
field, or some other convenient value (e.g., an integer) which designates
the option. Conversely, to indicate that an option has no short option
equivalent, simply specify an empty option string for the <tt class="docutils literal"><span class="pre">short_opt</span></tt>
field.</p>
<p>Examples:</p>
<pre class="literal-block">
&gt; let opts = [(&quot;--help&quot;, &quot;-h&quot;, NOARG),       // no argument
&gt;             (&quot;--version&quot;, &quot;&quot;, NOARG),      // no short option
&gt;             (&quot;--filename&quot;, &quot;-f&quot;, REQARG),  // required argument
&gt;             (&quot;--count&quot;, &quot;-n&quot;, OPTARG)];    // optional argument
&gt; getopt opts [&quot;foo&quot;, &quot;-h&quot;, &quot;--filename&quot;, &quot;bar&quot;, &quot;-n0&quot;, &quot;baz&quot;];
[&quot;--help&quot;=&gt;(),&quot;--filename&quot;=&gt;&quot;bar&quot;,&quot;--count&quot;=&gt;&quot;0&quot;],[&quot;foo&quot;,&quot;baz&quot;]
&gt; catch invalid_option $ getopt opts [&quot;-h&quot;,&quot;-v&quot;];
invalid_option &quot;-v&quot;
&gt; getopt opts [foo, &quot;-h&quot;, bar];
[&quot;--help&quot;=&gt;()],[foo,bar]
</pre>
<p>As the last example shows, non-option arguments (as well as option values
specified as separate arguments) can actually be any values which are just
copied to the result lists as is.</p>
<!-- This is the last module in the manual, so we include the index here. -->
</div>
</div>
<div class="section" id="id70">
<h1><a class="toc-backref" href="#id142">5&nbsp;&nbsp;&nbsp;Index</a></h1>
<div class="line-block">
<div class="line"><a class="reference internal" href="#id6">!</a></div>
<div class="line"><a class="reference internal" href="#id42">! (array)</a></div>
<div class="line"><a class="reference internal" href="#id53">! (dict)</a></div>
<div class="line"><a class="reference internal" href="#id54">! (hdict)</a></div>
<div class="line"><a class="reference internal" href="#id14">! (matrix)</a></div>
<div class="line"><a class="reference internal" href="#id17">! (record)</a></div>
<div class="line"><a class="reference internal" href="#id10">! (string)</a></div>
<div class="line"><a class="reference internal" href="#id7">!!</a></div>
<div class="line"><a class="reference internal" href="#id15">!! (matrix)</a></div>
<div class="line"><a class="reference internal" href="#id18">!! (record)</a></div>
<div class="line"><a class="reference internal" href="#id11">!! (string)</a></div>
<div class="line"><a class="reference internal" href="#id3">#</a></div>
<div class="line"><a class="reference internal" href="#id41"># (array)</a></div>
<div class="line"><a class="reference internal" href="#id60"># (bag)</a></div>
<div class="line"><a class="reference internal" href="#id51"># (dict)</a></div>
<div class="line"><a class="reference internal" href="#id52"># (hdict)</a></div>
<div class="line"><a class="reference internal" href="#id46"># (heap)</a></div>
<div class="line"><a class="reference internal" href="#matrix"># (matrix)</a></div>
<div class="line"><a class="reference internal" href="#record"># (record)</a></div>
<div class="line"><a class="reference internal" href="#id59"># (set)</a></div>
<div class="line"><a class="reference internal" href="#id12"># (string)</a></div>
<div class="line"><a class="reference internal" href="#id1">$</a></div>
<div class="line"><a class="reference internal" href="#id39">%</a></div>
<div class="line"><a class="reference internal" href="#id31">&amp;&amp;</a></div>
<div class="line"><a class="reference internal" href="#id21">*</a></div>
<div class="line"><a class="reference internal" href="#id66">* (bag)</a></div>
<div class="line"><a class="reference internal" href="#id65">* (set)</a></div>
<div class="line"><a class="reference internal" href="#id19">+</a></div>
<div class="line"><a class="reference internal" href="#id62">+ (bag)</a></div>
<div class="line"><a class="reference internal" href="#list">+ (list)</a></div>
<div class="line"><a class="reference internal" href="#id61">+ (set)</a></div>
<div class="line"><a class="reference internal" href="#string">+ (string)</a></div>
<div class="line"><a class="reference internal" href="#id37">+:</a></div>
<div class="line"><a class="reference internal" href="#id5">,</a></div>
<div class="line"><a class="reference internal" href="#id20">-</a></div>
<div class="line"><a class="reference internal" href="#id64">- (bag)</a></div>
<div class="line"><a class="reference internal" href="#id63">- (set)</a></div>
<div class="line"><a class="reference internal" href="#id2">.</a></div>
<div class="line"><a class="reference internal" href="#id8">..</a></div>
<div class="line"><a class="reference internal" href="#id22">/</a></div>
<div class="line"><a class="reference internal" href="#id4">:</a></div>
<div class="line"><a class="reference internal" href="#id26">&lt;</a></div>
<div class="line"><a class="reference internal" href="#id38">&lt;:</a></div>
<div class="line"><a class="reference internal" href="#id33">&lt;&lt;</a></div>
<div class="line"><a class="reference internal" href="#id28">&lt;=</a></div>
<div class="line"><a class="reference internal" href="#id24">==</a></div>
<div class="line"><a class="reference internal" href="#id35">===</a></div>
<div class="line"><a class="reference internal" href="#id27">&gt;</a></div>
<div class="line"><a class="reference internal" href="#id29">&gt;=</a></div>
<div class="line"><a class="reference internal" href="#id34">&gt;&gt;</a></div>
<div class="line"><a class="reference internal" href="#locals">__locals__</a></div>
<div class="line"><a class="reference internal" href="#id23">^</a></div>
<div class="line"><a class="reference internal" href="#id32">||</a></div>
<div class="line"><a class="reference internal" href="#id30">~</a></div>
<div class="line"><a class="reference internal" href="#id25">~=</a></div>
<div class="line"><a class="reference internal" href="#id36">~==</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#abs">abs</a></div>
<div class="line"><a class="reference internal" href="#abs-complex">abs (complex)</a></div>
<div class="line"><a class="reference internal" href="#acos">acos</a></div>
<div class="line"><a class="reference internal" href="#acosh">acosh</a></div>
<div class="line"><a class="reference internal" href="#addr">addr</a></div>
<div class="line"><a class="reference internal" href="#all">all</a></div>
<div class="line"><a class="reference internal" href="#and">and</a></div>
<div class="line"><a class="reference internal" href="#ans">ans</a></div>
<div class="line"><a class="reference internal" href="#any">any</a></div>
<div class="line"><a class="reference internal" href="#append-array">append (array)</a></div>
<div class="line"><a class="reference internal" href="#applp">applp</a></div>
<div class="line"><a class="reference internal" href="#arg">arg</a></div>
<div class="line"><a class="reference internal" href="#arithmetic-sequences">arithmetic sequences</a></div>
<div class="line"><a class="reference internal" href="#arity">arity</a></div>
<div class="line"><a class="reference internal" href="#array">array</a></div>
<div class="line"><a class="reference internal" href="#array2">array2</a></div>
<div class="line"><a class="reference internal" href="#arrayp">arrayp</a></div>
<div class="line"><a class="reference internal" href="#asctime">asctime</a></div>
<div class="line"><a class="reference internal" href="#asin">asin</a></div>
<div class="line"><a class="reference internal" href="#asinh">asinh</a></div>
<div class="line"><a class="reference internal" href="#atan">atan</a></div>
<div class="line"><a class="reference internal" href="#atan2">atan2</a></div>
<div class="line"><a class="reference internal" href="#atanh">atanh</a></div>
<div class="line"><a class="reference internal" href="#atomp">atomp</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#bad-list-value">bad_list_value</a></div>
<div class="line"><a class="reference internal" href="#bad-matrix-value">bad_matrix_value</a></div>
<div class="line"><a class="reference internal" href="#bad-string-value">bad_string_value</a></div>
<div class="line"><a class="reference internal" href="#bad-tuple-value">bad_tuple_value</a></div>
<div class="line"><a class="reference internal" href="#bag">bag</a></div>
<div class="line"><a class="reference internal" href="#bagp">bagp</a></div>
<div class="line"><a class="reference internal" href="#bigint">bigint</a></div>
<div class="line"><a class="reference internal" href="#bigintp">bigintp</a></div>
<div class="line"><a class="reference internal" href="#bigintvalp">bigintvalp</a></div>
<div class="line"><a class="reference internal" href="#blob">blob</a></div>
<div class="line"><a class="reference internal" href="#blob-crc">blob_crc</a></div>
<div class="line"><a class="reference internal" href="#blob-size">blob_size</a></div>
<div class="line"><a class="reference internal" href="#blobp">blobp</a></div>
<div class="line"><a class="reference internal" href="#byte-cstring">byte_cstring</a></div>
<div class="line"><a class="reference internal" href="#byte-cstring-pointer">byte_cstring_pointer</a></div>
<div class="line"><a class="reference internal" href="#byte-matrix">byte_matrix</a></div>
<div class="line"><a class="reference internal" href="#byte-pointer">byte_pointer</a></div>
<div class="line"><a class="reference internal" href="#byte-string">byte_string</a></div>
<div class="line"><a class="reference internal" href="#byte-string-pointer">byte_string_pointer</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#calloc">calloc</a></div>
<div class="line"><a class="reference internal" href="#cat">cat</a></div>
<div class="line"><a class="reference internal" href="#catmap">catmap</a></div>
<div class="line"><a class="reference internal" href="#ceil">ceil</a></div>
<div class="line"><a class="reference internal" href="#character-arithmetic">character arithmetic</a></div>
<div class="line"><a class="reference internal" href="#charp">charp</a></div>
<div class="line"><a class="reference internal" href="#chars">chars</a></div>
<div class="line"><a class="reference internal" href="#chr">chr</a></div>
<div class="line"><a class="reference internal" href="#cis">cis</a></div>
<div class="line"><a class="reference internal" href="#clear-sentry">clear_sentry</a></div>
<div class="line"><a class="reference internal" href="#clearerr">clearerr</a></div>
<div class="line"><a class="reference internal" href="#clock">clock</a></div>
<div class="line"><a class="reference internal" href="#closurep">closurep</a></div>
<div class="line"><a class="reference internal" href="#cmatrix">cmatrix</a></div>
<div class="line"><a class="reference internal" href="#col">col</a></div>
<div class="line"><a class="reference internal" href="#colcat">colcat</a></div>
<div class="line"><a class="reference internal" href="#colcatmap">colcatmap</a></div>
<div class="line"><a class="reference internal" href="#colrev">colrev</a></div>
<div class="line"><a class="reference internal" href="#cols">cols</a></div>
<div class="line"><a class="reference internal" href="#colvector">colvector</a></div>
<div class="line"><a class="reference internal" href="#combinators">combinators</a></div>
<div class="line"><a class="reference internal" href="#complex">complex</a></div>
<div class="line"><a class="reference internal" href="#complex-float-matrix">complex_float_matrix</a></div>
<div class="line"><a class="reference internal" href="#complex-float-pointer">complex_float_pointer</a></div>
<div class="line"><a class="reference internal" href="#complex-matrix">complex_matrix</a></div>
<div class="line"><a class="reference internal" href="#complex-matrix-view">complex_matrix_view</a></div>
<div class="line"><a class="reference internal" href="#complex-pointer">complex_pointer</a></div>
<div class="line"><a class="reference internal" href="#complexp">complexp</a></div>
<div class="line"><a class="reference internal" href="#compvalp">compvalp</a></div>
<div class="line"><a class="reference internal" href="#conj">conj</a></div>
<div class="line"><a class="reference internal" href="#conj-matrix">conj (matrix)</a></div>
<div class="line"><a class="reference internal" href="#cooked">cooked</a></div>
<div class="line"><a class="reference internal" href="#cookedp">cookedp</a></div>
<div class="line"><a class="reference internal" href="#cos">cos</a></div>
<div class="line"><a class="reference internal" href="#cosh">cosh</a></div>
<div class="line"><a class="reference internal" href="#cst">cst</a></div>
<div class="line"><a class="reference internal" href="#cstring">cstring</a></div>
<div class="line"><a class="reference internal" href="#cstring-dup">cstring_dup</a></div>
<div class="line"><a class="reference internal" href="#cstring-list">cstring_list</a></div>
<div class="line"><a class="reference internal" href="#ctime">ctime</a></div>
<div class="line"><a class="reference internal" href="#curry">curry</a></div>
<div class="line"><a class="reference internal" href="#curry3">curry3</a></div>
<div class="line"><a class="reference internal" href="#cycle">cycle</a></div>
<div class="line"><a class="reference internal" href="#cyclen">cyclen</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#delete-bag">delete (bag)</a></div>
<div class="line"><a class="reference internal" href="#delete-dict">delete (dict)</a></div>
<div class="line"><a class="reference internal" href="#delete-hdict">delete (hdict)</a></div>
<div class="line"><a class="reference internal" href="#delete-record">delete (record)</a></div>
<div class="line"><a class="reference internal" href="#delete-set">delete (set)</a></div>
<div class="line"><a class="reference internal" href="#den">den</a></div>
<div class="line"><a class="reference internal" href="#diag">diag</a></div>
<div class="line"><a class="reference internal" href="#diagmat">diagmat</a></div>
<div class="line"><a class="reference internal" href="#dict">dict</a></div>
<div class="line"><a class="reference internal" href="#dictp">dictp</a></div>
<div class="line"><a class="reference internal" href="#dim">dim</a></div>
<div class="line"><a class="reference internal" href="#div">div</a></div>
<div class="line"><a class="reference internal" href="#dmatrix">dmatrix</a></div>
<div class="line"><a class="reference internal" href="#do">do</a></div>
<div class="line"><a class="reference internal" href="#double">double</a></div>
<div class="line"><a class="reference internal" href="#double-matrix">double_matrix</a></div>
<div class="line"><a class="reference internal" href="#double-matrix-view">double_matrix_view</a></div>
<div class="line"><a class="reference internal" href="#double-pointer">double_pointer</a></div>
<div class="line"><a class="reference internal" href="#doublep">doublep</a></div>
<div class="line"><a class="reference internal" href="#dowith">dowith</a></div>
<div class="line"><a class="reference internal" href="#dowith3">dowith3</a></div>
<div class="line"><a class="reference internal" href="#drop">drop</a></div>
<div class="line"><a class="reference internal" href="#dropwhile">dropwhile</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#emptyarray">emptyarray</a></div>
<div class="line"><a class="reference internal" href="#emptybag">emptybag</a></div>
<div class="line"><a class="reference internal" href="#emptydict">emptydict</a></div>
<div class="line"><a class="reference internal" href="#emptyhdict">emptyhdict</a></div>
<div class="line"><a class="reference internal" href="#emptyheap">emptyheap</a></div>
<div class="line"><a class="reference internal" href="#emptyset">emptyset</a></div>
<div class="line"><a class="reference internal" href="#errno">errno</a></div>
<div class="line"><a class="reference internal" href="#eval">eval</a></div>
<div class="line"><a class="reference internal" href="#evalcmd">evalcmd</a></div>
<div class="line"><a class="reference internal" href="#exactp">exactp</a></div>
<div class="line"><a class="reference internal" href="#execv">execv</a></div>
<div class="line"><a class="reference internal" href="#execve">execve</a></div>
<div class="line"><a class="reference internal" href="#execvp">execvp</a></div>
<div class="line"><a class="reference internal" href="#exit">exit</a></div>
<div class="line"><a class="reference internal" href="#exp">exp</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#failed-cond">failed_cond</a></div>
<div class="line"><a class="reference internal" href="#failed-match">failed_match</a></div>
<div class="line"><a class="reference internal" href="#false">false</a></div>
<div class="line"><a class="reference internal" href="#fclose">fclose</a></div>
<div class="line"><a class="reference internal" href="#fdopen">fdopen</a></div>
<div class="line"><a class="reference internal" href="#feof">feof</a></div>
<div class="line"><a class="reference internal" href="#ferror">ferror</a></div>
<div class="line"><a class="reference internal" href="#fflush">fflush</a></div>
<div class="line"><a class="reference internal" href="#fget">fget</a></div>
<div class="line"><a class="reference internal" href="#fgets">fgets</a></div>
<div class="line"><a class="reference internal" href="#fileno">fileno</a></div>
<div class="line"><a class="reference internal" href="#filter">filter</a></div>
<div class="line"><a class="reference internal" href="#first-array">first (array)</a></div>
<div class="line"><a class="reference internal" href="#first-bag">first (bag)</a></div>
<div class="line"><a class="reference internal" href="#first-dict">first (dict)</a></div>
<div class="line"><a class="reference internal" href="#first-hdict">first (hdict)</a></div>
<div class="line"><a class="reference internal" href="#first-heap">first (heap)</a></div>
<div class="line"><a class="reference internal" href="#first-set">first (set)</a></div>
<div class="line"><a class="reference internal" href="#fix">fix</a></div>
<div class="line"><a class="reference internal" href="#fixity">fixity</a></div>
<div class="line"><a class="reference internal" href="#flip">flip</a></div>
<div class="line"><a class="reference internal" href="#float-matrix">float_matrix</a></div>
<div class="line"><a class="reference internal" href="#float-pointer">float_pointer</a></div>
<div class="line"><a class="reference internal" href="#floor">floor</a></div>
<div class="line"><a class="reference internal" href="#fnmatch">fnmatch</a></div>
<div class="line"><a class="reference internal" href="#foldl">foldl</a></div>
<div class="line"><a class="reference internal" href="#foldl1">foldl1</a></div>
<div class="line"><a class="reference internal" href="#foldr">foldr</a></div>
<div class="line"><a class="reference internal" href="#foldr1">foldr1</a></div>
<div class="line"><a class="reference internal" href="#fopen">fopen</a></div>
<div class="line"><a class="reference internal" href="#fork">fork</a></div>
<div class="line"><a class="reference internal" href="#fprintf">fprintf</a></div>
<div class="line"><a class="reference internal" href="#fputs">fputs</a></div>
<div class="line"><a class="reference internal" href="#frac">frac</a></div>
<div class="line"><a class="reference internal" href="#fread">fread</a></div>
<div class="line"><a class="reference internal" href="#free">free</a></div>
<div class="line"><a class="reference internal" href="#freopen">freopen</a></div>
<div class="line"><a class="reference internal" href="#fscanf">fscanf</a></div>
<div class="line"><a class="reference internal" href="#fseek">fseek</a></div>
<div class="line"><a class="reference internal" href="#fstat">fstat</a></div>
<div class="line"><a class="reference internal" href="#ftell">ftell</a></div>
<div class="line"><a class="reference internal" href="#funp">funp</a></div>
<div class="line"><a class="reference internal" href="#fwrite">fwrite</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#gcd">gcd</a></div>
<div class="line"><a class="reference internal" href="#get">get</a></div>
<div class="line"><a class="reference internal" href="#get-byte">get_byte</a></div>
<div class="line"><a class="reference internal" href="#get-double">get_double</a></div>
<div class="line"><a class="reference internal" href="#get-float">get_float</a></div>
<div class="line"><a class="reference internal" href="#get-int">get_int</a></div>
<div class="line"><a class="reference internal" href="#get-int64">get_int64</a></div>
<div class="line"><a class="reference internal" href="#get-long">get_long</a></div>
<div class="line"><a class="reference internal" href="#get-pointer">get_pointer</a></div>
<div class="line"><a class="reference internal" href="#get-sentry">get_sentry</a></div>
<div class="line"><a class="reference internal" href="#get-short">get_short</a></div>
<div class="line"><a class="reference internal" href="#get-string">get_string</a></div>
<div class="line"><a class="reference internal" href="#getopt">getopt</a></div>
<div class="line"><a class="reference internal" href="#getpid">getpid</a></div>
<div class="line"><a class="reference internal" href="#getppid">getppid</a></div>
<div class="line"><a class="reference internal" href="#gets">gets</a></div>
<div class="line"><a class="reference internal" href="#gettimeofday">gettimeofday</a></div>
<div class="line"><a class="reference internal" href="#glob">glob</a></div>
<div class="line"><a class="reference internal" href="#gmtime">gmtime</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#hash">hash</a></div>
<div class="line"><a class="reference internal" href="#hdict">hdict</a></div>
<div class="line"><a class="reference internal" href="#hdictp">hdictp</a></div>
<div class="line"><a class="reference internal" href="#head">head</a></div>
<div class="line"><a class="reference internal" href="#heap">heap</a></div>
<div class="line"><a class="reference internal" href="#heapp">heapp</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#id">id</a></div>
<div class="line"><a class="reference internal" href="#im">im</a></div>
<div class="line"><a class="reference internal" href="#im-matrix">im (matrix)</a></div>
<div class="line"><a class="reference internal" href="#imatrix">imatrix</a></div>
<div class="line"><a class="reference internal" href="#index">index</a></div>
<div class="line"><a class="reference internal" href="#index-string">index (string)</a></div>
<div class="line"><a class="reference internal" href="#inexactp">inexactp</a></div>
<div class="line"><a class="reference internal" href="#init">init</a></div>
<div class="line"><a class="reference internal" href="#insert-array">insert (array)</a></div>
<div class="line"><a class="reference internal" href="#insert-bag">insert (bag)</a></div>
<div class="line"><a class="reference internal" href="#insert-dict">insert (dict)</a></div>
<div class="line"><a class="reference internal" href="#insert-hdict">insert (hdict)</a></div>
<div class="line"><a class="reference internal" href="#insert-heap">insert (heap)</a></div>
<div class="line"><a class="reference internal" href="#insert-record">insert (record)</a></div>
<div class="line"><a class="reference internal" href="#insert-set">insert (set)</a></div>
<div class="line"><a class="reference internal" href="#int">int</a></div>
<div class="line"><a class="reference internal" href="#int-matrix">int_matrix</a></div>
<div class="line"><a class="reference internal" href="#int-matrix-view">int_matrix_view</a></div>
<div class="line"><a class="reference internal" href="#int-pointer">int_pointer</a></div>
<div class="line"><a class="reference internal" href="#integerp">integerp</a></div>
<div class="line"><a class="reference internal" href="#intp">intp</a></div>
<div class="line"><a class="reference internal" href="#intvalp">intvalp</a></div>
<div class="line"><a class="reference internal" href="#iterate">iterate</a></div>
<div class="line"><a class="reference internal" href="#iteraten">iteraten</a></div>
<div class="line"><a class="reference internal" href="#iterwhile">iterwhile</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#join">join</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#keys">keys</a></div>
<div class="line"><a class="reference internal" href="#kill">kill</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#lambdap">lambdap</a></div>
<div class="line"><a class="reference internal" href="#last">last</a></div>
<div class="line"><a class="reference internal" href="#last-array">last (array)</a></div>
<div class="line"><a class="reference internal" href="#last-bag">last (bag)</a></div>
<div class="line"><a class="reference internal" href="#last-dict">last (dict)</a></div>
<div class="line"><a class="reference internal" href="#last-hdict">last (hdict)</a></div>
<div class="line"><a class="reference internal" href="#last-set">last (set)</a></div>
<div class="line"><a class="reference internal" href="#lasterr">lasterr</a></div>
<div class="line"><a class="reference internal" href="#lcd">lcd</a></div>
<div class="line"><a class="reference internal" href="#id9">list</a></div>
<div class="line"><a class="reference internal" href="#list-array">list (array)</a></div>
<div class="line"><a class="reference internal" href="#list-bag">list (bag)</a></div>
<div class="line"><a class="reference internal" href="#list-dict">list (dict)</a></div>
<div class="line"><a class="reference internal" href="#list-hdict">list (hdict)</a></div>
<div class="line"><a class="reference internal" href="#list-heap">list (heap)</a></div>
<div class="line"><a class="reference internal" href="#list-matrix">list (matrix)</a></div>
<div class="line"><a class="reference internal" href="#list-set">list (set)</a></div>
<div class="line"><a class="reference internal" href="#list-string">list (string)</a></div>
<div class="line"><a class="reference internal" href="#list-concatenation">list concatenation</a></div>
<div class="line"><a class="reference internal" href="#list-indexing">list indexing</a></div>
<div class="line"><a class="reference internal" href="#list-size">list size</a></div>
<div class="line"><a class="reference internal" href="#list-slicing">list slicing</a></div>
<div class="line"><a class="reference internal" href="#list2-array">list2 (array)</a></div>
<div class="line"><a class="reference internal" href="#list2-matrix">list2 (matrix)</a></div>
<div class="line"><a class="reference internal" href="#listmap">listmap</a></div>
<div class="line"><a class="reference internal" href="#listnp">listnp</a></div>
<div class="line"><a class="reference internal" href="#listp">listp</a></div>
<div class="line"><a class="reference internal" href="#lists">lists</a></div>
<div class="line"><a class="reference internal" href="#ln">ln</a></div>
<div class="line"><a class="reference internal" href="#localtime">localtime</a></div>
<div class="line"><a class="reference internal" href="#log">log</a></div>
<div class="line"><a class="reference internal" href="#lstat">lstat</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#malloc">malloc</a></div>
<div class="line"><a class="reference internal" href="#malloc-error">malloc_error</a></div>
<div class="line"><a class="reference internal" href="#map">map</a></div>
<div class="line"><a class="reference internal" href="#matcat">matcat</a></div>
<div class="line"><a class="reference internal" href="#id16">matrix</a></div>
<div class="line"><a class="reference internal" href="#matrix-string">matrix (string)</a></div>
<div class="line"><a class="reference internal" href="#matrix-dimensions">matrix dimensions</a></div>
<div class="line"><a class="reference internal" href="#matrix-size">matrix size</a></div>
<div class="line"><a class="reference internal" href="#matrixp">matrixp</a></div>
<div class="line"><a class="reference internal" href="#max">max</a></div>
<div class="line"><a class="reference internal" href="#member-bag">member (bag)</a></div>
<div class="line"><a class="reference internal" href="#member-dict">member (dict)</a></div>
<div class="line"><a class="reference internal" href="#member-hdict">member (hdict)</a></div>
<div class="line"><a class="reference internal" href="#member-record">member (record)</a></div>
<div class="line"><a class="reference internal" href="#member-set">member (set)</a></div>
<div class="line"><a class="reference internal" href="#members-array">members (array)</a></div>
<div class="line"><a class="reference internal" href="#members-bag">members (bag)</a></div>
<div class="line"><a class="reference internal" href="#members-dict">members (dict)</a></div>
<div class="line"><a class="reference internal" href="#members-hdict">members (hdict)</a></div>
<div class="line"><a class="reference internal" href="#members-heap">members (heap)</a></div>
<div class="line"><a class="reference internal" href="#members-set">members (set)</a></div>
<div class="line"><a class="reference internal" href="#members2-array">members2 (array)</a></div>
<div class="line"><a class="reference internal" href="#min">min</a></div>
<div class="line"><a class="reference internal" href="#mkarray">mkarray</a></div>
<div class="line"><a class="reference internal" href="#mkarray2">mkarray2</a></div>
<div class="line"><a class="reference internal" href="#mkdict">mkdict</a></div>
<div class="line"><a class="reference internal" href="#mkhdict">mkhdict</a></div>
<div class="line"><a class="reference internal" href="#mod">mod</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#nanosleep">nanosleep</a></div>
<div class="line"><a class="reference internal" href="#nargs">nargs</a></div>
<div class="line"><a class="reference internal" href="#not">not</a></div>
<div class="line"><a class="reference internal" href="#null">null</a></div>
<div class="line"><a class="reference internal" href="#null-array">null (array)</a></div>
<div class="line"><a class="reference internal" href="#null-bag">null (bag)</a></div>
<div class="line"><a class="reference internal" href="#null-dict">null (dict)</a></div>
<div class="line"><a class="reference internal" href="#null-hdict">null (hdict)</a></div>
<div class="line"><a class="reference internal" href="#null-heap">null (heap)</a></div>
<div class="line"><a class="reference internal" href="#null-matrix">null (matrix)</a></div>
<div class="line"><a class="reference internal" href="#null-set">null (set)</a></div>
<div class="line"><a class="reference internal" href="#null-string">null (string)</a></div>
<div class="line"><a class="reference internal" href="#num">num</a></div>
<div class="line"><a class="reference internal" href="#numberp">numberp</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#operators">operators</a></div>
<div class="line"><a class="reference internal" href="#or">or</a></div>
<div class="line"><a class="reference internal" href="#ord">ord</a></div>
<div class="line"><a class="reference internal" href="#out-of-bounds">out_of_bounds</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#pack">pack</a></div>
<div class="line"><a class="reference internal" href="#packed">packed</a></div>
<div class="line"><a class="reference external" href="Sleepuntilasignaliscaught.">pause</a></div>
<div class="line"><a class="reference internal" href="#pclose">pclose</a></div>
<div class="line"><a class="reference internal" href="#perror">perror</a></div>
<div class="line"><a class="reference internal" href="#pointer">pointer</a></div>
<div class="line"><a class="reference internal" href="#pointer-matrix">pointer (matrix)</a></div>
<div class="line"><a class="reference internal" href="#pointerp">pointerp</a></div>
<div class="line"><a class="reference internal" href="#polar">polar</a></div>
<div class="line"><a class="reference internal" href="#popen">popen</a></div>
<div class="line"><a class="reference internal" href="#pow">pow</a></div>
<div class="line"><a class="reference internal" href="#pred">pred</a></div>
<div class="line"><a class="reference internal" href="#printf">printf</a></div>
<div class="line"><a class="reference internal" href="#put">put</a></div>
<div class="line"><a class="reference internal" href="#put-byte">put_byte</a></div>
<div class="line"><a class="reference internal" href="#put-double">put_double</a></div>
<div class="line"><a class="reference internal" href="#put-float">put_float</a></div>
<div class="line"><a class="reference internal" href="#put-int">put_int</a></div>
<div class="line"><a class="reference internal" href="#put-int64">put_int64</a></div>
<div class="line"><a class="reference internal" href="#put-long">put_long</a></div>
<div class="line"><a class="reference internal" href="#put-pointer">put_pointer</a></div>
<div class="line"><a class="reference internal" href="#put-short">put_short</a></div>
<div class="line"><a class="reference internal" href="#put-string">put_string</a></div>
<div class="line"><a class="reference internal" href="#puts">puts</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#raise">raise</a></div>
<div class="line"><a class="reference internal" href="#random">random</a></div>
<div class="line"><a class="reference internal" href="#random31">random31</a></div>
<div class="line"><a class="reference internal" href="#random53">random53</a></div>
<div class="line"><a class="reference internal" href="#rational">rational</a></div>
<div class="line"><a class="reference internal" href="#rationalp">rationalp</a></div>
<div class="line"><a class="reference internal" href="#ratvalp">ratvalp</a></div>
<div class="line"><a class="reference internal" href="#re">re</a></div>
<div class="line"><a class="reference internal" href="#re-matrix">re (matrix)</a></div>
<div class="line"><a class="reference internal" href="#id69">readdir</a></div>
<div class="line"><a class="reference internal" href="#realloc">realloc</a></div>
<div class="line"><a class="reference internal" href="#realp">realp</a></div>
<div class="line"><a class="reference internal" href="#realvalp">realvalp</a></div>
<div class="line"><a class="reference internal" href="#rect">rect</a></div>
<div class="line"><a class="reference internal" href="#redim">redim</a></div>
<div class="line"><a class="reference internal" href="#reduce">reduce</a></div>
<div class="line"><a class="reference internal" href="#reduce-with">reduce_with</a></div>
<div class="line"><a class="reference internal" href="#ref">ref</a></div>
<div class="line"><a class="reference internal" href="#refp">refp</a></div>
<div class="line"><a class="reference internal" href="#reg">reg</a></div>
<div class="line"><a class="reference internal" href="#reg-info">reg_info</a></div>
<div class="line"><a class="reference internal" href="#reg-result">reg_result</a></div>
<div class="line"><a class="reference internal" href="#regex">regex</a></div>
<div class="line"><a class="reference internal" href="#regexg">regexg</a></div>
<div class="line"><a class="reference internal" href="#regexgg">regexgg</a></div>
<div class="line"><a class="reference internal" href="#regexggs">regexggs</a></div>
<div class="line"><a class="reference internal" href="#regexgs">regexgs</a></div>
<div class="line"><a class="reference internal" href="#regs">regs</a></div>
<div class="line"><a class="reference internal" href="#regsplit">regsplit</a></div>
<div class="line"><a class="reference internal" href="#regsplits">regsplits</a></div>
<div class="line"><a class="reference internal" href="#regsub">regsub</a></div>
<div class="line"><a class="reference internal" href="#repeat">repeat</a></div>
<div class="line"><a class="reference internal" href="#repeatn">repeatn</a></div>
<div class="line"><a class="reference internal" href="#reverse">reverse</a></div>
<div class="line"><a class="reference internal" href="#reverse-matrix">reverse (matrix)</a></div>
<div class="line"><a class="reference internal" href="#rewind">rewind</a></div>
<div class="line"><a class="reference internal" href="#rmfirst-array">rmfirst (array)</a></div>
<div class="line"><a class="reference internal" href="#rmfirst-bag">rmfirst (bag)</a></div>
<div class="line"><a class="reference internal" href="#rmfirst-dict">rmfirst (dict)</a></div>
<div class="line"><a class="reference internal" href="#rmfirst-hdict">rmfirst (hdict)</a></div>
<div class="line"><a class="reference internal" href="#rmfirst-heap">rmfirst (heap)</a></div>
<div class="line"><a class="reference internal" href="#rmfirst-set">rmfirst (set)</a></div>
<div class="line"><a class="reference internal" href="#rmlast-array">rmlast (array)</a></div>
<div class="line"><a class="reference internal" href="#rmlast-bag">rmlast (bag)</a></div>
<div class="line"><a class="reference internal" href="#rmlast-dict">rmlast (dict)</a></div>
<div class="line"><a class="reference internal" href="#rmlast-hdict">rmlast (hdict)</a></div>
<div class="line"><a class="reference internal" href="#rmlast-set">rmlast (set)</a></div>
<div class="line"><a class="reference internal" href="#round">round</a></div>
<div class="line"><a class="reference internal" href="#row">row</a></div>
<div class="line"><a class="reference internal" href="#rowcat">rowcat</a></div>
<div class="line"><a class="reference internal" href="#rowcatmap">rowcatmap</a></div>
<div class="line"><a class="reference internal" href="#rowrev">rowrev</a></div>
<div class="line"><a class="reference internal" href="#rows">rows</a></div>
<div class="line"><a class="reference internal" href="#rowvector">rowvector</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#same">same</a></div>
<div class="line"><a class="reference internal" href="#scanf">scanf</a></div>
<div class="line"><a class="reference internal" href="#scanl">scanl</a></div>
<div class="line"><a class="reference internal" href="#scanl1">scanl1</a></div>
<div class="line"><a class="reference internal" href="#scanr">scanr</a></div>
<div class="line"><a class="reference internal" href="#scanr1">scanr1</a></div>
<div class="line"><a class="reference internal" href="#sentry">sentry</a></div>
<div class="line"><a class="reference internal" href="#set">set</a></div>
<div class="line"><a class="reference internal" href="#set-errno">set_errno</a></div>
<div class="line"><a class="reference internal" href="#setbuf">setbuf</a></div>
<div class="line"><a class="reference internal" href="#setlocale">setlocale</a></div>
<div class="line"><a class="reference internal" href="#setp">setp</a></div>
<div class="line"><a class="reference internal" href="#setvbuf">setvbuf</a></div>
<div class="line"><a class="reference internal" href="#sgn">sgn</a></div>
<div class="line"><a class="reference internal" href="#short-matrix">short_matrix</a></div>
<div class="line"><a class="reference internal" href="#short-pointer">short_pointer</a></div>
<div class="line"><a class="reference internal" href="#sin">sin</a></div>
<div class="line"><a class="reference internal" href="#sinh">sinh</a></div>
<div class="line"><a class="reference internal" href="#sleep">sleep</a></div>
<div class="line"><a class="reference internal" href="#smatrix">smatrix</a></div>
<div class="line"><a class="reference internal" href="#sort">sort</a></div>
<div class="line"><a class="reference internal" href="#sort-list">sort (list)</a></div>
<div class="line"><a class="reference internal" href="#sort-matrix">sort (matrix)</a></div>
<div class="line"><a class="reference internal" href="#spawnv">spawnv</a></div>
<div class="line"><a class="reference internal" href="#spawnve">spawnve</a></div>
<div class="line"><a class="reference internal" href="#spawnvp">spawnvp</a></div>
<div class="line"><a class="reference internal" href="#split">split</a></div>
<div class="line"><a class="reference internal" href="#sprintf">sprintf</a></div>
<div class="line"><a class="reference internal" href="#sqrt">sqrt</a></div>
<div class="line"><a class="reference internal" href="#srandom">srandom</a></div>
<div class="line"><a class="reference internal" href="#sscanf">sscanf</a></div>
<div class="line"><a class="reference internal" href="#stack-fault">stack_fault</a></div>
<div class="line"><a class="reference internal" href="#stat">stat</a></div>
<div class="line"><a class="reference internal" href="#str">str</a></div>
<div class="line"><a class="reference internal" href="#strcat">strcat</a></div>
<div class="line"><a class="reference internal" href="#stream">stream</a></div>
<div class="line"><a class="reference internal" href="#strerror">strerror</a></div>
<div class="line"><a class="reference internal" href="#strftime">strftime</a></div>
<div class="line"><a class="reference internal" href="#stride">stride</a></div>
<div class="line"><a class="reference internal" href="#id13">string</a></div>
<div class="line"><a class="reference internal" href="#string-pointer">string (pointer)</a></div>
<div class="line"><a class="reference internal" href="#string-concatenation">string concatenation</a></div>
<div class="line"><a class="reference internal" href="#string-indexing">string indexing</a></div>
<div class="line"><a class="reference internal" href="#string-size">string size</a></div>
<div class="line"><a class="reference internal" href="#string-slicing">string slicing</a></div>
<div class="line"><a class="reference internal" href="#string-dup">string_dup</a></div>
<div class="line"><a class="reference internal" href="#string-list">string_list</a></div>
<div class="line"><a class="reference internal" href="#stringp">stringp</a></div>
<div class="line"><a class="reference internal" href="#strings">strings</a></div>
<div class="line"><a class="reference internal" href="#subdiag">subdiag</a></div>
<div class="line"><a class="reference internal" href="#subdiagmat">subdiagmat</a></div>
<div class="line"><a class="reference internal" href="#submat">submat</a></div>
<div class="line"><a class="reference internal" href="#substr">substr</a></div>
<div class="line"><a class="reference internal" href="#succ">succ</a></div>
<div class="line"><a class="reference internal" href="#supdiag">supdiag</a></div>
<div class="line"><a class="reference internal" href="#supdiagmat">supdiagmat</a></div>
<div class="line"><a class="reference internal" href="#system">system</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#tail">tail</a></div>
<div class="line"><a class="reference internal" href="#take">take</a></div>
<div class="line"><a class="reference internal" href="#takewhile">takewhile</a></div>
<div class="line"><a class="reference internal" href="#tan">tan</a></div>
<div class="line"><a class="reference internal" href="#tanh">tanh</a></div>
<div class="line"><a class="reference internal" href="#throw">throw</a></div>
<div class="line"><a class="reference internal" href="#thunkp">thunkp</a></div>
<div class="line"><a class="reference internal" href="#time">time</a></div>
<div class="line"><a class="reference internal" href="#tmpfile">tmpfile</a></div>
<div class="line"><a class="reference internal" href="#transpose-matrix">transpose (matrix)</a></div>
<div class="line"><a class="reference internal" href="#trap">trap</a></div>
<div class="line"><a class="reference internal" href="#true">true</a></div>
<div class="line"><a class="reference internal" href="#trunc">trunc</a></div>
<div class="line"><a class="reference internal" href="#tuple">tuple</a></div>
<div class="line"><a class="reference internal" href="#tuple-matrix">tuple (matrix)</a></div>
<div class="line"><a class="reference internal" href="#tuple-string">tuple (string)</a></div>
<div class="line"><a class="reference internal" href="#tuple-indexing">tuple indexing</a></div>
<div class="line"><a class="reference internal" href="#tuple-size">tuple size</a></div>
<div class="line"><a class="reference internal" href="#tuple-slicing">tuple slicing</a></div>
<div class="line"><a class="reference internal" href="#tuplep">tuplep</a></div>
<div class="line"><a class="reference internal" href="#tuples">tuples</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#ubyte">ubyte</a></div>
<div class="line"><a class="reference internal" href="#uint">uint</a></div>
<div class="line"><a class="reference internal" href="#uint64">uint64</a></div>
<div class="line"><a class="reference internal" href="#ulong">ulong</a></div>
<div class="line"><a class="reference internal" href="#uncurry">uncurry</a></div>
<div class="line"><a class="reference internal" href="#uncurry3">uncurry3</a></div>
<div class="line"><a class="reference internal" href="#unref">unref</a></div>
<div class="line"><a class="reference internal" href="#unzip">unzip</a></div>
<div class="line"><a class="reference internal" href="#unzip3">unzip3</a></div>
<div class="line"><a class="reference internal" href="#update-array">update (array)</a></div>
<div class="line"><a class="reference internal" href="#update-dict">update (dict)</a></div>
<div class="line"><a class="reference internal" href="#update-hdict">update (hdict)</a></div>
<div class="line"><a class="reference internal" href="#update-record">update (record)</a></div>
<div class="line"><a class="reference internal" href="#update2">update2</a></div>
<div class="line"><a class="reference internal" href="#ushort">ushort</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#val-blob">val (blob)</a></div>
<div class="line"><a class="reference internal" href="#val-string">val (string)</a></div>
<div class="line"><a class="reference internal" href="#vals">vals</a></div>
<div class="line"><a class="reference internal" href="#varp">varp</a></div>
<div class="line"><a class="reference internal" href="#void">void</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#wait">wait</a></div>
<div class="line"><a class="reference internal" href="#waitpid">waitpid</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#zip">zip</a></div>
<div class="line"><a class="reference internal" href="#zip3">zip3</a></div>
<div class="line"><a class="reference internal" href="#zipwith">zipwith</a></div>
<div class="line"><a class="reference internal" href="#zipwith3">zipwith3</a></div>
</div>
</div>
</div>
</body>
</html>
