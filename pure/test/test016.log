(foo/*0*/ x with foo x/*0:1*/ = x/*0:1*/^3 {
  rule #0: foo x = x^3
  state 0: #0
	<var> state 1
  state 1: #0
} end)+(foo/*0*/ x with foo x/*0:1*/ = 2*x/*0:1*/ {
  rule #0: foo x = 2*x
  state 0: #0
	<var> state 1
  state 1: #0
} end);
x^3+2*x
(foo/*0*/ x with foo x/*0:1*/ = x/*0:1*/^3 {
  rule #0: foo x = x^3
  state 0: #0
	<var> state 1
  state 1: #0
} end)+(foo/*0*/ x with foo = (+) 1 {
  rule #0: foo = (+) 1
  state 0: #0
} end with foo x/*0:1*/ = 2*x/*0:1*/ {
  rule #0: foo x = 2*x
  state 0: #0
	<var> state 1
  state 1: #0
} end);
x^3+(1+x)
(foo/*0*/ x with foo x/*0:1*/ = x/*0:1*/^3 {
  rule #0: foo x = x^3
  state 0: #0
	<var> state 1
  state 1: #0
} end)+(foo/*0:*/ x when foo/*0:*/ = (+) 1 {
  rule #0: foo = (+) 1
  state 0: #0
	<var> state 1
  state 1: #0
} end with foo x/*0:1*/ = 2*x/*0:1*/ {
  rule #0: foo x = 2*x
  state 0: #0
	<var> state 1
  state 1: #0
} end);
x^3+(1+x)
